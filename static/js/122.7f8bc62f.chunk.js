"use strict";(self.webpackChunkopencast_react_studio=self.webpackChunkopencast_react_studio||[]).push([[122],{605:(e,t,r)=>{r.r(t),r.d(t,{default:()=>xr});var n=r(9523),o=r(1038),i=r(2791),a=r(1523),s=r(4880),l=r(7725),c=r(4034),d=r(8491),u=r(5654);const p="microphone",g="none",h="both",m="display",x="user",v="none",f="not_uploaded",Z="uploading",b="uploaded",y="error",w=()=>({mediaDevices:[],audioAllowed:null,audioStream:null,audioUnexpectedEnd:!1,audioSupported:(0,u.S7)(),displayAllowed:null,displayStream:null,displayUnexpectedEnd:!1,displaySupported:(0,u.bV)(),userAllowed:null,userStream:null,userUnexpectedEnd:!1,userSupported:(0,u.S7)(),videoChoice:v,audioChoice:g,isRecording:!1,prematureRecordingEnd:!1,recordings:[],title:"",presenter:"",start:null,end:null,upload:{error:null,state:f,secondsLeft:null,currentProgress:0}}),S=(e,t)=>{switch(t.type){case"UPDATE_MEDIA_DEVICES":return{...e,mediaDevices:t.payload};case"CHOOSE_AUDIO":return{...e,audioChoice:t.payload};case"CHOOSE_VIDEO":return{...e,videoChoice:t.payload};case"SHARE_AUDIO":return{...e,audioStream:t.payload,audioAllowed:!0,audioUnexpectedEnd:!1};case"BLOCK_AUDIO":return{...e,audioStream:null,audioAllowed:!1,audioUnexpectedEnd:!1};case"UNSHARE_AUDIO":return{...e,audioStream:null,audioUnexpectedEnd:!1};case"AUDIO_UNEXPETED_END":return{...e,audioStream:null,audioUnexpectedEnd:!0};case"SHARE_DISPLAY":return{...e,displayStream:t.payload,displayAllowed:!0,displayUnexpectedEnd:!1};case"BLOCK_DISPLAY":return{...e,displayStream:null,displayAllowed:!1,displayUnexpectedEnd:!1};case"UNSHARE_DISPLAY":return{...e,displayStream:null,displayUnexpectedEnd:!1};case"DISPLAY_UNEXPETED_END":return{...e,displayStream:null,displayUnexpectedEnd:!0};case"SHARE_USER":return{...e,userStream:t.payload,userAllowed:!0,userUnexpectedEnd:!1};case"BLOCK_USER":return{...e,userStream:null,userAllowed:!1,userUnexpectedEnd:!1};case"UNSHARE_USER":return{...e,userStream:null,userUnexpectedEnd:!1};case"USER_UNEXPETED_END":return{...e,userStream:null,userUnexpectedEnd:!0};case"START_RECORDING":return{...e,isRecording:!0};case"STOP_RECORDING":return{...e,isRecording:!1};case"STOP_RECORDING_PREMATURELY":return{...e,isRecording:!1,prematureRecordingEnd:!0};case"CLEAR_RECORDINGS":return{...e,recordings:[],prematureRecordingEnd:!1};case"ADD_RECORDING":const r=[...e.recordings.filter((e=>e.deviceType!==t.payload.deviceType)),t.payload];return{...e,recordings:r};case"UPLOAD_ERROR":return{...e,upload:{...e.upload,error:t.payload,state:y}};case"UPLOAD_REQUEST":return{...e,upload:{...e.upload,error:null,state:Z}};case"UPLOAD_SUCCESS":return{...e,upload:{...e.upload,error:null,state:b}};case"UPLOAD_PROGRESS_UPDATE":return{...e,upload:{...e.upload,secondsLeft:t.payload.secondsLeft,currentProgress:t.payload.currentProgress}};case"MARK_DOWNLOADED":const n=e.recordings.map(((e,r)=>r===t.payload?{...e,downloaded:!0}:e));return{...e,recordings:n};case"UPDATE_TITLE":return{...e,title:t.payload};case"UPDATE_PRESENTER":return{...e,presenter:t.payload};case"UPDATE_START":return{...e,start:t.payload};case"UPDATE_END":return{...e,end:t.payload};case"RESET":return w();default:throw new Error}},k=(0,i.createContext)(null),E=(0,i.createContext)(null),C=e=>{let{children:t}=e;const[r,o]=(0,i.useReducer)(S,w());return(0,n.tZ)(E.Provider,{value:o},(0,n.tZ)(k.Provider,{value:r},t))},R=()=>(0,i.useContext)(E),D=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=(0,i.useContext)(k);return null!==e?t[e]:t};var A=r(427),T=r(9806),O=r(1632);function I(){return(0,n.tZ)("article",null,(0,n.tZ)(A.Ge.h2,null,"ELAN e.V."),(0,n.tZ)(A.Ge.p,null,"The e-learning academic network (ELAN e.V.) is a German non-profit organization supporting higher-education organizations in all matters related to e-learning. Our services include practical tips about how to use digital technologies in education, legal advice and development of free, open-source software to support education."),(0,n.tZ)(A.Ge.h3,null,"Contact"),(0,n.tZ)(A.Ge.p,null,"Dr. Norbert Kleinefeld, Gesch\xe4ftsf\xfchrer",(0,n.tZ)("br",null),"Karlstr. 23",(0,n.tZ)("br",null),"D-26123 Oldenburg"),(0,n.tZ)(A.Ge.p,null,(0,n.tZ)(T.G,{icon:O.bd9})," ",(0,n.tZ)(A.Ge.a,{href:"https://elan-ev.de"},"elan-ev.de"),(0,n.tZ)("br",null),(0,n.tZ)(T.G,{icon:O.FU$})," ",(0,n.tZ)(A.Ge.a,{href:"mailto:kontakt@elan-ev.de"},"kontakt@elan-ev.de"),(0,n.tZ)("br",null),(0,n.tZ)(T.G,{icon:O.j1w})," ",(0,n.tZ)(A.Ge.a,{href:"tel:+4944199866610"},"+49\u2009441 998\u2009666\u200910")),(0,n.tZ)(A.Ge.p,null,"Registergericht: Amtsgericht Oldenburg",(0,n.tZ)("br",null),"Registernummer: VR 200644",(0,n.tZ)("br",null),"USt.-ID-Nr.: DE 265901392"))}const G=function(e){return(0,n.tZ)(o.W2,null,(0,n.tZ)("article",{sx:{maxWidth:"900px",margin:"0 auto"}},(0,n.tZ)("header",null,(0,n.tZ)(A.Ge.h1,null,"Opencast Studio")),(0,n.tZ)(A.Ge.p,null,"A web-based recording studio for ",(0,n.tZ)(A.Ge.a,{href:"https://opencast.org"},"Opencast"),"."),(0,n.tZ)(A.Ge.p,null,"Opencast Studio allows you to record your camera, your display and your microphone\u02bcs audio. You can then either download your recordings or upload them directly to an Opencast instance (usually the one of your university)."),(0,n.tZ)(A.Ge.p,null,"This is free software under the terms of the"," ",(0,n.tZ)(A.Ge.a,{href:"https://github.com/elan-ev/opencast-studio/blob/master/LICENSE"},"MIT License")," ","developed by the ",(0,n.tZ)(A.Ge.a,{href:"https://elan-ev.de"},"ELAN e.V.")," in cooperation with the ",(0,n.tZ)(A.Ge.a,{href:"https://ethz.ch"},"ETH Z\xfcrich"),"."),(0,n.tZ)(A.Ge.h2,null,"How it works"),(0,n.tZ)(A.Ge.p,null,"Opencast Studio uses the recording capabilities built into modern browsers to record audio and video streams. The recording happens in the user\u02bcs browser and no server is involved in the recording."),(0,n.tZ)(i.Fragment,null,(0,n.tZ)(A.Ge.h2,null,"Support"),(0,n.tZ)(A.Ge.p,null,"If you are experiencing any difficulties or found any bugs, please take a look at the"," ",(0,n.tZ)(A.Ge.a,{href:"https://github.com/elan-ev/opencast-studio/issues"},"issue tracker on GitHub"),". Before filing a new issue, please check if one about your topic already exists. We regularly check incoming issues and do our best to address bugs in a timely manner."),(0,n.tZ)(A.Ge.p,null,"If you are interested in additional development or want to support the development of Opencast Studio, please contact"," ",(0,n.tZ)(A.Ge.a,{href:"mailto:opencast-support@elan-ev.de"},"opencast-support@elan-ev.de"),".")),(0,n.tZ)(A.Ge.h2,null,"Credits"),(0,n.tZ)(A.Ge.p,null,"Thanks to the following people and institutions for contributing to this project:"),(0,n.tZ)("ul",null,(0,n.tZ)("li",null,(0,n.tZ)(A.Ge.a,{href:"https://github.com/slampunk"},"Duncan Smith")," for starting this project"),(0,n.tZ)("li",null,(0,n.tZ)(A.Ge.a,{href:"https://github.com/cilt-uct"},"University of Cape Town (CILT)")," ","for letting Duncan start the project"),(0,n.tZ)("li",null,(0,n.tZ)(A.Ge.a,{href:"https://ethz.ch"},"ETH Z\xfcrich")," for financial support and testing"),(0,n.tZ)("li",null,(0,n.tZ)(A.Ge.a,{href:"https://github.com/elan-ev"},"ELAN e.V.")," for the re-implementation and the ongoing development"),(0,n.tZ)("li",null,"And many members from the Opencast community who helped along the way.")),(0,n.tZ)(I,null),(0,n.tZ)(A.Ge.h2,null,"Version"),(0,n.tZ)(A.Ge.p,null,"Build date ","2023-01-09",", commit"," ",(0,n.tZ)(A.Ge.a,{"aria-label":"Git commit on GitHub",href:"https://github.com/elan-ev/opencast-studio/commit/1df9501"},"1df9501"),".")))};var U=r(9175),_=r(1997);function P(){const{isRecording:e}=D(),[t]=(0,U.If)();return(0,n.tZ)("header",{sx:{height:e=>e.heights.headerHeight,lineHeight:e=>e.heights.headerHeight,color:"background",display:"flex",justifyContent:"space-between",position:"relative",zIndex:3}},(0,n.tZ)("div",{sx:{backgroundColor:"dark"===t?"gray.4":"gray.0",position:"absolute",zIndex:-3,height:"100%",width:"100%"}}),e&&(0,n.tZ)("div",{sx:{backgroundColor:"dark"===t?"gray.4":"gray.0",position:"absolute",zIndex:20,height:"100%",width:"100%",opacity:.75}}),(0,n.tZ)(H,null),(0,n.tZ)($,null))}const H=()=>{const e=(0,s.TH)(),{isRecording:t}=D();return(0,n.tZ)(a.rU,{to:{pathname:"/",search:e.search},tabIndex:t?"-1":"0",sx:{":focus-visible":{outline:e=>`5px solid ${e.colors.focus[2]} !important`,outlineOffset:"-5px"}}},(0,n.tZ)("picture",{sx:{display:"block",height:e=>e.heights.headerHeight}},(0,n.tZ)("source",{media:"(min-width: 920px)",srcSet:"/opencast-studio.svg"}),(0,n.tZ)("img",{src:"/opencast-studio-small.svg",alt:"Opencast Studio",sx:{height:e=>e.heights.headerHeight}})))},L=e=>{let{target:t,children:r,icon:o,...i}=e;const l=(0,s.TH)(),{isRecording:c}=D(),[d]=(0,U.If)();return(0,n.tZ)(a.OL,Object.assign({to:{pathname:t,search:l.search},tabIndex:c?"-1":"0",exact:!0,activeStyle:{backgroundColor:"black"},sx:{color:"white",pl:[3,"12px"],pr:[3,"12px"],textDecoration:"none",fontSize:"18px",height:["auto","100%"],borderLeft:["none",e=>`1px solid ${e.colors.gray["dark"===d?1:3]}`],display:["block","inline-block"],width:["100%","auto"],"&:hover":{backgroundColor:"dark"===d?"gray.3":"gray.1"},":focus-visible":{outline:e=>`5px solid ${e.colors.focus[2]} !important`,outlineOffset:"-5px"}}},i),(0,n.tZ)("div",{sx:{width:"20px",display:"inline-block",textAlign:"right",mr:[3,3,2],"@media screen and (max-width: 742px)":{mr:[0,0,0]},"@media screen and (max-width: 575px)":{mr:[3,3,2]}}},(0,n.tZ)(T.G,{icon:o})),(0,n.tZ)("div",{sx:{display:"inline-block","@media screen and (max-width: 742px)":{display:"none"},"@media screen and (max-width: 575px)":{display:"inline-block"}}},r))},$=e=>{const[t,r]=(0,i.useState)(!1),o=()=>r(!1),{t:a}=(0,_.$G)(),[s]=(0,U.If)();return(0,n.tZ)(i.Fragment,null,(0,n.tZ)("button",{onClick:()=>r(!t),title:a("nav-open-menu-button"),sx:{display:["inline-block","none"],border:e=>`2px solid ${e.colors.gray[3]}`,borderRadius:"10px",color:"white",my:1,px:3,mx:1,fontSize:"20px",whiteSpace:"nowrap",backgroundColor:"transparent","&:hover":{backgroundColor:"gray.1"},"&:active":{}}},a("nav-open-menu-button"),(0,n.tZ)("span",{sx:{width:"23px",display:"inline-block"}},(0,n.tZ)(T.G,{icon:t?O.NBC:O.eW2,sx:{ml:"10px"}}))),(0,n.tZ)("nav",{ref:e=>{e&&(e.style.height=t?e.scrollHeight+"px":"")},sx:{overflow:"hidden",zIndex:10,height:["0px","100% !important"],top:[e=>e.heights.headerHeight,e=>e.heights.headerHeight,0],position:["absolute","static"],width:["100%","auto"],backgroundColor:["dark"===s?"gray.4":"gray.0","none"],transition:["height 0.25s ease-out 0s","none"],scrollX:["none","auto"]}},(0,n.tZ)(L,{target:"/",icon:O.IyC,onClick:o},a("nav-recording")),(0,n.tZ)(L,{target:"/settings",icon:O.klh,onClick:o},a("nav-settings")),(0,n.tZ)(L,{target:"/shortcuts",icon:O.UFh,onClick:o},a("nav-shortcuts")),(0,n.tZ)(L,{target:"/about",icon:O.sqG,onClick:o},a("nav-about"))),t&&(0,n.tZ)("div",{onClick:o,ref:e=>e&&(e.style.opacity=1),sx:{display:[t?"block":"none","none"],backgroundColor:"rgba(0, 0, 0, 0.7)",position:"fixed",zIndex:-10,top:0,bottom:0,left:0,right:0,opacity:0,transition:"opacity 0.25s ease-out 0s"}}))};function N(e){var t;let{activeStep:r,updateActiveStep:o,...a}=e;const s={currentStep:r+1,totalSteps:(null===(t=a.children)||void 0===t?void 0:t.length)||0,nextStep:function(){d(r+1)},previousStep:function(){d(r-1)},goToStep:c,firstStep:function(){c(1)},lastStep:function(){c(a.children.length)}},l=i.Children.map(a.children,((e,t)=>(s.isActive=t===r,s.isActive?function(e){let{type:t}=e;return"function"===typeof t||"object"===typeof t}(e)?i.cloneElement(e,s):e:null)));return(0,n.tZ)(i.Fragment,null,l);function c(e){d(e-1)}function d(e){r!==e&&(!function(e,t){return e<0||e>=t.length}(e,a.children)?o(e):console.error(`${e+1} is an invalid step`))}}const z=(e,t,r)=>{var n;const o=e&&{max:e},i=(null===t||void 0===t||null===(n=t.height)||void 0===n?void 0:n.ideal)||r;return{height:{...o,...i&&(e?{ideal:Math.min(i,e)}:{ideal:i})}}};async function M(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{const r=await navigator.mediaDevices.getUserMedia({audio:!t||{deviceId:t},video:!1});r.getTracks().forEach((t=>{t.onended=()=>{e({type:"AUDIO_UNEXPETED_END"})}})),e({type:"SHARE_AUDIO",payload:r})}catch(r){console.error("Error: "+r),e({type:"BLOCK_AUDIO"})}}async function W(e,t){var r,n;let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=null!==(r=t.display)&&void 0!==r&&r.maxFps?{frameRate:{max:t.display.maxFps}}:{},a=z(null===(n=t.display)||void 0===n?void 0:n.maxHeight,o),s={video:{cursor:"always",...i,...o,...a},audio:!1};try{const t=await navigator.mediaDevices.getDisplayMedia(s);t.getTracks().forEach((t=>{t.onended=()=>{e({type:"DISPLAY_UNEXPETED_END"})}})),e({type:"SHARE_DISPLAY",payload:t})}catch(l){console.error("Error: "+l),e({type:"BLOCK_DISPLAY"})}}async function F(e,t,r){var n,o;const i=null!==(n=t.camera)&&void 0!==n&&n.maxFps?{frameRate:{max:t.camera.maxFps}}:{},a=z(null===(o=t.camera)||void 0===o?void 0:o.maxHeight,r,1080),s={video:{facingMode:"user",...r,...i,...a},audio:!1};try{const t=await navigator.mediaDevices.getUserMedia(s);t.getTracks().forEach((t=>{t.onended=()=>{e({type:"USER_UNEXPETED_END"})}})),e({type:"SHARE_USER",payload:t})}catch(l){console.error("Error: "+l),e({type:"BLOCK_USER"})}}function j(e,t){null===e||void 0===e||e.getTracks().forEach((e=>e.stop())),t({type:"UNSHARE_AUDIO"})}function q(e,t){null===e||void 0===e||e.getTracks().forEach((e=>e.stop())),t({type:"UNSHARE_DISPLAY"})}function K(e,t){null===e||void 0===e||e.getTracks().forEach((e=>e.stop())),t({type:"UNSHARE_USER"})}var B=r(3509),V=r.n(B),Y=r(8262),X=r.n(Y),Q=r(7325);(0,Q.configure)({defaultKeyEvent:"keydown",ignoreTags:["input"],ignoreEventsCondition:function(){},ignoreKeymapAndHandlerChangesByDefault:!1});const J=e=>"Mac"===["Windows","Linux","Mac"].find((e=>navigator.userAgent.includes(e)))?e.replace("Alt","Option"):e,ee="record-shortcuts",te="edit-shortcuts",re="other-shortcuts",ne="control-key",oe="shift-key",ie="space-key",ae="left-key",se="right-key",le={RECORD_DISPLAY:{name:"record-display",sequences:["1"],description:["1"],group:ee},RECORD_DISPLAY_CAMERA:{name:"record-both",sequences:["2"],description:["2"],group:ee},RECORD_CAMERA:{name:"record-camera",sequences:["3"],description:["3"],group:ee},RECORD_AUDIO:{name:"record-audio",sequences:["1"],description:["1"],group:ee},NO_AUDIO:{name:"record-no-audio",sequences:["2"],description:["2"],group:ee},START_RECORDING:{name:"start-recording",sequences:["r"],description:["r"],group:ee},STOP_RECORDING:{name:"stop-recording",sequences:["s"],description:["s"],group:ee},PAUSE_RECORDING:{name:"pause-recording",sequences:["Space","k"],description:[ie,"k"],group:ee}},ce={PLAY_PAUSE:{name:"play-pause",sequences:["Space","k"],description:[ie,"k"],group:te},FORWARD_5_SEC:{name:"skip-five",sequences:["l","ArrowRight"],description:["l",se],group:te},BACKWARDS_5_SEC:{name:"back-five",sequences:["j","ArrowLeft"],description:["j",ae],group:te},FORWARD_1_FRAME:{name:"frame-forward",sequences:["."],description:["."],group:te},BACKWARDS_1_FRAME:{name:"frame-back",sequences:[","],description:[","],group:te},CUT_LEFT:{name:"cut-left",sequences:["n"],description:["n"],group:te},CUT_RIGHT:{name:"cut-right",sequences:["m"],description:["m"],group:te},DELETE_CROP_MARK_LEFT:{name:"delete-left",sequences:["Shift+n"],description:[oe+"+n"],group:te},DELETE_CROP_MARK_RIGHT:{name:"delete-right",sequences:["Shift+m"],description:[oe+"+m"],group:te}},de={TAB:{name:"tab-elements",sequences:[],description:["Tab"],group:re},NEXT_BUTTON:{name:"next-button",sequences:["Control+ArrowRight"],description:[ne+"+"+se],group:re},BACK_BUTTON:{name:"back-button",sequences:["Control+ArrowLeft"],description:[ne+"+"+ae],group:re},UPLOAD:{name:"upload-video",sequences:[J("Alt+u")],description:[J("Alt+u")],group:re},DOWNLOAD:{name:"download-video",sequences:["d"],description:["d"],group:re},NEW_RECORDING:{name:"new-recording",sequences:["Shift+n"],description:[oe+"+n"],group:re}},ue=e=>{let{children:t}=e;return(0,n.tZ)("div",{sx:{display:"flex",flexDirection:"column",flex:"1 1 auto",justifyContent:"space-between",p:3,pt:[2,2,3],"& > h1":{textAlign:"center",fontSize:["24px","27px","32px"]}}},t)};function pe(e){let{prev:t=null,next:r=null,children:i}=e;const{t:a}=(0,_.$G)(),s={BACK_BUTTON:e=>{t&&t.onClick(e)},NEXT_BUTTON:e=>{r&&!r.disabled&&r.onClick(e)}};return(0,n.tZ)(Q.GlobalHotKeys,{keyMap:de,handlers:s},(0,n.tZ)(o.kC,{sx:{alignItems:"end",minHeight:"40px"}},(0,n.tZ)(o.xu,{sx:{flex:"1 1 0",textAlign:"left"}},t&&(0,n.tZ)(o.zx,{sx:{whiteSpace:"nowrap",...!0===t.danger?{variant:"buttons.danger"}:{variant:"buttons.text"}},onClick:t.onClick,disabled:t.disabled,danger:t.danger||!1},(0,n.tZ)(T.G,{icon:O.Uu6}),a(t.label||"back-button-label"))),(0,n.tZ)(o.xu,null,i),(0,n.tZ)(o.xu,{sx:{flex:"1 1 0",textAlign:"right"}},r&&(0,n.tZ)(o.zx,{sx:{whiteSpace:"nowrap","& svg":{mr:0,ml:2},...!0===r.danger?{variant:"buttons.danger"}:{}},onClick:r.onClick,disabled:r.disabled},a(r.label||"next-button-label"),(0,n.tZ)(T.G,{icon:O.I4f})))))}const ge=i.createContext(null),he=()=>i.useContext(ge);function me(e){let{gap:t=0,minWidth:r=180,minHeight:o=140,children:a}=e;const{ref:s,width:l=1,height:c=1}=V()(),[,d]=(0,i.useState)(0),u=(0,i.useRef)(a.map((()=>[void 0,void 0]))),p=e=>{e.forEach(((e,t)=>{let[r,n]=e;r&&n&&(u.current[t]=[r,n])}))};let g=a.map((e=>e.dimensions()));p(g);const h=()=>{const e=a.map((e=>e.dimensions()));X()(e,g)||(g=e,p(g),d((e=>e+1)))},m=e=>{let[t,r]=e;return t&&r?t/r:16/9};switch(a.length){case 1:{const e=a[0],t=m(u.current[0]);let i,d;return l>c*t?(d=c,i=c*t):(i=l,d=l/t),(0,n.tZ)(ge.Provider,{value:h},(0,n.tZ)("div",{ref:s,sx:{flex:"1 0 0",minHeight:o,display:"flex"}},(0,n.tZ)("div",{sx:{height:d,width:i,minWidth:`${r}px`,margin:"auto"}},e.body)))}case 2:{const e=u.current.map((e=>m(e))),{rowWidths:i,rowHeights:d}=(()=>{const r=l-t,n=e[0]+e[1];if(r>c*n)return{rowHeights:Array(2).fill(c),rowWidths:e.map((e=>c*e))};{const t=r/n;return{rowHeights:a.map((e=>t)),rowWidths:e.map((e=>t*e))}}})(),{colWidths:p,colHeights:g}=(()=>{const r=c-t,n=1/(1/e[0]+1/e[1]);if(l>r*n){const t=r*n;return{colHeights:a.map(((r,n)=>t/e[n])),colWidths:Array(2).fill(t)}}return{colHeights:a.map(((t,r)=>l/e[r])),colWidths:Array(2).fill(l)}})();let x,v,f;return i[0]*d[0]+i[1]*d[1]>p[0]*g[0]+p[1]*g[1]?(f="row",x=i,v=d):(f="column",x=p,v=g),(0,n.tZ)(ge.Provider,{value:h},(0,n.tZ)("div",{ref:s,sx:{flex:"1 0 0",display:"flex",flexDirection:f,justifyContent:"space-between",minHeight:o}},(0,n.tZ)("div",{sx:{height:v[0],width:x[0],minWidth:`${r}px`,margin:"auto"}},a[0].body),(0,n.tZ)("div",{sx:{height:v[1],width:x[1],minWidth:`${r}px`,margin:"auto"}},a[1].body)))}default:return(0,n.tZ)("p",null,"Internal error: too few or too many video streams")}}const xe=e=>{let{isDanger:t,...r}=e;return(0,n.tZ)("div",Object.assign({sx:{":not(:last-child)":{marginBottom:"1.5rem"},backgroundColor:t?"error":"gray.3",color:t?"notification_text":"currentColor",borderRadius:2,padding:3,position:"relative"}},r))};var ve=r(8622),fe=r.n(ve);function Ze(e){let{stream:t}=e;const r=(0,i.useRef)();return(0,i.useEffect)((()=>{const e=r.current;if(e){const r=e.getContext("2d");r.lineWidth=2,r.strokeStyle="#f1c40f";const n=(new(window.AudioContext||window.webkitAudioContext)).createMediaStreamSource(t),o=new(fe())(n,{fftSize:1024});return o.animate(r),()=>o.stop()}return()=>{}}),[t]),(0,n.tZ)("canvas",{ref:r,width:"800px",height:"200px",sx:{width:"100%",maxHeight:"200px",minHeight:0,flex:"1 0 70px",bg:"rgba(0,0,0,0.8)",borderRadius:"7px"}})}const be="ocStudioLastAudioDevice";function ye(e){const t=R(),{audioStream:r,audioChoice:o}=D(),i=()=>e.previousStep(),a=()=>e.nextStep(),s=()=>a(),l=async()=>{t({type:"CHOOSE_AUDIO",payload:p});const e=window.localStorage.getItem(be);await M(t,e?{ideal:e}:null),await(0,u.NN)(t)},c=()=>{r&&j(r,t),t({type:"CHOOSE_AUDIO",payload:g})},d=(()=>{switch(o){case g:return(0,n.tZ)(we,{selectNoAudio:s,selectMicrophone:l,backToVideoSetup:i});case p:return(0,n.tZ)(Se,{reselectSource:c,enterStudio:a});default:return"internal error :-("}})();return(0,n.tZ)(ue,null,d)}const we=e=>{let{selectNoAudio:t,selectMicrophone:r,backToVideoSetup:a}=e;const{t:s}=(0,_.$G)(),l={RECORD_AUDIO:e=>{e&&r(e)},NO_AUDIO:e=>{e&&t(e)}};return(0,n.tZ)(Q.GlobalHotKeys,{keyMap:le,handlers:l},(0,n.tZ)(i.Fragment,null,(0,n.tZ)(A.Ge.h1,null,s("sources-audio-question")),(0,n.tZ)(o.kC,{sx:{flexDirection:["column","row"],maxWidth:850,width:"100%",mx:"auto",mb:3,flex:"1 0 auto",maxHeight:["none","350px"],"& > :first-of-type":{mb:[3,0],mr:[0,3]}}},(0,n.tZ)(ke,{icon:O.UOM,label:s("sources-audio-microphone"),onClick:r}),(0,n.tZ)(ke,{icon:O.EkX,label:s("sources-audio-without-audio"),onClick:t})),(0,n.tZ)(pe,{prev:{onClick:a}})))},Se=e=>{var t,r,a;let{reselectSource:s,enterStudio:l}=e;const{t:c}=(0,_.$G)(),d=R(),p=D(),{audioStream:g,audioAllowed:h,audioUnexpectedEnd:m}=p,x=null===g||void 0===g||null===(t=g.getAudioTracks())||void 0===t||null===(r=t[0])||void 0===r||null===(a=r.getSettings())||void 0===a?void 0:a.deviceId,v=(0,u.Mz)(p.mediaDevices,"audioinput");(0,i.useEffect)((()=>{x&&window.localStorage.setItem(be,x)}));const f=e=>{let{min:t,max:r}=e;return(0,n.tZ)("div",{sx:{flex:1,maxHeight:r,minHeight:t}})};let Z;return Z=g?(0,n.tZ)(i.Fragment,null,(0,n.tZ)(Ze,{stream:g}),(0,n.tZ)("div",{sx:{display:"flex",width:"80%",my:3,fontSize:"18px",minWidth:"285px","align-items":"center"}},(0,n.tZ)("label",{htmlFor:"sources-audio-device",sx:{mr:3,display:"flex",flexDirection:"column",alignItems:"center"}},c("sources-audio-device"),":"),(0,n.tZ)("select",{id:"sources-audio-device",sx:{variant:"styles.select",flex:"1 0 0",minWidth:0},value:x,onChange:e=>(async e=>{g&&j(g,d),await M(d,{exact:e})})(e.target.value)},v.map(((e,t)=>(0,n.tZ)("option",{key:t,value:e.deviceId},e.label||"unlabeled microphone")))))):!1===h?(0,n.tZ)(i.Fragment,null,(0,n.tZ)(T.G,{icon:O.eHv,size:"3x"}),(0,n.tZ)(f,{min:"16px",max:"48px"}),(0,n.tZ)(xe,{isDanger:!0},(0,n.tZ)(o.X6,{as:"h3",mb:2},c("source-audio-not-allowed-title")),(0,n.tZ)(o.xv,{variant:"text"},c("source-audio-not-allowed-text")))):!0===m?(0,n.tZ)(i.Fragment,null,(0,n.tZ)(T.G,{icon:O.eHv,size:"3x"}),(0,n.tZ)(f,{min:"16px",max:"48px"}),(0,n.tZ)(xe,{isDanger:!0},(0,n.tZ)(o.xv,{variant:"text"},c("error-lost-audio-stream")))):(0,n.tZ)(o.$j,{size:"75"}),(0,n.tZ)(i.Fragment,null,(0,n.tZ)(A.Ge.h1,null,c("sources-audio-microphone-selected")),(0,n.tZ)("div",{sx:{maxWidth:850,width:"100%",mx:"auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flex:"1 0 auto",maxHeight:"400px"}},Z),(0,n.tZ)(pe,{prev:{label:"sources-audio-reselect-audio",onClick:s},next:{onClick:l}}))},ke=e=>{let{children:t,icon:r,label:o,onClick:i}=e;return(0,n.tZ)("button",{onClick:i,sx:{fontFamily:"inherit",color:"gray.0",backgroundColor:"gray.4",border:"2px solid black",borderRadius:"8px",flex:"0 1 50%",p:2,"&:hover":{boxShadow:e=>`0 0 10px ${e.colors.gray[2]}`,filter:"brightness(1.2)"}}},(0,n.tZ)("div",{sx:{display:"block",textAlign:"center",mb:3}},(0,n.tZ)(T.G,{icon:r,size:"3x"})),(0,n.tZ)("div",{sx:{fontSize:4}},o),t)};var Ee=r(4567),Ce=r(7785),Re=r(374);const De=e=>{let{errors:t,register:r,label:o,name:i,required:a,validate:s,type:l="text",...c}=e;const{t:d}=(0,_.$G)();return(0,n.tZ)("div",{sx:{"&:not(:last-child)":{mb:3}}},(0,n.tZ)("label",{sx:{color:"text",display:"block",fontSize:2,fontWeight:"bold"}},o,(0,n.tZ)("div",{sx:{display:"block",boxSizing:"border-box",clear:"both",fontSize:2,position:"relative",textAlign:"left"}},(0,n.tZ)("input",Object.assign({"aria-invalid":t[i]?"true":"false","aria-describedby":`${i}Error`,autoComplete:"off",name:i,ref:r({validate:s,...a?{required:d("forms-validation-error-required")}:{}}),sx:{variant:"styles.input"},type:l},c)),t[i]&&(0,n.tZ)("p",{id:`${i}Error`,sx:{color:"error",fontSize:1,fontWeight:"body",mt:1}},t[i].message))))},Ae=e=>{let{onDownload:t,recording:r,title:i,presenter:a}=e;const{t:s,i18n:l}=(0,_.$G)(),{deviceType:c,mimeType:d,url:p,downloaded:g,media:h}=r,m=s("desktop"===c?"sources-display":"sources-user"),x=(0,u.oe)({mimeType:d,flavor:m,title:i,presenter:a});if(!p)return null;const v=h.size,f=e=>{const t=e<10?1:0;return e.toLocaleString(l.language,{minimumFractionDigits:t,maximumFractionDigits:t})},Z=v<1e3?`${v} B`:v<999500?`${f(v/1e3)} KB`:v<9995e5?`${f(v/1e6)} MB`:`${f(v/1e9)} GB`;return(0,n.tZ)("div",{sx:{display:"flex",flexDirection:"column",flex:"0 0 auto",mx:2,pb:"12px",alignItems:"center"}},(0,n.tZ)("div",{sx:{position:"relative",height:"150px",border:e=>`2px solid ${e.colors.gray[1]}`}},(0,n.tZ)("video",{tabIndex:"-1",muted:!0,src:p,onLoadedData:e=>e.target.currentTime=0,preload:"auto",sx:{maxWidth:"100%",height:"100%"}}),g&&(0,n.tZ)("div",{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",color:"primary",backgroundColor:"rgba(0, 0, 0, 0.4)"}},(0,n.tZ)(T.G,{icon:O.f8k,size:"4x"}))),(0,n.tZ)(o.zx,{as:"a",role:"button",sx:{width:"100%",maxWidth:"215px",margin:"auto",mt:"10px"},target:"_blank",download:x,href:p,rel:"noopener noreferrer",onClick:t},(0,n.tZ)(T.G,{icon:O.q7m}),s("save-creation-download-button")," ","(",Z,")"))},Te="ocStudioLastPresenter";let Oe=[];function Ie(e){const t=(0,d.rV)(),{t:r}=(0,_.$G)(),a=(0,Re.mx)(),{recordings:s,upload:l,title:c,presenter:u,start:p,end:g}=D(),h=R();function m(e){const t=Date.now();Oe.push({timestamp:t,progress:e});const r=Math.min(Oe.findIndex((e=>t-e.timestamp<5e3)),Math.max(0,Oe.length-6));Oe.splice(0,r);let n=null;if(Oe.length>=4){const r=t-Oe[0].timestamp,o=(e-Oe[0].progress)/r*1e3,i=1-e;n=Math.max(0,Math.round(i/o))}l.secondsLeft===n&&l.currentProgress===e||h({type:"UPLOAD_PROGRESS_UPDATE",payload:{secondsLeft:n,currentProgress:e}})}async function x(){h({type:"UPLOAD_REQUEST"}),Oe.push({timestamp:Date.now(),progress:0});const e=await a.upload({recordings:s.filter(Boolean),title:c,presenter:u,start:p,end:g,uploadSettings:t.upload,onProgress:m});switch(Oe=[],e){case Re.p5:h({type:"UPLOAD_SUCCESS"});break;case Re.WS:h({type:"UPLOAD_ERROR",payload:r("save-creation-upload-network-error")});break;case Re.Di:h({type:"UPLOAD_ERROR",payload:r("save-creation-upload-not-authorized")});break;case Re.jR:h({type:"UPLOAD_ERROR",payload:r("save-creation-upload-invalid-response")});break;default:h({type:"UPLOAD_ERROR",payload:r("save-creation-upload-unknown-error")})}}(0,i.useEffect)((()=>{const e=setInterval((()=>{if(l.state===Z)if(Oe.length){const e=Oe[Oe.length-1];Date.now()-e.timestamp>3e3&&m(e.progress)}else m(0)}),1e3);return()=>clearInterval(e)}));const v=s.every((e=>e.downloaded)),y=(l.state===b||v)&&l.state!==Z,w=l.state!==f||v,S=(()=>{if(l.state===f&&(a.getState()===Re.rV||a.getState()===Re.HY))return(0,n.tZ)(Pe,null);switch(l.state){case Z:return(0,n.tZ)($e,{currentProgress:l.currentProgress,secondsLeft:l.secondsLeft});case b:return(0,n.tZ)(Ne,null);default:return(0,n.tZ)(He,{uploadState:l,handleUpload:x})}})();return(0,n.tZ)(o.W2,{sx:{display:"flex",flexDirection:"column",flex:"1 0 auto"}},(0,n.tZ)(A.Ge.h1,{sx:{textAlign:"center",fontSize:["26px","30px","32px"]}},r(y?"save-creation-title-done":"save-creation-title")),(0,n.tZ)("div",{sx:{display:"flex",flexDirection:["column","column","row"],"& > *":{flex:["0","0","1 0 50%"],p:[2,2,"0 32px"],"&:last-child":{borderLeft:["none","none",e=>`1px solid ${e.colors.gray[3]}`]}}}},(0,n.tZ)("div",null,(0,n.tZ)(A.Ge.h2,{sx:{pb:1,borderBottom:e=>`1px solid ${e.colors.gray[2]}`}},r("save-creation-subsection-title-upload")),(0,n.tZ)("div",{sx:{margin:"auto"}},S)),(0,n.tZ)("div",null,(0,n.tZ)(A.Ge.h2,{sx:{pb:1,borderBottom:e=>`1px solid ${e.colors.gray[2]}`}},r("save-creation-subsection-title-download")),(0,n.tZ)(_e,{dispatch:h,title:c,presenter:u}))),(0,n.tZ)("div",{sx:{flex:"1 0 32px"}}),(0,n.tZ)(pe,{next:null,prev:w?null:{onClick:function(){e.previousStep()},disabled:!1}},y&&(0,n.tZ)(Ge,{goToFirstStep:e.firstStep})))}const Ge=e=>{var t;let{goToFirstStep:r}=e;const{t:i}=(0,_.$G)(),a=R(),s=(0,d.rV)(),l=()=>{window.confirm(i("save-creation-new-recording-warning"))&&(a({type:"RESET"}),r())};let c;if(null!==(t=s.return)&&void 0!==t&&t.target)if(Ue(s)){var u;const e=null!==(u=s.return)&&void 0!==u&&u.label?i("save-creation-return-to",{label:s.return.label}):i("save-creation-return-to-no-label");c=(0,n.tZ)(o.zx,{as:"a",title:e,href:s.return.target,sx:{whiteSpace:"nowrap",fontWeight:400,mb:2}},(0,n.tZ)(T.G,{icon:O.nYk}),e)}else console.warn("the given 'return.target' is not allowed (check 'return.allowedDomains' in 'settings.toml')");const p={NEW_RECORDING:e=>{e&&l()}};return(0,n.tZ)(Q.GlobalHotKeys,{keyMap:de,handlers:p},(0,n.tZ)("div",{sx:{display:"flex",flexDirection:"column"}},c,(0,n.tZ)(o.zx,{sx:{whiteSpace:"nowrap"},title:i("save-creation-new-recording"),onClick:l},(0,n.tZ)(T.G,{icon:O.tmN}),i("save-creation-new-recording"))))},Ue=e=>{var t;let r;try{r=new URL(e.return.target,window.location)}catch(n){return!1}return[window.location.hostname,...(null===(t=e.return)||void 0===t?void 0:t.allowedDomains)||[]].some((e=>r.hostname===e))&&("https:"===r.protocol||"http:"===r.protocol)},_e=e=>{let{presenter:t,title:r}=e;const{t:a}=(0,_.$G)(),s=R(),{recordings:l,start:c,end:d}=D(),u={DOWNLOAD:e=>{e&&(()=>{var e=document.querySelectorAll("a[href^='blob']");for(const t of e)t.click()})()}};return(0,n.tZ)(Q.GlobalHotKeys,{keyMap:de,handlers:u},(0,n.tZ)(i.Fragment,null,(null!==c||null!==d)&&(0,n.tZ)(xe,{sx:{display:"flex",flexDirection:"column",alignItems:"center"}},(0,n.tZ)(T.G,{icon:O.eHv,sx:{fontSize:"26px",mb:3}}),(0,n.tZ)("p",{sx:{m:0}},a("save-creation-download-cut-warning"))),(0,n.tZ)("div",{sx:{display:"flex",flexDirection:"row",justifyContent:["center","center","start"],flexWrap:"wrap"}},0===l.length?(0,n.tZ)(o.$j,null):l.map(((e,o)=>(0,n.tZ)(Ae,{key:o,recording:e,presenter:t,title:r,onDownload:()=>s({type:"MARK_DOWNLOADED",payload:o})}))))))},Pe=()=>{const e=(0,s.TH)(),[t]=(0,U.If)();return(0,n.tZ)(xe,{key:"opencast-connection",isDanger:!0},(0,n.tZ)(_.cC,{i18nKey:"warning-missing-connection-settings"},"Warning.",(0,n.tZ)(a.rU,{to:{pathname:"/settings",search:e.search},sx:{variant:"styles.a",color:"dark"===t?"rgba(255, 255, 34, 0.8)":"#ff2"}},"settings")))},He=e=>{let{uploadState:t,handleUpload:r}=e;const{titleField:a=d.UY,presenterField:s=d.UY}=(0,d.rV)().upload||{},{t:l}=(0,_.$G)(),c=(0,Re.mx)(),u=R(),{recordings:p,title:g,presenter:h}=D(),m=h||window.localStorage.getItem(Te)||"",{errors:x,handleSubmit:v,register:f}=(0,Ee.ZP)();function Z(e){const t=e.target;u({type:{title:"UPDATE_TITLE",presenter:"UPDATE_PRESENTER"}[t.name],payload:t.value}),"presenter"===t.name&&window.localStorage.setItem(Te,t.value)}(0,i.useEffect)((()=>{m!==h&&u({type:"UPDATE_PRESENTER",payload:m})}));const b=c.prettyServerUrl()?(0,n.tZ)(_.cC,{i18nKey:"save-creation-upload-to"},"Upload to ",(0,n.tZ)("code",{sx:{backgroundColor:"rgba(0, 0, 0, 0.1)",borderRadius:"5px",padding:"1px 3px"}},{server:c.prettyServerUrl()})):l("save-creation-button-upload"),w=(0,i.useRef)(null),S={UPLOAD:e=>{var t;e&&(null===(t=w.current)||void 0===t||t.click())}};return(0,n.tZ)(Q.GlobalHotKeys,{keyMap:de,handlers:S},(0,n.tZ)(i.Fragment,null,(0,n.tZ)(Le,null),(0,n.tZ)("form",null,a!==d.V9&&(0,n.tZ)(De,{name:"title",label:l("save-creation-label-title"),required:a===d.UY,onChange:Z,autoComplete:"off",defaultValue:g,errors:x,register:f}),s!==d.V9&&(0,n.tZ)(De,{name:"presenter",label:l("save-creation-label-presenter"),required:s===d.UY,onChange:Z,autoComplete:"off",defaultValue:m,errors:x,register:f}),(0,n.tZ)(o.zx,{disabled:0===p.length,onClick:v(r),ref:w},(0,n.tZ)(T.G,{icon:O.cf$}),b)),(0,n.tZ)(o.xu,{sx:{mt:2}},t.state===y&&(0,n.tZ)(xe,{isDanger:!0},t.error))))},Le=()=>{const e=(0,s.TH)(),t=(0,Re.mx)(),{t:r}=(0,_.$G)(),l=(0,Ce.Z)(),[c,d]=(0,i.useState)(!1);if((0,i.useEffect)((()=>{if(!t.isReadyToUpload()&&!c&&l){const e=setTimeout((async()=>{d(!0),await t.refreshConnection(),d(!1)}),5e3);return()=>clearTimeout(e)}})),t.isReadyToUpload())return null;let u,p;switch(t.getState()){case Re.RY:u=r("save-creation-warn-unreachable"),p=r("save-creation-warn-once-reestablished");break;case Re.F8:if(t.isLoginProvided()){const e=document.referrer;u=(0,n.tZ)(_.cC,{i18nKey:"save-creation-warn-session-expired"},"Foo",e&&!e.includes(window.origin||"")?(0,n.tZ)(A.Ge.a,{href:e,target:"_blank",sx:{color:"#ff2"}},"bar"):(0,n.tZ)(i.Fragment,null,"bar"),"baz"),r("save-creation-warn-session-expired"),p=r("save-creation-warn-once-refreshed")}else u=(0,n.tZ)(_.cC,{i18nKey:"save-creation-warn-login-failed"},"Failed.",(0,n.tZ)(a.rU,{to:{pathname:"/settings",search:e.search},sx:{variant:"styles.a",color:"#ff2"}},"settings")),p=r("save-creation-warn-once-logged-in");break;case Re.J$:case Re.iL:u=r("save-creation-warn-server-problem")+" "+r("save-creation-warn-download-hint");break;default:u="Internal error :-("}return(0,n.tZ)(xe,{isDanger:!0},(0,n.tZ)("div",{sx:{textAlign:"center",fontSize:"40px",lineHeight:1.3}},c?(0,n.tZ)(o.$j,{size:"40"}):(0,n.tZ)(T.G,{icon:O.eHv})),(0,n.tZ)("p",{sx:{mb:0}},u),p&&(0,n.tZ)("p",{sx:{mb:0}},p,p&&" ",r("save-creation-warn-download-hint")))},$e=e=>{let{currentProgress:t,secondsLeft:r}=e;const{t:a,i18n:s}=(0,_.$G)(),l=Math.min(100,100*t).toLocaleString(s.language,{minimumFractionDigits:1,maximumFractionDigits:1});let c;return c=null===r?null:r<4?a("upload-time-a-few-seconds"):r<45?`${r} ${a("upload-time-seconds")}`:r<90?a("upload-time-a-minute"):r<2700?`${Math.round(r/60)} ${a("upload-time-minutes")}`:r<5400?a("upload-time-an-hour"):r<86400?`${Math.round(r/3600)} ${a("upload-time-hours")}`:null,(0,n.tZ)(i.Fragment,null,(0,n.tZ)("div",{sx:{display:"flex",mb:2}},(0,n.tZ)(o.xv,{variant:"text"},l,"%"),(0,n.tZ)("div",{sx:{flex:1}}),(0,n.tZ)(o.xv,{variant:"text"},c&&(0,n.tZ)(_.cC,{i18nKey:"upload-time-left"},{time:c}," left"))),(0,n.tZ)(o.Ex,{max:1,value:t,variant:"styles.progress"},l),(0,n.tZ)(o.xv,{variant:"text",sx:{textAlign:"center",mt:2}},a("upload-notification")))},Ne=()=>{const{t:e}=(0,_.$G)();return(0,n.tZ)(i.Fragment,null,(0,n.tZ)("div",{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"130px",color:"primary"}},(0,n.tZ)(T.G,{icon:O.f8k,size:"4x"})),(0,n.tZ)(o.xv,{variant:"text",sx:{textAlign:"center"}},e("message-upload-complete")),(0,n.tZ)(o.xv,{sx:{textAlign:"center",mt:2}},e("message-upload-complete-explanation")))};var ze=r(1067);r(4992),r(5904);const Me=e=>{let{content:t,...r}=e;return(0,n.tZ)(ze.ZP,Object.assign({content:(0,n.tZ)("span",null," ",t," "),interactive:!0,sx:{fontSize:"16px",backgroundColor:e=>e.colors.tooltip,color:e=>e.colors.tooltip_text,lineHeight:"normal",fontFamily:"Open Sans"}},r),(0,n.tZ)("span",null," ",r.children," "))},We=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=e.deviceId&&{deviceId:{[t?"exact":"ideal"]:e.deviceId}},n=je(e.aspectRatio),o=n&&{aspectRatio:{ideal:n}},i=qe(e.quality),a=i&&{height:{ideal:i}};return{...r,...o,...a}},Fe=["4:3","16:9"],je=e=>({"4:3":4/3,"16:9":16/9}[e]||null),qe=e=>/^[0-9]+p$/.test(e)?parseInt(e):null,Ke="ocStudioLastVideoDevice",Be="ocStudioCameraAspectRatio",Ve="ocStudioCameraQuality",Ye="ocStudioDisplayQuality",Xe=()=>({deviceId:window.localStorage.getItem(Ke),aspectRatio:window.localStorage.getItem(Be)||"auto",quality:window.localStorage.getItem(Ve)||"auto"}),Qe=()=>({quality:window.localStorage.getItem(Ye)||"auto"}),Je=e=>{let{isDesktop:t,stream:r}=e;const o=R(),a=(0,d.rV)(),[s,l]=(0,i.useState)(0),{ref:c}=V()({onResize:()=>{var e;return l((null===(e=c.current)||void 0===e?void 0:e.offsetHeight)+4)}}),{t:u}=(0,_.$G)(),p=t?Qe():Xe(),g=e=>{const n={...p,...e},i=We(n,!0);t?(window.localStorage.setItem(Ye,n.quality),q(r,o),W(o,a,i)):(window.localStorage.setItem(Ke,n.deviceId),window.localStorage.setItem(Be,n.aspectRatio),window.localStorage.setItem(Ve,n.quality),K(r,o),F(o,a,i))};(0,i.useEffect)((()=>{const e=at(r);!t&&e&&window.localStorage.setItem(Ke,e)}));const[h,m]=(0,i.useState)(!1),[x]=(0,U.If)();return(0,n.tZ)(i.Fragment,null,(0,n.tZ)("div",{sx:{position:"absolute",top:h?"8px":"-30px",left:0,right:0,textAlign:"center",transition:"top 0.2s"}},(0,n.tZ)("span",{sx:{color:"dark"===x?"gray.3":"gray.1",backgroundColor:"white",borderRadius:"10px",p:1,fontSize:"18px"}},(0,n.tZ)(et,{stream:r}))),(0,n.tZ)("div",{sx:{position:"absolute",left:0,right:0,bottom:0,height:"100%",display:"flex",flexDirection:"column",justifyContent:"flex-end"}},(0,n.tZ)("div",{sx:{textAlign:"right"}},(0,n.tZ)(Me,{offset:[0,25],content:u(h?"video-settings-close":"video-settings-open")},(0,n.tZ)("button",{onClick:()=>m((e=>!e)),sx:{border:"none",display:"inline-block",backgroundColor:"rgba(0, 0, 0, 0.5)",color:"white",p:"6px",m:2,fontSize:"30px",lineHeight:"1em",borderRadius:"10px",cursor:"pointer","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)"},"&:hover > svg, &:focus > svg":{transform:h?"none":"rotate(45deg)"},"&:focus-visible":{outline:e=>`5px solid ${e.colors.primary}`,outlineOffset:"-2px",backgroundColor:"rgba(0, 0, 0, 0.7)",color:"white"}}},(0,n.tZ)(T.G,{icon:h?O.NBC:O.b7W,fixedWidth:!0,sx:{transition:h?"none":"transform 0.2s",width:"1em !important"}})))),(0,n.tZ)("div",{sx:{height:h?s||"auto":0,flex:"0 1 auto",transition:"height 0.2s",overflow:"hidden",backgroundColor:"background",fontSize:"18px",boxShadow:h?"0 0 15px rgba(0, 0, 0, 0.3)":"none"}},(0,n.tZ)("div",{tabIndex:"-1",sx:{border:e=>`1px solid ${e.colors.gray[0]}`,height:"100%",overflow:"auto"}},(0,n.tZ)("div",{ref:c,sx:{p:1,pb:"2px"}},(0,n.tZ)("div",{sx:{display:"grid",width:"100%",gridTemplateColumns:"auto 1fr",gridGap:"6px 12px",p:1}},!t&&(0,n.tZ)(ot,{updatePrefs:g,prefs:p,isExpanded:h}),(0,n.tZ)(nt,{isDesktop:t,updatePrefs:g,prefs:p,stream:r,settings:a,isExpanded:h})),(0,n.tZ)("div",{sx:{backgroundColor:"gray.4",m:2,py:1,px:2,fontSize:"16px",lineHeight:"20px",border:e=>`1px solid ${e.colors.gray[2]}`}},(0,n.tZ)(_.cC,{i18nKey:"sources-video-preferences-note"},(0,n.tZ)("strong",null,"Note:")," Explanation.")))))))},et=e=>{var t,r;let{stream:n}=e;const o=null===n||void 0===n||null===(t=n.getVideoTracks())||void 0===t||null===(r=t[0])||void 0===r?void 0:r.getSettings(),i=o&&o.width&&o.height?`${o.width}\xd7${o.height}`:"",a=o&&o.frameRate?`${o.frameRate} fps`:"";return o?[i,a].join(", "):"..."},tt=e=>{let{children:t}=e;return(0,n.tZ)("div",{sx:{gridColumn:"0 1",display:"flex",flexDirection:"column",justifyContent:"center",hyphens:"auto"}},t)},rt=e=>{let{children:t}=e;return(0,n.tZ)("div",{tabIndex:-1,sx:{gridColumn:"1 2",overflowX:"auto",lineHeight:"30px","*:focus-visible":{outline:e=>`5px solid ${e.colors.primary}`,outlineOffset:"-3px"}}},t)},nt=e=>{var t,r;let{isDesktop:o,updatePrefs:a,prefs:s,stream:l,settings:c,isExpanded:d}=e;const{t:p}=(0,_.$G)(),g=e=>a({quality:e}),h=(e=>{let t=[360,480,720,1080,1440,2160].filter((t=>!e||t<=e));return!e||0!==t.length&&t[t.length-1]===e||t.push(e),t.map((e=>`${e}p`))})(o?null===(t=c.display)||void 0===t?void 0:t.maxHeight:null===(r=c.camera)||void 0===r?void 0:r.maxHeight),m=o?"desktop":"user",[,x]=(0,u.Ld)(l);let v;if(x&&h.includes(s.quality)){const e=parseInt(s.quality);v=e===x?"ok":"warn"}return(0,n.tZ)(i.Fragment,null,(0,n.tZ)(tt,null,p("sources-video-quality"),"*:"),(0,n.tZ)(rt,null,(0,n.tZ)(it,{isExpanded:d,id:`quality-auto-${m}`,value:"auto",name:`quality-${m}`,label:p("sources-video-quality-auto"),onChange:g,checked:h.every((e=>s.quality!==e))}),h.map((e=>(0,n.tZ)(i.Fragment,{key:`${e}-${m}`},(0,n.tZ)("wbr",null),(0,n.tZ)(it,{isExpanded:d,id:`quality-${e}-${m}`,value:e,name:`quality-${m}`,onChange:g,checked:s.quality===e,state:v}))))))},ot=e=>{let{updatePrefs:t,prefs:r,isExpanded:o}=e;const{t:a}=(0,_.$G)(),s=D(),l=at(s.userStream),c=(0,u.Mz)(s.mediaDevices,"videoinput"),[d,p]=(0,u.Ld)(s.userStream);let g;if(d&&p&&Fe.includes(r.aspectRatio)){const e=d/p,t=je(r.aspectRatio);g=.97*t<e&&e<t/.97?"ok":"warn"}const h=e=>t({aspectRatio:e});return(0,n.tZ)(i.Fragment,null,(0,n.tZ)(tt,null,(0,n.tZ)("label",{htmlFor:"sources-video-device"},a("sources-video-device"),":")),(0,n.tZ)(rt,null,(0,n.tZ)("select",{id:"sources-video-device",tabIndex:o?"0":"-1",sx:{variant:"styles.select"},value:l,onChange:e=>{return r=e.target.value,t({deviceId:r});var r}},c.map(((e,t)=>(0,n.tZ)("option",{key:t,value:e.deviceId},e.label))))),(0,n.tZ)(tt,null,a("sources-video-aspect-ratio"),"*:"),(0,n.tZ)(rt,null,(0,n.tZ)(it,{isExpanded:o,id:"ar-auto",value:"auto",name:"aspectRatio",label:a("sources-video-aspect-ratio-auto"),onChange:h,checked:Fe.every((e=>r.aspectRatio!==e))}),Fe.map((e=>(0,n.tZ)(i.Fragment,{key:`ar-${e}`},(0,n.tZ)("wbr",null),(0,n.tZ)(it,{isExpanded:o,id:`ar-${e}`,value:e,name:"aspectRatio",onChange:h,checked:r.aspectRatio===e,state:g}))))))},it=e=>{let{id:t,value:r,checked:o,name:a,onChange:s,label:l,isExpanded:c}=e;return(0,n.tZ)(i.Fragment,null,(0,n.tZ)("input",{type:"radio",onChange:e=>s(e.target.value),id:t,value:r,checked:o,name:a,sx:{display:"none","&+label":{border:e=>`2px solid ${e.colors.gray[0]}`,p:"1px 4px",borderRadius:"6px",mx:1},"&:checked+label":{bg:"gray.0",color:"background",fontWeight:"bold"}}}),(0,n.tZ)("label",{tabIndex:c?"0":"-1",onKeyDown:e=>("Enter"===e.key||" "===e.key)&&s(r),htmlFor:t},l||r))},at=e=>{var t,r,n;return null===e||void 0===e||null===(t=e.getVideoTracks())||void 0===t||null===(r=t[0])||void 0===r||null===(n=r.getSettings())||void 0===n?void 0:n.deviceId},st=e=>{let t,{warnings:r,inputs:o}=e;switch(o.length){case 1:t=[{body:(0,n.tZ)(lt,{input:o[0]}),dimensions:()=>(0,u.Ld)(o[0].stream)}];break;case 2:t=[{body:(0,n.tZ)(lt,{input:o[0]}),dimensions:()=>(0,u.Ld)(o[0].stream)},{body:(0,n.tZ)(lt,{input:o[1]}),dimensions:()=>(0,u.Ld)(o[1].stream)}];break;default:return(0,n.tZ)("p",null,"Something went very wrong")}return(0,n.tZ)(i.Fragment,null,r,(0,n.tZ)(me,{minWidth:300,gap:20},t))},lt=e=>{let{input:t,text:r}=e;return(0,n.tZ)(o.Zb,{sx:{height:"100%",overflow:"hidden",backgroundColor:"element_bg"}},(0,n.tZ)(ct,{input:t}),(0,n.tZ)(Je,{isDesktop:t.isDesktop,stream:t.stream}))},ct=e=>{let{input:t}=e;const{allowed:r,stream:a,unexpectedEnd:s}=t,l=he(),c=(0,i.useRef)();if((0,i.useEffect)((()=>{const e=c.current;return e&&(e.srcObject||(e.srcObject=a),e.addEventListener("resize",l)),()=>{e&&e.removeEventListener("resize",l)}}),[a,l]),!a){let e;return e=!1===r||s?(0,n.tZ)(T.G,{icon:O.eHv,size:"3x"}):(0,n.tZ)(o.$j,{size:"75"}),(0,n.tZ)("div",{tabIndex:"-1",sx:{width:"100%",height:"100%",minHeight:"120px",display:"flex",justifyContent:"center",alignItems:"center"}},e)}return(0,n.tZ)("video",{tabIndex:"-1",ref:c,autoPlay:!0,muted:!0,sx:{minHeight:0,display:"block",width:"100%",height:"100%"}})};function dt(e){let{nextStep:t,userHasWebcam:r}=e;const{t:i}=(0,_.$G)(),a=R(),s=D(),{displayStream:l,userStream:c,videoChoice:d}=s,u=e=>a({type:"CHOOSE_VIDEO",payload:e}),p=d===v||d===h?!l||!c:!(l||c),g=!1===s.userAllowed&&(0,n.tZ)(xe,{key:"user-stream-warning",isDanger:!0},(0,n.tZ)(o.X6,{as:"h3",mb:2},i("source-user-not-allowed-title")),(0,n.tZ)(o.xv,null,i("source-user-not-allowed-text"))),f=!1===s.displayAllowed&&(0,n.tZ)(xe,{key:"display-stream-warning",isDanger:!0},(0,n.tZ)(o.X6,{as:"h3",mb:2},i("source-display-not-allowed-title")),(0,n.tZ)(o.xv,null,i("source-display-not-allowed-text"))),Z=(s.userUnexpectedEnd||s.displayUnexpectedEnd)&&(0,n.tZ)(xe,{key:"unexpexted-stream-end-warning",isDanger:!0},(0,n.tZ)(o.xv,null,i("error-lost-video-stream"))),b={isDesktop:!1,stream:c,allowed:s.userAllowed,unexpectedEnd:s.userUnexpectedEnd},y={isDesktop:!0,stream:l,allowed:s.displayAllowed,unexpectedEnd:s.displayUnexpectedEnd};let w,S,k;switch(d){case v:const e=We(Xe()),t=We(Qe());S=i("sources-video-question"),w=!0,k=(0,n.tZ)(ut,{setActiveSource:u,userConstraints:e,displayConstraints:t,userHasWebcam:r});break;case x:S=i("sources-video-user-selected"),w=!c&&!1!==s.userAllowed,k=(0,n.tZ)(st,{warnings:[g,Z],inputs:[b]});break;case m:S=i("sources-video-display-selected"),w=!l&&!1!==s.displayAllowed,k=(0,n.tZ)(st,{warnings:[f,Z],inputs:[y]});break;case h:S=i("sources-video-display-and-user-selected"),w=!c&&!1!==s.userAllowed||!l&&!1!==s.displayAllowed,k=(0,n.tZ)(st,{warnings:[f,g,Z],inputs:[y,b]});break;default:return console.error("bug: active source has an unexpected value"),(0,n.tZ)("p",null,"Something went very wrong (internal error) :-(")}const E=w&&!s.userUnexpectedEnd&&!s.displayUnexpectedEnd;return(0,n.tZ)(ue,null,(0,n.tZ)(A.Ge.h1,null,S),k,d!==v&&(0,n.tZ)("div",{sx:{mb:3}}),d!==v&&(0,n.tZ)(pe,{next:w?null:{onClick:()=>t(),disabled:p},prev:E?null:{onClick:()=>{u(v),K(c,a),q(l,a)},disabled:!1,label:"sources-video-reselect-source"}}))}const ut=e=>{let{setActiveSource:t,userConstraints:r,displayConstraints:a,userHasWebcam:s}=e;const{t:l}=(0,_.$G)(),c=(0,d.rV)(),p=R(),g=D(),{displaySupported:v,userSupported:f}=g,Z={RECORD_DISPLAY:e=>{e&&y(e)},RECORD_CAMERA:e=>{e&&b(e)},RECORD_DISPLAY_CAMERA:e=>{e&&w(e)}},b=async()=>{t(x),await F(p,c,r),await(0,u.NN)(p)},y=async()=>{t(m),await W(p,c,a)},w=async()=>{t(h),await F(p,c,r),await Promise.all([(0,u.NN)(p),W(p,c,a)])};return v||f?(0,n.tZ)(i.Fragment,null,(0,n.tZ)(Q.GlobalHotKeys,{keyMap:le,handlers:Z},(0,n.tZ)(gt,null),(0,n.tZ)(o.kC,{sx:{flexDirection:["column","row"],maxWidth:[270,850],width:"100%",mx:["auto","none"],mb:3,flex:"4 1 auto",maxHeight:["none","270px"],justifyContent:"center","& > :not(:last-of-type)":{mb:[3,0],mr:[0,3]}}},(v||!(0,u.WK)())&&(0,n.tZ)(pt,{label:l("sources-scenario-display"),icon:O.$rF,onClick:y,disabledText:!v&&l("sources-video-display-not-supported")}),(v||!(0,u.WK)())&&f&&(0,n.tZ)(pt,{label:l("sources-scenario-display-and-user"),icon:O.hG5,onClick:w,disabledText:v?!s&&l("sources-video-no-cam-detected"):l("sources-video-display-not-supported")}),f&&(0,n.tZ)(pt,{label:l("sources-scenario-user"),icon:O.ILF,onClick:b,disabledText:!s&&l("sources-video-no-cam-detected")})),(0,n.tZ)(gt,null))):(0,n.tZ)(xe,{isDanger:!0},l("sources-video-none-available"))},pt=e=>{let{icon:t,label:r,onClick:o,disabledText:i=!1}=e;const a=!1!==i;return(0,n.tZ)("button",{onClick:o,disabled:a,sx:{fontFamily:"inherit",color:a?"gray.2":"gray.0",border:e=>`2px solid ${a?e.colors.gray[2]:"black"}`,backgroundColor:"gray.4",borderRadius:"8px",flex:["1 1 auto","0 1 100%"],minWidth:"180px",maxWidth:"300px",minHeight:"120px",maxHeight:"250px",p:2,"&:hover":a?{}:{boxShadow:e=>`0 0 10px ${e.colors.gray[2]}`,filter:"brightness(1.2)"}}},(0,n.tZ)("div",{sx:{display:"block",textAlign:"center",mb:3}},(0,n.tZ)(T.G,{icon:t,size:"3x"})),(0,n.tZ)("div",{sx:{fontSize:4}},r),(0,n.tZ)("div",{sx:{fontSize:2,mt:1}},i))},gt=e=>(0,n.tZ)("div",Object.assign({sx:{flex:"1 0 0"}},e));function ht(e){let{recordingState:t}=e;const{t:r}=(0,_.$G)(),{displayStream:o,userStream:i,displayUnexpectedEnd:a,userUnexpectedEnd:s}=D(),l=t===Nt;let c=[];return(o||a)&&c.push({body:(0,n.tZ)(mt,{title:r("share-desktop"),stream:o,paused:l}),dimensions:()=>(0,u.Ld)(o)}),(i||s)&&c.push({body:(0,n.tZ)(mt,{title:r("share-camera"),stream:i,paused:l}),dimensions:()=>(0,u.Ld)(i)}),(0,n.tZ)(me,{gap:20},c)}function mt(e){let{title:t,stream:r,paused:o}=e;const a=he(),s=(0,i.useRef)();return(0,i.useEffect)((()=>{const e=s.current;if(e&&r)return e.srcObject||(e.srcObject=r),e.addEventListener("resize",a),o?e.pause():e.play(),()=>e.removeEventListener("resize",a)})),r?(0,n.tZ)("div",{sx:{position:"relative",backgroundColor:"gray.3",boxShadow:"0 2px 2px rgba(0, 0, 0, 0.35)",overflow:"hidden",height:"100%",cursor:r?"initial":"pointer"}},o&&(0,n.tZ)("div",{sx:{position:"absolute",width:"100%",height:"100%",backgroundColor:"rgba(255, 255, 255, 0.5)"}},(0,n.tZ)(T.G,{icon:O.XQY,sx:{color:"#000",fontSize:"140px",maxWidth:"40%",maxHeight:"40%",position:"absolute",top:0,left:0,bottom:0,right:0,margin:"auto",animation:"3s ease-in-out infinite none pulse"}})),(0,n.tZ)("video",{ref:s,autoPlay:!0,muted:!0,tabIndex:"-1",sx:{outline:"none",width:"100%",height:"100%",background:"transparent"}})):(0,n.tZ)("div",{sx:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}},(0,n.tZ)(T.G,{icon:O.eHv,size:"3x"}))}var xt=r(6274),vt=r(9359),ft=(0,vt.Z)("recorder"),Zt=(0,vt.Z)("data"),bt=(0,vt.Z)("dimensions"),yt=(0,vt.Z)("reset"),wt=(0,vt.Z)("onDataAvailable"),St=(0,vt.Z)("onStop");class kt{constructor(e,t){let r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.defineProperty(this,ft,{writable:!0,value:void 0}),Object.defineProperty(this,Zt,{writable:!0,value:void 0}),Object.defineProperty(this,bt,{writable:!0,value:void 0}),Object.defineProperty(this,yt,{writable:!0,value:()=>{(0,xt.Z)(this,Zt)[Zt]=[]}}),Object.defineProperty(this,wt,{writable:!0,value:e=>{e.data.size>0?(0,xt.Z)(this,Zt)[Zt].push(e.data):console.log("Recording data has size 0!",e)}}),Object.defineProperty(this,St,{writable:!0,value:e=>{var t,r;const n=(null===(t=(0,xt.Z)(this,Zt)[Zt][0])||void 0===t?void 0:t.type)||(0,xt.Z)(this,ft)[ft].mimeType,o=new Blob((0,xt.Z)(this,Zt)[Zt],{type:n}),i=URL.createObjectURL(o);(0,xt.Z)(this,yt)[yt](),null===(r=this.onStop)||void 0===r||r.call(this,{url:i,media:o,mimeType:n,dimensions:(0,xt.Z)(this,bt)[bt]})}}),"isTypeSupported"in MediaRecorder?(r=((null===t||void 0===t?void 0:t.mimes)||[]).find((e=>MediaRecorder.isTypeSupported(e))),r?console.debug("using first supported MIME type from settings: ",r):null!==t&&void 0!==t&&t.mimes&&console.debug("None of the MIME types specified in settings are supported by this `MediaRecorder`")):null!==t&&void 0!==t&&t.mimes&&console.debug("MIME types were specified, but `MediaRecorder.isTypeSupported` is not supported by your browser"),(0,xt.Z)(this,yt)[yt](),(0,xt.Z)(this,bt)[bt]=(0,u.Ld)(e);const o=null===t||void 0===t?void 0:t.videoBitrate;this.onStop=n.onStop,(0,xt.Z)(this,ft)[ft]=new MediaRecorder(e,{mimeType:r,videoBitsPerSecond:o}),(0,xt.Z)(this,ft)[ft].ondataavailable=(0,xt.Z)(this,wt)[wt],(0,xt.Z)(this,ft)[ft].onstop=(0,xt.Z)(this,St)[St]}start(){(0,xt.Z)(this,ft)[ft].start()}pause(){(0,xt.Z)(this,ft)[ft].pause()}resume(){(0,xt.Z)(this,ft)[ft].resume()}stop(){(0,xt.Z)(this,ft)[ft].stop()}}const Et=e=>{let{large:t,...r}=e;return(0,n.tZ)("button",Object.assign({sx:{display:"grid",backgroundColor:"transparent",border:"none",position:"relative",overflow:"hidden",my:0,mx:t?"15px":0,padding:0,fontSize:t?"5rem":"3.5rem",lineHeight:t?"5rem":"3.5rem",svg:{margin:0,padding:0,outline:"none"}}},r))},Ct=e=>(0,n.tZ)(Et,{onClick:e.onClick,title:e.title,sx:{"&:focus-visible":{outline:e=>`7px solid ${e.colors.focus[3]} !important`,outlineOffset:"-1px",borderRadius:"50%"}}},(0,n.tZ)("span",{className:"fa-layers"},(0,n.tZ)(T.G,{icon:O.ul5,sx:{color:"button_bg"}}))),Rt=e=>(0,n.tZ)(Et,{onClick:e.onClick,title:e.title,large:e.large?1:0,disabled:e.disabled||e.countdown,sx:{color:"#bd181c !important","svg + svg":{color:"#e22319"},":disabled":{color:"#aaa"},":disabled svg + svg":{color:"#bbb"},"&:focus-visible":{outline:e=>`7px solid ${e.colors.focus[0]} !important`,outlineOffset:"-1px",borderRadius:"50%"}}},(0,n.tZ)("span",{className:"fa-layers record-buttons"},(0,n.tZ)(T.G,{icon:e.countdown?O.IJ7:O.diR,spin:e.countdown}),(0,n.tZ)(T.G,{icon:O.diR,transform:"shrink-6"}))),Dt=e=>(0,n.tZ)(Et,{onClick:e.onClick,title:e.title,sx:{"&:focus-visible":{outline:e=>`7px solid ${e.colors.focus[3]} !important`,outlineOffset:"-1px",borderRadius:"50%"}}},(0,n.tZ)("span",{className:"fa-layers"},(0,n.tZ)(T.G,{icon:O.aQp,sx:{color:"button_bg"}}))),At=e=>(0,n.tZ)(Et,{onClick:e.onClick,title:e.title,large:!!e.large,sx:{color:"#bd181c","&:focus-visible":{outline:e=>`7px solid ${e.colors.focus[0]} !important`,outlineOffset:"-1px",borderRadius:"50%"}}},(0,n.tZ)(T.G,{icon:O.oD0,sx:{color:"#bd181c !important"}}));var Tt=(0,vt.Z)("last"),Ot=(0,vt.Z)("timerID"),It=(0,vt.Z)("isMounted");class Gt extends i.Component{constructor(e){super(e),Object.defineProperty(this,Tt,{writable:!0,value:null}),Object.defineProperty(this,Ot,{writable:!0,value:null}),Object.defineProperty(this,It,{writable:!0,value:!1}),this.state={milliseconds:0},(0,xt.Z)(this,Tt)[Tt]=new Date,(0,xt.Z)(this,Ot)[Ot]=setInterval((()=>this.tick()),100)}componentDidMount(){(0,xt.Z)(this,It)[It]=!0}componentWillUnmount(){this.stopTimer(),(0,xt.Z)(this,It)[It]=!1}resumeTimer(){this.timerId||((0,xt.Z)(this,Ot)[Ot]=setInterval((()=>this.tick()),100),(0,xt.Z)(this,Tt)[Tt]=new Date)}stopTimer(){clearInterval((0,xt.Z)(this,Ot)[Ot]),(0,xt.Z)(this,Ot)[Ot]=null}componentDidUpdate(e){this.props.isPaused!==e.isPaused&&(this.props.isPaused?this.stopTimer():this.resumeTimer())}tick(){if((0,xt.Z)(this,It)[It]){const e=new Date,t=e-(0,xt.Z)(this,Tt)[Tt];(0,xt.Z)(this,Tt)[Tt]=e,this.setState((e=>({milliseconds:e.milliseconds+t})))}}render(){const e=this.state.milliseconds;let t=[e/36e5>>0,(e/6e4>>0)%60,(e/1e3>>0)%60];0===t[0]&&(t=t.slice(1));const r=t.map((e=>(e<10?"0":"")+e)).join(":");return(0,n.tZ)("span",{sx:{fontSize:3}},r)}}const Ut=Gt;function _t(e,t){return r=>{let{media:n,url:o,mimeType:i,dimensions:a}=r;e({type:"ADD_RECORDING",payload:{deviceType:t,media:n,url:o,mimeType:i,dimensions:a}})}}function Pt(e,t){return null!==e&&void 0!==e&&e.getAudioTracks().length?new MediaStream([...t.getVideoTracks(),...e.getAudioTracks()]):t}let Ht=[];function Lt(e){let{handleRecorded:t,recordingState:r,setRecordingState:o}=e;const{t:a}=(0,_.$G)(),c=R(),u=(0,d.rV)(),{audioStream:p,displayStream:g,userStream:h,userUnexpectedEnd:m,displayUnexpectedEnd:x,audioUnexpectedEnd:v}=D(),f=(0,i.useRef)(null),Z=(0,i.useRef)(null),b=(g||h)&&!m&&!x&&!v,y=(0,s.k6)(),w=function(){var e,r;let n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null===(e=f.current)||void 0===e||e.stop(),null===(r=Z.current)||void 0===r||r.stop(),t(),c({type:n?"STOP_RECORDING_PREMATURELY":"STOP_RECORDING"}),Ht.forEach((e=>e())),Ht=[]};(0,i.useEffect)((()=>{!(m||x||v)||r!==zt&&r!==Nt||w(!0),y.listen((()=>{"STATE_INACTIVE"!==r&&c({type:"STOP_RECORDING"}),Ht.forEach((e=>e())),Ht=[]}))}));const S=()=>{o(Nt),(()=>{var e,t;null===(e=f.current)||void 0===e||e.pause(),null===(t=Z.current)||void 0===t||t.pause()})()},k=()=>{o(zt),(()=>{var e,t;null===(e=f.current)||void 0===e||e.resume(),null===(t=Z.current)||void 0===t||t.resume()})()},E=()=>{b&&(o(zt),(()=>{if(c({type:"CLEAR_RECORDINGS"}),g){const e=_t(c,"desktop"),t=Pt(p,g);f.current=new kt(t,u.recording,{onStop:e}),f.current.start()}if(h){const e=_t(c,"video"),t=Pt(p,h);Z.current=new kt(t,u.recording,{onStop:e}),Z.current.start()}c({type:"START_RECORDING"}),Ht.push(y.block(a("confirm-cancel-recording")))})())},C=()=>{o($t),w()},A={START_RECORDING:e=>{e&&E()},STOP_RECORDING:e=>{e&&C()},PAUSE_RECORDING:e=>{e&&(r===zt?S():r===Nt&&k())}};return(0,n.tZ)(Q.GlobalHotKeys,{keyMap:le,handlers:A},(0,n.tZ)("div",{sx:{m:0,width:r!==$t?"280px":"auto"}},r!==$t&&(0,n.tZ)(l.S,{onBeforeunload:e=>e.preventDefault()}),(0,n.tZ)("div",{className:"buttons",sx:{display:"flex",alignItems:"center"}},r!==$t&&(0,n.tZ)("div",{sx:{flex:1,textAlign:"right"}},r===zt&&(0,n.tZ)(Me,{content:a("pause-button-title"),offset:[0,50]},(0,n.tZ)(Ct,{recordingState:r,onClick:S})),r===Nt&&(0,n.tZ)(Me,{content:a("resume-button-title"),offset:[0,50]},(0,n.tZ)(Dt,{recordingState:r,onClick:k}))),(0,n.tZ)("div",{className:"center"},r===$t?(0,n.tZ)(Me,{content:a("record-button-title"),offset:[0,50]},(0,n.tZ)(Rt,{large:!0,recordingState:r,onClick:E,disabled:!b})):(0,n.tZ)(Me,{content:a("stop-button-title"),offset:[0,50]},(0,n.tZ)(At,{large:!0,recordingState:r,onClick:C}))),r!==$t&&(0,n.tZ)("div",{sx:{flex:1}},(0,n.tZ)(Ut,{isPaused:r===Nt})))))}const $t="inactive",Nt="paused",zt="recording";function Mt(e){const{t:t}=(0,_.$G)(),r=D(),a=R(),s=(0,Re.mx)(),[l,c]=(0,i.useState)($t),d=(0,i.useCallback)((()=>{e.previousStep()}),[e]);return(0,n.tZ)(o.kC,{sx:{flexDirection:"column",height:"100%",position:"relative",flexGrow:1}},(r.displayUnexpectedEnd||r.userUnexpectedEnd)&&(0,n.tZ)(xe,{isDanger:!0},(0,n.tZ)(o.xv,null,t("error-lost-video-stream"))),r.audioUnexpectedEnd&&(0,n.tZ)(xe,{isDanger:!0},(0,n.tZ)(o.xv,null,t("error-lost-audio-stream"))),(0,n.tZ)(ht,{recordingState:l}),(0,n.tZ)("div",{sx:{m:3}},(0,n.tZ)(pe,{prev:l===$t&&{onClick:d}},(0,n.tZ)(Lt,{handleRecorded:()=>{s.refreshConnection(),function(e,t){let{audioStream:r,displayStream:n,userStream:o}=e;j(r,t),q(n,t),K(o,t)}(r,a),e.nextStep()},recordingState:l,setRecordingState:c}))))}var Wt;function Ft(){return Ft=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ft.apply(this,arguments)}function jt(e,t){let{title:r,titleId:n,...o}=e;return i.createElement("svg",Ft({"aria-hidden":"true",focusable:"false",role:"img",viewBox:"0 0 100 65",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":n},o),r?i.createElement("title",{id:n},r):null,Wt||(Wt=i.createElement("path",{d:"m24.6 0c-0.447 0-0.894 0.171-1.24 0.511l-3.07 3.05c-0.685 0.681-0.685 1.78 0 2.46l58.8 58.5c0.685 0.681 1.79 0.681 2.47 0l3.07-3.05c0.685-0.681 0.685-1.78 0-2.46l-6.68-6.64h22v-7.32h-15.6c-1.44 0-2.6-1.15-2.6-2.59v-14.3c0-1.43 1.16-2.59 2.6-2.59h15.6v-7.32h-56.4l-17.8-17.7c-0.343-0.341-0.79-0.511-1.24-0.511zm-24.6 18.2v7.32h3.7c1.44 0 2.6 1.15 2.6 2.59v14.3c0 1.43-1.16 2.59-2.6 2.59h-3.7v7.32h55.8l-15.4-15.3v5.36c0 1.43-1.16 2.59-2.6 2.59h-21.8c-1.44 0-2.6-1.15-2.6-2.59v-14.3c0-1.43 1.16-2.59 2.6-2.59h12.8l-7.36-7.32zm51 7.32h21c1.44 0 2.6 1.15 2.6 2.59v14.3c0 1.43-1.16 2.59-2.6 2.59h-1.4z",fill:"currentColor"})))}const qt=i.forwardRef(jt);r.p;var Kt;function Bt(){return Bt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Bt.apply(this,arguments)}function Vt(e,t){let{title:r,titleId:n,...o}=e;return i.createElement("svg",Bt({"aria-hidden":"true",focusable:"false",role:"img",viewBox:"0 0 100 90",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":n},o),r?i.createElement("title",{id:n},r):null,Kt||(Kt=i.createElement("g",{fill:"currentColor"},i.createElement("path",{d:"m49.7 0.00188c-2.91 0.0589-5.75 1.49-7.44 4.08-1.06 1.62-1.51 3.48-1.42 5.29-0.0794 0.122-0.986 1.51-1.13 1.72-0.13-0.2-0.997-1.54-1.08-1.66 0.0951-1.81-0.348-3.67-1.4-5.29-1.68-2.59-4.51-4.04-7.42-4.11-1.75-0.0426-3.52 0.41-5.09 1.41-4.18 2.66-5.4 8.27-2.72 12.4 2.56 3.96 7.83 5.24 11.9 3.02l0.992 1.53c-2.84 4.35-4.9 7.5-6.74 10.3-3.09 4.73-1.94 8.93 2.01 11.5l9.47-14.5 9.45 14.6c3.96-2.55 5.13-6.75 2.06-11.5-1.84-2.84-3.9-6.03-6.74-10.4l1.04-1.59c4.1 2.23 9.37 0.974 12-2.97 2.03-3.1 1.85-7.03-0.114-9.93-0.656-0.968-1.51-1.82-2.55-2.49-1.56-1.01-3.33-1.47-5.08-1.43zm0.0903 5.96c0.578-0.0076 1.17 0.154 1.7 0.499 0.357 0.23 0.649 0.514 0.872 0.835 0.668 0.962 0.712 2.24 0.0174 3.31-0.926 1.42-2.74 1.8-4.17 0.882-1.43-0.919-1.82-2.73-0.889-4.14 0.579-0.886 1.51-1.37 2.47-1.38zm-20.1 0.0236c0.963 0.0168 1.89 0.504 2.46 1.39 0.92 1.42 0.525 3.22-0.906 4.14s-3.25 0.521-4.17-0.9c-0.92-1.42-0.525-3.22 0.906-4.14 0.537-0.343 1.13-0.502 1.71-0.492zm10 24.1a1.83 1.81 0 0 0-1.83 1.81v3.62a1.83 1.81 0 0 0 1.83 1.81 1.83 1.81 0 0 0 1.83-1.81v-3.62a1.83 1.81 0 0 0-1.83-1.81zm0 10.9a1.83 1.81 0 0 0-1.83 1.81v3.62a1.83 1.81 0 0 0 1.83 1.81 1.83 1.81 0 0 0 1.83-1.81v-3.62a1.83 1.81 0 0 0-1.83-1.81zm-1.5 8.8a2.43 2.42 0 0 0-2.43 2.42v35.4a2.43 2.42 0 0 0 2.43 2.42h8.94v-4.83h-6.51v-30.6h6.1v-4.83zm6.51 8.86v22.5h55.2v-4.83h-3.22c-0.954 0-1.72-0.761-1.72-1.71v-9.47c0-0.946 0.767-1.71 1.72-1.71h3.22v-4.83zm6.59 4.83h14.4c0.954 0 1.72 0.762 1.72 1.71v9.47c0 0.946-0.767 1.71-1.72 1.71h-14.4c-0.954 0-1.72-0.761-1.72-1.71v-9.47c0-0.946 0.767-1.71 1.72-1.71zm22.7 0h14.4c0.954 0 1.72 0.762 1.72 1.71v9.47c0 0.946-0.767 1.71-1.72 1.71h-14.4c-0.954 0-1.72-0.761-1.72-1.71v-9.47c0-0.946 0.769-1.71 1.72-1.71z"}),i.createElement("path",{d:"m0 58.6v4.83h2.44c0.954 0 1.72 0.762 1.72 1.71v9.47c0 0.946-0.768 1.71-1.72 1.71h-2.44v4.83h31.8v-22.5zm10.8 4.83h14.4c0.954 0 1.72 0.762 1.72 1.71v9.47c0 0.946-0.768 1.71-1.72 1.71h-14.4c-0.954 0-1.72-0.762-1.72-1.71v-9.47c0-0.946 0.768-1.71 1.72-1.71z",opacity:.2}))))}const Yt=i.forwardRef(Vt);r.p;function Xt(e){const{t:t}=(0,_.$G)(),r=R(),{recordings:a,prematureRecordingEnd:s,videoChoice:l}=D(),c=a.some((e=>0===e.media.size)),d=(0,i.useRef)(),[u,p]=(0,i.useState)(0),[g,h]=(0,i.useState)(),m=(()=>{switch(l){case"none":return 0;case"both":return 2;default:return 1}})();return(0,n.tZ)(ue,null,(0,n.tZ)(A.Ge.h1,null,t("review-heading")),s&&(0,n.tZ)(xe,{isDanger:!0},(0,n.tZ)(o.xv,null,t("error-lost-stream-end-recording"))),c&&(0,n.tZ)(xe,{isDanger:!0},t("review-error-empty-recording")),(!g||a.length!==m)&&(0,n.tZ)("div",{sx:{flex:1,display:"flex",alignItems:"center",justifyContent:"center"}},(0,n.tZ)(o.$j,{title:t("save-creation-waiting-for-recordings")})),a.length===m&&(0,n.tZ)("div",{sx:g?{display:"flex",flex:"1 1 auto",flexDirection:"column"}:{display:"none"}},(0,n.tZ)(rr,{ref:d,onTimeUpdate:e=>{p(e.target.currentTime)},onReady:()=>h(!0)}),(0,n.tZ)("div",{sx:{mb:3}}),(0,n.tZ)(Qt,{previewController:d,currentTime:u})),(0,n.tZ)("div",{sx:{mb:3}}),(0,n.tZ)(pe,{prev:{onClick:()=>{window.confirm(t("confirm-discard-recordings"))&&(r({type:"RESET"}),e.firstStep())},danger:!0,label:"review-button-discard-and-record"},next:{onClick:()=>{e.nextStep()}}}))}const Qt=e=>{let{previewController:t,currentTime:r}=e;return(0,n.tZ)("div",{sx:{backgroundColor:"gray.4",color:"text",borderRadius:"8px"}},(0,n.tZ)(er,{previewController:t,currentTime:r}),(0,n.tZ)(Jt,{previewController:t,currentTime:r}))},Jt=e=>{var t;let{previewController:r,currentTime:o}=e;const i=(null===(t=r.current)||void 0===t?void 0:t.duration)||1/0,{start:a,end:s}=D(),[l]=(0,U.If)(),c=e=>{const t=e.target.getBoundingClientRect();let n=(e.clientX-t.x)/t.width;n<0?n=0:n>1&&(n=1),r.current&&(r.current.currentTime=n*i)},d={position:"absolute",backgroundColor:"dark"===l?"gray.2":"gray.3",height:"100%",boxSizing:"content-box"};return(0,n.tZ)("div",{sx:{p:2}},(0,n.tZ)("div",{sx:{py:1,position:"relative"}},(0,n.tZ)("div",{onClick:e=>c(e),onMouseMove:e=>{1===e.buttons&&c(e)},sx:{position:"absolute",width:"100%",height:"100%",cursor:"pointer",top:0,zIndex:10}}),(0,n.tZ)("div",{sx:{position:"relative",backgroundColor:"#6bc295",height:"12px",width:"100%",borderRadius:"6px",overflow:"hidden","@media not (any-pointer: fine)":{height:"20px",borderRadius:"10px"}}},null!=a&&a>0&&(0,n.tZ)("div",{sx:{left:0,borderRight:"2px solid black",width:a/i*100+"%",...d}}),null!=s&&s<i&&(0,n.tZ)("div",{sx:{right:0,borderLeft:"2px solid black",width:(i-s)/i*100+"%",...d}}),(0,n.tZ)("div",{sx:{position:"absolute",left:0,width:o/i*100+"%",backgroundColor:"black",height:"100%",opacity:.3}}))))},er=e=>{var t,r,a,s,l;let{currentTime:c,previewController:u}=e;const{start:p,end:g}=D(),h=R(),m=(0,d.rV)(),{t:x}=(0,_.$G)(),v=null===(t=u.current)||void 0===t?void 0:t.duration,f=(0,i.useRef)(null),Z=(0,i.useRef)(null),b={PLAY_PAUSE:e=>{e&&(e=>{const t=u.current;t.isPlaying?t.pause(e):t.isReadyToPlay&&t.play(e)})(e)},DELETE_CROP_MARK_LEFT:e=>{var t;e&&(null===(t=f.current)||void 0===t||t.click())},DELETE_CROP_MARK_RIGHT:e=>{var t;e&&(null===(t=Z.current)||void 0===t||t.click())}};return(0,n.tZ)("div",{sx:{textAlign:"center"}},(0,n.tZ)(Q.GlobalHotKeys,{keyMap:ce,handlers:b},(0,n.tZ)(o.kC,{sx:{backgroundColor:"gray.4",p:2,justifyContent:"center",alignItems:"flex-end","& > *":{mx:2}}},(null===(r=m.review)||void 0===r?void 0:r.disableCutting)||(0,n.tZ)(tr,{marker:"start",innerRef:f,value:p,control:g,invariant:(e,t)=>e<t,recordingDispatch:h,previewController:u,currentTime:c}),(0,n.tZ)(Me,{content:null!==(a=u.current)&&void 0!==a&&a.isPlaying?x("review-pause"):x("review-play")},(0,n.tZ)("button",{sx:{backgroundColor:"transparent",border:"none",mx:3,color:"gray.0"},onClick:()=>{const e=u.current;e&&(e.isPlaying?e.pause():e.isReadyToPlay&&e.play())}},(0,n.tZ)(T.G,{icon:null!==(s=u.current)&&void 0!==s&&s.isPlaying?O.XQY:O.zc,sx:{fontSize:"50px",opacity:.8,"&:hover":{opacity:1}}}))),(null===(l=m.review)||void 0===l?void 0:l.disableCutting)||(0,n.tZ)(tr,{marker:"end",innerRef:Z,value:g,control:p,invariant:(e,t)=>t<e,recordingDispatch:h,previewController:u,currentTime:c})),x("review-player-progress",{currentTime:c,duration:v})))},tr=e=>{let{marker:t,value:r,control:a,invariant:s,currentTime:l,previewController:c,recordingDispatch:d,innerRef:u}=e;const{t:p}=(0,_.$G)(),g={CUT_LEFT:e=>{e&&document.getElementById("leftmarker").click()},CUT_RIGHT:e=>{e&&document.getElementById("rightmarker").click()}},h=(0,n.tZ)(Q.GlobalHotKeys,{keyMap:ce,handlers:g},(0,n.tZ)("div",{sx:{flex:1,textAlign:"start"===t?"right":"left",color:"gray.0"}},null!==r&&(0,n.tZ)(i.Fragment,null,(0,n.tZ)(_.cC,{t:p,i18nKey:`review-${t}`},{[t]:r}," ",(0,n.tZ)(o.rU,{href:"",onClick:e=>{e.preventDefault(),c.current.currentTime=r}})),(0,n.tZ)(Me,{content:p("review-remove-cut-point")},(0,n.tZ)(o.hU,{context:t,ref:u,onClick:()=>d({type:`UPDATE_${t.toUpperCase()}`,payload:null})},(0,n.tZ)(T.G,{icon:O.$aW})))))),m=(()=>{var e;return l<=.001||l>=(null===(e=c.current)||void 0===e?void 0:e.duration)||null!=a&&!s(l,a)})(),x=(0,n.tZ)(Q.GlobalHotKeys,{keyMap:ce,handlers:g},(0,n.tZ)(Me,{content:p(`review-set-${t}`)},(0,n.tZ)("button",{id:"start"===t?"leftmarker":"rightmarker",disabled:m,onClick:()=>{let e=c.current.currentTime;null==a||s(e,a)||(e=a),d({type:`UPDATE_${t.toUpperCase()}`,payload:e})},sx:{backgroundColor:"transparent",color:"text",border:"none",pt:"4px",px:"8px",borderRadius:"4px","&:disabled":{opacity:.3},"&:not(:disabled):hover":{backgroundColor:"gray.3"}}},(0,n.tZ)(Yt,{sx:{height:"32px",transform:"end"===t?"scaleX(-1)":""}}))));return"start"===t?(0,n.tZ)(i.Fragment,null,h,x):(0,n.tZ)(i.Fragment,null,x,h)},rr=(0,i.forwardRef)((function(e,t){var r;let{onTimeUpdate:o,onReady:a}=e;const{recordings:s,start:l,end:c}=D(),{t:d}=(0,_.$G)(),u=[(0,i.useRef)(),(0,i.useRef)()],p=u.slice(0,s.length),g=2===s.length?"desktop"===s[0].deviceType?0:1:null,h=(0,i.useRef)();(0,i.useImperativeHandle)(t,(()=>({get currentTime(){return u[h.current||0].current.currentTime},set currentTime(e){p.forEach((t=>t.current.currentTime=e))},get duration(){var e;return null===(e=u[h.current||0].current)||void 0===e?void 0:e.duration},get isPlaying(){const e=u[h.current||0].current;return e&&e.currentTime>0&&!e.paused&&!e.ended},get isReadyToPlay(){return p.every((e=>e.current.readyState>=2))},play(){p.forEach((e=>e.current.play()))},pause(){p.forEach((e=>e.current.pause()))}})));const m=[(0,i.useRef)(),(0,i.useRef)()],[x,v]=(0,i.useState)(),f=e=>null!==l&&e<l||null!==c&&e>c,Z=(null===(r=u[h.current||0].current)||void 0===r?void 0:r.currentTime)||0,b=f(Z),[,y]=(0,i.useState)(b);(0,i.useEffect)((()=>{x&&a()}),[a,x]),(0,i.useEffect)((()=>{if(x&&2===s.length){u[g].current.volume=0;const e=u[0].current,t=u[1].current;let r,n=0;const o=()=>{if(n%60===0){if(Math.abs(e.currentTime-t.currentTime)>.15&&null!=h.current){const e=u[h.current].current;u[0===h.current?1:0].current.currentTime=e.currentTime}}n++,r=window.requestAnimationFrame(o)};return r=window.requestAnimationFrame(o),()=>window.cancelAnimationFrame(r)}}));const w={FORWARD_5_SEC:e=>{e&&S(e)},BACKWARDS_5_SEC:e=>{e&&S(e)},FORWARD_1_FRAME:e=>{e&&k(e)},BACKWARDS_1_FRAME:e=>{e&&k(e)}},S=e=>{u.forEach((t=>{void 0!==t.current&&("l"===e.key||"ArrowRight"===e.key?t.current.currentTime=Math.min(t.current.duration,t.current.currentTime+5):"j"!==e.key&&"ArrowLeft"!==e.key||(t.current.currentTime=Math.max(0,t.current.currentTime-5)))}))},k=e=>{u.forEach((t=>{void 0!==t.current&&("."===e.key?t.current.currentTime=Math.min(t.current.duration,t.current.currentTime+1/30):","===e.key&&(t.current.currentTime=Math.max(0,t.current.currentTime-1/30)))}))},E=s.map(((e,t)=>({body:(0,n.tZ)(Q.GlobalHotKeys,{keyMap:ce,handlers:w},(0,n.tZ)("div",{sx:{position:"relative",width:"100%",height:"100%"}},b&&(0,n.tZ)("div",{sx:{position:"absolute",left:0,right:0,top:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.65)",color:"white",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",pointerEvents:"none"}},(0,n.tZ)(qt,{sx:{height:"4em"}}),(0,n.tZ)("p",{sx:{my:3}},d("review-part-will-be-removed"))),(0,n.tZ)("video",{ref:u[t],key:t,src:e.url,onLoadedData:e=>{e.target.currentTime=Number.MAX_VALUE,m[t].current="started"},onTimeUpdate:x?e=>{const t=e.target.currentTime;y(f(t)),o(e)}:e=>{if(!x)switch(m[t].current){case"started":e.target.currentTime=.001,m[t].current="done";break;case"done":m.filter((e=>"done"===e.current)).length===s.length&&v(!0)}},preload:"auto",tabIndex:"-1",sx:{width:"100%",height:"100%",backgroundColor:"#ccc",outline:"none"}}))),dimensions:()=>e.dimensions})));return(0,n.tZ)(me,{gap:20},E)}));function nr(e){let{activeStep:t,updateActiveStep:r,userHasWebcam:o}=e;return(0,u.UC)()?(0,n.tZ)(N,{activeStep:t,updateActiveStep:r},(0,n.tZ)(dt,{userHasWebcam:o}),(0,n.tZ)(ye,null),(0,n.tZ)(Mt,null),(0,n.tZ)(Xt,null),(0,n.tZ)(Ie,null)):null}const or=[{short:"en",long:"English",rtl:!1},{short:"de",long:"Deutsch",rtl:!1},{short:"nl",long:"Dutch",rtl:!1},{short:"el",long:"\u0395\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ac",rtl:!1},{short:"es",long:"Espa\xf1ol",rtl:!1},{short:"fa",long:"Farsi",rtl:!0},{short:"fr",long:"Fran\xe7ais",rtl:!1},{short:"sl",long:"Sloven\u0161\u010dina",rtl:!1},{short:"tr",long:"Turkish",rtl:!1},{short:"zh",long:"\u7b80\u4f53\u4e2d\u6587",rtl:!1}],ir=e=>{let{title:t,children:r}=e;return(0,n.tZ)(o.xu,{sx:{"&:not(:last-child)":{mb:5}}},(0,n.tZ)(A.Ge.h2,{sx:{borderBottom:e=>`1px solid ${e.colors.gray[2]}`,pb:1,my:3,mx:0}},t),r)},ar=()=>{const{i18n:e,t:t}=(0,_.$G)();var r=t("settings-language-label");return"Language"!==r&&(r+=" / Language"),(0,n.tZ)(ir,{title:t("settings-general-header")},(0,n.tZ)("label",{htmlFor:"studio-lang",sx:{variant:"styles.label"}},r),(0,n.tZ)("select",{id:"studio-lang",sx:{variant:"styles.select"},defaultValue:e.language,onChange:t=>e.changeLanguage(t.target.value)},or.map((e=>(0,n.tZ)("option",{value:e.short,key:e.short},e.long)))))};const sr=function(e){let{settingsManager:t}=e;const r=(0,s.TH)(),{t:l}=(0,_.$G)(),c=(0,Re.mx)(),[d,u]=(0,i.useState)(),{errors:p,handleSubmit:g,register:h}=(0,Ee.ZP)({defaultValues:t.formValues().opencast}),[m,x]=(0,i.useState)("initial"),{recordings:v}=D(),f=v.length>0;async function Z(e){x("testing");const r=await Re._r.init({...t.settings().opencast,...e});switch(r.getState()){case Re.zM:c.setGlobalInstance(r),t.saveSettings({opencast:e}),x("saved"),u(null);break;case Re.RY:x("error"),u(l("upload-settings-error-server-unreachable"));break;case Re.J$:x("error"),u(l("upload-settings-error-response-not-ok"));break;case Re.iL:x("error"),u(l("upload-settings-error-invalid-response"));break;case Re.F8:x("error"),c.isLoginProvided()?u(l("upload-settings-invalid-provided-login")):u(l("upload-settings-invalid-login-data"));break;case Re.HY:case Re.rV:default:console.error("bug: invalid state reached..."),x("error"),u("internal error :(")}}const b=t.isConfigurable("opencast.serverUrl"),y=t.isUsernameConfigurable(),w=t.isPasswordConfigurable();if(!b&&!y&&!w)return null;const S={testing:O.IJ7,error:O.RLE,saved:O.f8k}[m],k={NEXT_BUTTON:e=>{e&&g(Z(e))}};return(0,n.tZ)(Q.GlobalHotKeys,{keyMap:de,handlers:k},(0,n.tZ)(ir,{title:l("upload-settings-modal-header")},(0,n.tZ)(o.xu,null,d&&(0,n.tZ)(xe,{isDanger:!0},d),(0,n.tZ)("form",{onSubmit:g(Z)},b&&(0,n.tZ)(De,{errors:p,label:l("upload-settings-label-server-url"),name:"serverUrl",register:h,validate:e=>{try{const t=new URL(e);return"https:"===t.protocol||"http:"===t.protocol||l("upload-settings-invalid-url-http-start")}catch(t){let r=l("upload-settings-invalid-url");return e.startsWith("https://")||e.startsWith("http://")||(r+=" "+l("upload-settings-invalid-url-http-start")),r}},required:!0}),y&&(0,n.tZ)(De,{errors:p,label:l("upload-settings-label-username"),name:"loginName",register:h,required:!0}),w&&(0,n.tZ)(De,{errors:p,label:l("upload-settings-label-password"),name:"loginPassword",register:h,required:!0,type:"password"}),(0,n.tZ)("footer",{sx:{mt:4}},(0,n.tZ)(o.zx,{sx:{verticalAlign:"middle"}},l("upload-settings-button-store")),S&&(0,n.tZ)(T.G,{icon:S,sx:{ml:"10px",fontSize:"30px",verticalAlign:"middle"},spin:"testing"===m}),f&&"saved"===m&&(0,n.tZ)(a.rU,{to:{pathname:"/",search:r.search},sx:{ml:3,variant:"styles.a"}},l("settings-back-to-recording")))))))},lr=()=>{const{t:e}=(0,_.$G)(),[,t]=(0,U.If)(),r=()=>{window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):t("light")};(0,i.useEffect)((()=>{"systemTheme"===localStorage.getItem("theme")&&r()}));const o=[{value:"systemTheme",label:e("settings-theme-system")},{value:"lightTheme",label:e("settings-theme-light")},{value:"darkTheme",label:e("settings-theme-dark")}];return(0,n.tZ)(ir,{title:e("settings-theme-appearance")},(0,n.tZ)("select",{sx:{variant:"styles.select"},defaultValue:localStorage.getItem("theme"),onChange:e=>{return n=e.target.value,localStorage.removeItem("prefers-color-scheme"),void("systemTheme"===n?(r(),localStorage.setItem("theme","systemTheme")):"darkTheme"===n?(t("dark"),localStorage.setItem("theme","darkTheme")):(t("light"),localStorage.setItem("theme","lightTheme")));var n}},o.map(((e,t)=>(0,n.tZ)("option",{key:t,value:e.value},e.label)))))},cr=e=>{let{settingsManager:t}=e;const{t:r}=(0,_.$G)();return(0,n.tZ)(o.xu,{sx:{width:"100%",maxWidth:960,mx:"auto",p:3}},(0,n.tZ)("header",null,(0,n.tZ)(A.Ge.h1,{sx:{mb:"1.5em"}},r("settings-header"))),(0,n.tZ)(lr,null),(0,n.tZ)(ar,null),(0,n.tZ)(sr,{settingsManager:t}))},dr=()=>{const{t:e}=(0,_.$G)();let t=[];return"https:"!==window.location.protocol&&"localhost"!==window.location.hostname&&"127.0.0.1"!==window.location.hostname&&t.push((0,n.tZ)(xe,{key:"unsecure-connection",isDanger:!0},e("warning-https"))),(0,u.UC)()||t.push((0,n.tZ)(xe,{key:"media-recorder",isDanger:!0},e("warning-recorder-not-supported"),(0,u.H2)()&&" "+e("warning-recorder-safari-hint"))),t.length>0?(0,n.tZ)("div",{sx:{p:3}},t):null},ur=e=>{let{name:t,entries:r}=e;const{t:o}=(0,_.$G)();return(0,n.tZ)("div",{sx:{margin:"10px",display:"flex",flexDirection:"column","@media screen and (max-width: 350px)":{width:"300px"}}},(0,n.tZ)("h3",{sx:{borderBottom:e=>`1px solid ${e.colors.gray[1]}`,textAlign:"center"}},o(t)),r.map(((e,t)=>(0,n.tZ)(pr,{params:e,key:t}))))},pr=e=>{let{params:t}=e;const{t:r}=(0,_.$G)();return(0,n.tZ)("div",{sx:{display:"flex",flexDirection:"row",padding:"6px 0",alignItems:"center"}},(0,n.tZ)("div",{sx:{width:"40%",wordWrap:"break-word"}},r(t.name)),t.description.map(((e,t,o)=>(0,n.tZ)("div",{key:t,sx:{padding:"2px 0",display:"flex"}},e.toString().split("+").map(((e,t)=>(0,n.tZ)("div",{key:t,sx:{borderRadius:"5px",border:e=>`2px solid ${e.colors.singleKey_border}`,background:e=>e.colors.singleKey_bg,padding:"8px",margin:"0 3px",textAlign:"center",minWidth:"40px"}},r(e)))),(0,n.tZ)("div",{sx:{alignSelf:"center",lineHeight:"32px",margin:"0 5px"}},o.length-1!==t&&r("sequence-seperator"))))))},gr=()=>{const{t:e}=(0,_.$G)(),t=Object.fromEntries([le,ce,de].flatMap(Object.entries));let r={};if(t&&Object.keys(t).length>0)for(const n of Object.values(t)){var o;const t=null!==(o=n.group)&&void 0!==o?o:e("other-shortcuts");t in r||(r[t]=[]),r[t].push(n)}const i=Object.entries(r).filter((e=>{let[t,r]=e;return r.length>0})).map((e=>{let[t,r]=e;return(0,n.tZ)(ur,{name:t,key:t,entries:r})}));return(0,n.tZ)("div",{sx:{display:"flex",flexDirection:"column",alignItems:"center",alignSelf:"center",width:"100%"}},(0,n.tZ)("h2",{sx:{display:"block",position:"relative",textAlign:"center"}},e("nav-shortcuts")),(0,n.tZ)("div",{sx:{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center"}},i))};const hr=e=>{let{settingsManager:t,userHasWebcam:r}=e;const[o,a]=(0,i.useState)(0),l=(0,s.TH)();return(0,n.tZ)(i.Fragment,null,(0,n.tZ)(mr,null),(0,n.tZ)(s.rs,null,(0,n.tZ)(s.AW,{path:"/settings",exact:!0},(0,n.tZ)(cr,{settingsManager:t})),(0,n.tZ)(s.AW,{path:"/shortcuts",exact:!0},(0,n.tZ)(gr,null)),(0,n.tZ)(s.AW,{path:"/about",exact:!0},(0,n.tZ)(G,null)),(0,n.tZ)(s.AW,{path:"/",exact:!0},(0,n.tZ)(nr,{activeStep:o,updateActiveStep:a,userHasWebcam:r})),(0,n.tZ)(s.AW,{path:"/*"},(0,n.tZ)(s.l_,{to:{pathname:"/",search:l.search}}))))},mr=()=>{const{recordings:e,upload:t}=D(),r=e.every((e=>e.downloaded)),o=t.state===b,i=t.state===Z;return(0,n.tZ)(l.S,{onBeforeunload:t=>{((null===e||void 0===e?void 0:e.length)>0&&!o&&!r||i)&&t.preventDefault()}})},xr=function(e){var t;let{settingsManager:r,userHasWebcam:i}=e;const s=(0,d.rV)();return(0,n.tZ)(a.VK,{basename:"/"},(0,n.tZ)(c.xB,{styles:(null===(t=s.theme)||void 0===t?void 0:t.customCSS)||""}),(0,n.tZ)(C,null,(0,n.tZ)(o.kC,{sx:{flexDirection:"column",height:"100%"}},(0,n.tZ)(P,null),(0,n.tZ)("main",{sx:{flex:1,display:"flex",flexDirection:"column",minHeight:"285px"}},(0,n.tZ)(dr,null),(0,n.tZ)(hr,{settingsManager:r,userHasWebcam:i})))))}}}]);
//# sourceMappingURL=122.7f8bc62f.chunk.js.map