"use strict";(self.webpackChunkopencast_react_studio=self.webpackChunkopencast_react_studio||[]).push([[823],{7448:(e,t,r)=>{r.r(t),r.d(t,{default:()=>ur});var n=r(9523),o=r(1038),i=r(2791),a=r(1523),l=r(4880),s=r(7725),d=r(9840),c=r(7275),u=r(7917);const p="none",g="both",h="display",m="user",v="none",x="not_uploaded",f="uploading",Z="uploaded",b="error",y=()=>({mediaDevices:[],audioAllowed:null,audioStream:null,audioUnexpectedEnd:!1,audioSupported:(0,u.S7)(),displayAllowed:null,displayStream:null,displayUnexpectedEnd:!1,displaySupported:(0,u.bV)(),userAllowed:null,userStream:null,userUnexpectedEnd:!1,userSupported:(0,u.S7)(),videoChoice:v,audioChoice:p,isRecording:!1,prematureRecordingEnd:!1,recordings:[],title:"",presenter:"",start:null,end:null,upload:{error:null,state:x,secondsLeft:null,currentProgress:0}}),w=(e,t)=>{switch(t.type){case"UPDATE_MEDIA_DEVICES":return{...e,mediaDevices:t.devices};case"CHOOSE_AUDIO":return{...e,audioChoice:t.choice};case"CHOOSE_VIDEO":return{...e,videoChoice:t.choice};case"SHARE_AUDIO":return{...e,audioStream:t.stream,audioAllowed:!0,audioUnexpectedEnd:!1};case"BLOCK_AUDIO":return{...e,audioStream:null,audioAllowed:!1,audioUnexpectedEnd:!1};case"UNSHARE_AUDIO":return{...e,audioStream:null,audioUnexpectedEnd:!1};case"AUDIO_UNEXPETED_END":return{...e,audioStream:null,audioUnexpectedEnd:!0};case"SHARE_DISPLAY":return{...e,displayStream:t.stream,displayAllowed:!0,displayUnexpectedEnd:!1};case"BLOCK_DISPLAY":return{...e,displayStream:null,displayAllowed:!1,displayUnexpectedEnd:!1};case"UNSHARE_DISPLAY":return{...e,displayStream:null,displayUnexpectedEnd:!1};case"DISPLAY_UNEXPETED_END":return{...e,displayStream:null,displayUnexpectedEnd:!0};case"SHARE_USER":return{...e,userStream:t.stream,userAllowed:!0,userUnexpectedEnd:!1};case"BLOCK_USER":return{...e,userStream:null,userAllowed:!1,userUnexpectedEnd:!1};case"UNSHARE_USER":return{...e,userStream:null,userUnexpectedEnd:!1};case"USER_UNEXPETED_END":return{...e,userStream:null,userUnexpectedEnd:!0};case"START_RECORDING":return{...e,isRecording:!0};case"STOP_RECORDING":return{...e,isRecording:!1};case"STOP_RECORDING_PREMATURELY":return{...e,isRecording:!1,prematureRecordingEnd:!0};case"CLEAR_RECORDINGS":return{...e,recordings:[],prematureRecordingEnd:!1};case"ADD_RECORDING":const r=[...e.recordings.filter((e=>e.deviceType!==t.recording.deviceType)),t.recording];return{...e,recordings:r};case"UPLOAD_ERROR":return{...e,upload:{...e.upload,error:t.msg,state:b}};case"UPLOAD_REQUEST":return{...e,upload:{...e.upload,error:null,state:f}};case"UPLOAD_SUCCESS":return{...e,upload:{...e.upload,error:null,state:Z}};case"UPLOAD_PROGRESS_UPDATE":return{...e,upload:{...e.upload,secondsLeft:t.secondsLeft,currentProgress:t.currentProgress}};case"MARK_DOWNLOADED":return{...e,recordings:e.recordings.map(((e,r)=>r===t.index?{...e,downloaded:!0}:e))};case"UPDATE_TITLE":return{...e,title:t.value};case"UPDATE_PRESENTER":return{...e,presenter:t.value};case"UPDATE_START":return{...e,start:t.time};case"UPDATE_END":return{...e,end:t.time};case"RESET":return y();default:throw new Error}},E=(0,i.createContext)(null),S=(0,i.createContext)(null),R=e=>{let{children:t}=e;const[r,o]=(0,i.useReducer)(w,y());return(0,n.tZ)(S.Provider,{value:o},(0,n.tZ)(E.Provider,{value:r},t))},k=()=>(0,u.eU)(S,"useDispatch"),C=()=>(0,u.eU)(E,"useStudioState");var D=r(427),A=r(9806),T=r(1632);const O=()=>(0,n.tZ)("article",null,(0,n.tZ)(D.Ge.h2,null,"ELAN e.V."),(0,n.tZ)(D.Ge.p,null,"The e-learning academic network (ELAN e.V.) is a German non-profit organization supporting higher-education organizations in all matters related to e-learning. Our services include practical tips about how to use digital technologies in education, legal advice and development of free, open-source software to support education."),(0,n.tZ)(D.Ge.h3,null,"Contact"),(0,n.tZ)(D.Ge.p,null,"Dr. Norbert Kleinefeld, Gesch\xe4ftsf\xfchrer",(0,n.tZ)("br",null),"Karlstr. 23",(0,n.tZ)("br",null),"D-26123 Oldenburg"),(0,n.tZ)(D.Ge.p,null,(0,n.tZ)(A.G,{icon:T.bd9})," ",(0,n.tZ)(D.Ge.a,{href:"https://elan-ev.de"},"elan-ev.de"),(0,n.tZ)("br",null),(0,n.tZ)(A.G,{icon:T.FU$})," ",(0,n.tZ)(D.Ge.a,{href:"mailto:kontakt@elan-ev.de"},"kontakt@elan-ev.de"),(0,n.tZ)("br",null),(0,n.tZ)(A.G,{icon:T.j1w})," ",(0,n.tZ)(D.Ge.a,{href:"tel:+4944199866610"},"+49\u2009441 998\u2009666\u200910")),(0,n.tZ)(D.Ge.p,null,"Registergericht: Amtsgericht Oldenburg",(0,n.tZ)("br",null),"Registernummer: VR 200644",(0,n.tZ)("br",null),"USt.-ID-Nr.: DE 265901392")),_=()=>(0,n.tZ)(o.W2,null,(0,n.tZ)("article",{sx:{maxWidth:"900px",margin:"0 auto"}},(0,n.tZ)("header",null,(0,n.tZ)(D.Ge.h1,null,"Opencast Studio")),(0,n.tZ)(D.Ge.p,null,"A web-based recording studio for ",(0,n.tZ)(D.Ge.a,{href:"https://opencast.org"},"Opencast"),"."),(0,n.tZ)(D.Ge.p,null,"Opencast Studio allows you to record your camera, your display and your microphone\u02bcs audio. You can then either download your recordings or upload them directly to an Opencast instance (usually the one of your university)."),(0,n.tZ)(D.Ge.p,null,"This is free software under the terms of the"," ",(0,n.tZ)(D.Ge.a,{href:"https://github.com/elan-ev/opencast-studio/blob/master/LICENSE"},"MIT License")," ","developed by the ",(0,n.tZ)(D.Ge.a,{href:"https://elan-ev.de"},"ELAN e.V.")," in cooperation with the ",(0,n.tZ)(D.Ge.a,{href:"https://ethz.ch"},"ETH Z\xfcrich"),"."),(0,n.tZ)(D.Ge.h2,null,"How it works"),(0,n.tZ)(D.Ge.p,null,"Opencast Studio uses the recording capabilities built into modern browsers to record audio and video streams. The recording happens in the user\u02bcs browser and no server is involved in the recording."),(0,n.tZ)(i.Fragment,null,(0,n.tZ)(D.Ge.h2,null,"Support"),(0,n.tZ)(D.Ge.p,null,"If you are experiencing any difficulties or found any bugs, please take a look at the"," ",(0,n.tZ)(D.Ge.a,{href:"https://github.com/elan-ev/opencast-studio/issues"},"issue tracker on GitHub"),". Before filing a new issue, please check if one about your topic already exists. We regularly check incoming issues and do our best to address bugs in a timely manner."),(0,n.tZ)(D.Ge.p,null,"If you are interested in additional development or want to support the development of Opencast Studio, please contact"," ",(0,n.tZ)(D.Ge.a,{href:"mailto:opencast-support@elan-ev.de"},"opencast-support@elan-ev.de"),".")),(0,n.tZ)(D.Ge.h2,null,"Credits"),(0,n.tZ)(D.Ge.p,null,"Thanks to the following people and institutions for contributing to this project:"),(0,n.tZ)("ul",null,(0,n.tZ)("li",null,(0,n.tZ)(D.Ge.a,{href:"https://github.com/slampunk"},"Duncan Smith")," for starting this project"),(0,n.tZ)("li",null,(0,n.tZ)(D.Ge.a,{href:"https://github.com/cilt-uct"},"University of Cape Town (CILT)")," ","for letting Duncan start the project"),(0,n.tZ)("li",null,(0,n.tZ)(D.Ge.a,{href:"https://ethz.ch"},"ETH Z\xfcrich")," for financial support and testing"),(0,n.tZ)("li",null,(0,n.tZ)(D.Ge.a,{href:"https://github.com/elan-ev"},"ELAN e.V.")," for the re-implementation and the ongoing development"),(0,n.tZ)("li",null,"And many members from the Opencast community who helped along the way.")),(0,n.tZ)(O,null),(0,n.tZ)(D.Ge.h2,null,"Version"),(0,n.tZ)(D.Ge.p,null,"Build date ","2023-03-06",", commit"," ",(0,n.tZ)(D.Ge.a,{"aria-label":"Git commit on GitHub",href:"https://github.com/elan-ev/opencast-studio/commit/9bb4e5b"},"9bb4e5b"),".")));var I=r(9175),G=r(1997);function U(){const{isRecording:e}=C(),[t]=(0,I.If)();return(0,n.tZ)("header",{sx:{height:e=>e.heights.headerHeight,lineHeight:e=>e.heights.headerHeight,color:"background",display:"flex",justifyContent:"space-between",position:"relative",zIndex:3}},(0,n.tZ)("div",{sx:{backgroundColor:"dark"===t?"gray.4":"gray.0",position:"absolute",zIndex:-3,height:"100%",width:"100%"}}),e&&(0,n.tZ)("div",{sx:{backgroundColor:"dark"===t?"gray.4":"gray.0",position:"absolute",zIndex:20,height:"100%",width:"100%",opacity:.75}}),(0,n.tZ)(P,null),(0,n.tZ)(z,null))}const P=()=>{const e=(0,l.TH)(),{isRecording:t}=C();return(0,n.tZ)(a.rU,{to:{pathname:"/",search:e.search},tabIndex:t?-1:0,sx:{":focus-visible":{outline:e=>`5px solid ${e.colorz.focus[2]} !important`,outlineOffset:"-5px"}}},(0,n.tZ)("picture",{sx:{display:"block",height:e=>e.heights.headerHeight}},(0,n.tZ)("source",{media:"(min-width: 920px)",srcSet:"/opencast-studio.svg"}),(0,n.tZ)("img",{src:"/opencast-studio-small.svg",alt:"Opencast Studio",sx:{height:e=>e.heights.headerHeight}})))},L=e=>{let{target:t,children:r,icon:o,...i}=e;const s=(0,l.TH)(),{isRecording:d}=C(),[c]=(0,I.If)();return(0,n.tZ)(a.OL,Object.assign({to:{pathname:t,search:s.search},tabIndex:d?-1:0,exact:!0,activeStyle:{backgroundColor:"black"},sx:{color:"white",pl:[3,"12px"],pr:[3,"12px"],textDecoration:"none",fontSize:"18px",height:["auto","100%"],borderLeft:e=>["none",`1px solid ${e.colorz.gray["dark"===c?1:3]}`],display:["block","inline-block"],width:["100%","auto"],"&:hover":{backgroundColor:"dark"===c?"gray.3":"gray.1"},":focus-visible":{outline:e=>`5px solid ${e.colorz.focus[2]} !important`,outlineOffset:"-5px"}}},i),(0,n.tZ)("div",{sx:{width:"20px",display:"inline-block",textAlign:"right",mr:[3,3,2],"@media screen and (max-width: 742px)":{mr:[0,0,0]},"@media screen and (max-width: 575px)":{mr:[3,3,2]}}},(0,n.tZ)(A.G,{icon:o})),(0,n.tZ)("div",{sx:{display:"inline-block","@media screen and (max-width: 742px)":{display:"none"},"@media screen and (max-width: 575px)":{display:"inline-block"}}},r))},z=e=>{const[t,r]=(0,i.useState)(!1),o=()=>r(!1),{t:a}=(0,G.$G)(),[l]=(0,I.If)();return(0,n.tZ)(i.Fragment,null,(0,n.tZ)("button",{onClick:()=>r(!t),title:a("nav-open-menu-button"),sx:{display:["inline-block","none"],border:e=>`2px solid ${e.colorz.gray[3]}`,borderRadius:"10px",color:"white",my:1,px:3,mx:1,fontSize:"20px",whiteSpace:"nowrap",backgroundColor:"transparent","&:hover":{backgroundColor:"gray.1"},"&:active":{}}},a("nav-open-menu-button"),(0,n.tZ)("span",{sx:{width:"23px",display:"inline-block"}},(0,n.tZ)(A.G,{icon:t?T.NBC:T.eW2,sx:{ml:"10px"}}))),(0,n.tZ)("nav",{ref:e=>{e&&(e.style.height=t?e.scrollHeight+"px":"")},sx:{overflow:"hidden",zIndex:10,height:["0px","100% !important"],top:e=>[e.heights.headerHeight,e.heights.headerHeight,0],position:["absolute","static"],width:["100%","auto"],backgroundColor:["dark"===l?"gray.4":"gray.0","none"],transition:["height 0.25s ease-out 0s","none"],scrollX:["none","auto"]}},(0,n.tZ)(L,{target:"/",icon:T.IyC,onClick:o},a("nav-recording")),(0,n.tZ)(L,{target:"/settings",icon:T.klh,onClick:o},a("nav-settings")),(0,n.tZ)(L,{target:"/shortcuts",icon:T.UFh,onClick:o},a("nav-shortcuts")),(0,n.tZ)(L,{target:"/about",icon:T.sqG,onClick:o},a("nav-about"))),t&&(0,n.tZ)("div",{onClick:o,ref:e=>e&&(e.style.opacity="1"),sx:{display:[t?"block":"none","none"],backgroundColor:"rgba(0, 0, 0, 0.7)",position:"fixed",zIndex:-10,top:0,bottom:0,left:0,right:0,opacity:0,transition:"opacity 0.25s ease-out 0s"}}))},H=e=>{let{activeStep:t,setActiveStep:r,steps:n}=e;return n[t]({nextStep:()=>r((e=>e+1)),previousStep:()=>r((e=>e-1)),firstStep:()=>r(0)})};var $=r(7325);const N=(e,t,r)=>{var n;const o=e&&{max:e},i="number"===typeof(null===t||void 0===t?void 0:t.height)?t.height:null===(n=t.height)||void 0===n?void 0:n.ideal,a=null!==i&&void 0!==i?i:r;return{height:{...o,...a&&(e?{ideal:Math.min(a,e)}:{ideal:a})}}};async function M(e,t){try{const r=await navigator.mediaDevices.getUserMedia({audio:!t||{deviceId:t},video:!1});r.getTracks().forEach((t=>{t.onended=()=>{e({type:"AUDIO_UNEXPETED_END"})}})),e({type:"SHARE_AUDIO",stream:r})}catch(tt){console.error("Error: "+tt),e({type:"BLOCK_AUDIO"})}}async function W(e,t){var r,n;let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=null!==(r=t.display)&&void 0!==r&&r.maxFps?{frameRate:{max:t.display.maxFps}}:{},a=N(null===(n=t.display)||void 0===n?void 0:n.maxHeight,o),l={video:{cursor:"always",...i,...o,...a},audio:!1};try{const t=await navigator.mediaDevices.getDisplayMedia(l);t.getTracks().forEach((t=>{t.onended=()=>{e({type:"DISPLAY_UNEXPETED_END"})}})),e({type:"SHARE_DISPLAY",stream:t})}catch(tt){console.error("Error: "+tt),e({type:"BLOCK_DISPLAY"})}}async function F(e,t,r){var n,o;const i=null!==(n=t.camera)&&void 0!==n&&n.maxFps?{frameRate:{max:t.camera.maxFps}}:{},a=N(null===(o=t.camera)||void 0===o?void 0:o.maxHeight,r,1080),l={video:{facingMode:"user",...r,...i,...a},audio:!1};try{const t=await navigator.mediaDevices.getUserMedia(l);t.getTracks().forEach((t=>{t.onended=()=>{e({type:"USER_UNEXPETED_END"})}})),e({type:"SHARE_USER",stream:t})}catch(tt){console.error("Error: "+tt),e({type:"BLOCK_USER"})}}function j(e,t){null===e||void 0===e||e.getTracks().forEach((e=>e.stop())),t({type:"UNSHARE_AUDIO"})}function K(e,t){null===e||void 0===e||e.getTracks().forEach((e=>e.stop())),t({type:"UNSHARE_DISPLAY"})}function B(e,t){null===e||void 0===e||e.getTracks().forEach((e=>e.stop())),t({type:"UNSHARE_USER"})}var V=r(3509),Y=r.n(V),q=r(8262),X=r.n(q);(0,$.configure)({defaultKeyEvent:"keydown",ignoreKeymapAndHandlerChangesByDefault:!1});const Q={RECORD_DISPLAY:["1"],RECORD_DISPLAY_CAMERA:["2"],RECORD_CAMERA:["3"],RECORD_AUDIO:["1"],NO_AUDIO:["2"],START_RECORDING:["r"],STOP_RECORDING:["s"],PAUSE_RECORDING:["Space","k"]},J={PLAY_PAUSE:["Space","k"],FORWARD_5_SEC:["l","ArrowRight"],BACKWARDS_5_SEC:["j","ArrowLeft"],FORWARD_1_FRAME:["."],BACKWARDS_1_FRAME:[","],CUT_LEFT:["n"],CUT_RIGHT:["m"],DELETE_CROP_MARK_LEFT:["Shift+n"],DELETE_CROP_MARK_RIGHT:["Shift+m"]},ee={TAB:[],NEXT_BUTTON:["Control+ArrowRight"],BACK_BUTTON:["Control+ArrowLeft"],UPLOAD:[(te="Alt+u","Mac"===["Windows","Linux","Mac"].find((e=>navigator.userAgent.includes(e)))?te.replace("Alt","Option"):te)],DOWNLOAD:["d"],NEW_RECORDING:["Shift+n"]};var te;const re=e=>{let{children:t}=e;return(0,n.tZ)("div",{sx:{display:"flex",flexDirection:"column",flex:"1 1 auto",justifyContent:"space-between",p:3,pt:[2,2,3],"& > h1":{textAlign:"center",fontSize:["24px","27px","32px"]}}},t)};function ne(e){var t;let{prev:r,next:i,children:a}=e;const{t:l}=(0,G.$G)(),s={...(null===r||void 0===r?void 0:r.onClick)&&{BACK_BUTTON:r.onClick},...(null===i||void 0===i?void 0:i.onClick)&&{NEXT_BUTTON:i.onClick}};return(0,n.tZ)($.GlobalHotKeys,{keyMap:ee,handlers:s},(0,n.tZ)(o.kC,{sx:{alignItems:"end",minHeight:"40px"}},(0,n.tZ)(o.xu,{sx:{flex:"1 1 0",textAlign:"left"}},r&&(0,n.tZ)(o.zx,{sx:{whiteSpace:"nowrap",variant:r.danger?"buttons.danger":"buttons.text"},onClick:r.onClick,disabled:r.disabled},(0,n.tZ)(A.G,{icon:T.Uu6}),l(null!==(t=r.label)&&void 0!==t?t:"back-button-label"))),(0,n.tZ)(o.xu,null,a),(0,n.tZ)(o.xu,{sx:{flex:"1 1 0",textAlign:"right"}},i&&(0,n.tZ)(o.zx,{sx:{whiteSpace:"nowrap","& svg":{mr:0,ml:2},...!0===i.danger?{variant:"buttons.danger"}:{}},onClick:i.onClick,disabled:i.disabled},l(i.label||"next-button-label"),(0,n.tZ)(A.G,{icon:T.I4f})))))}const oe=i.createContext(null),ie=()=>(0,u.eU)(oe,"useVideoBoxResize");function ae(e){let{gap:t=0,minWidth:r=180,minHeight:o=140,children:a}=e;const{ref:l,width:s=1,height:d=1}=Y()(),[,c]=(0,i.useState)(0),u=(0,i.useRef)(a.map((()=>null))),p=e=>{e.forEach(((e,t)=>{e&&(u.current[t]=e)}))};let g=a.map((e=>e.dimensions()));p(g);const h=()=>{const e=a.map((e=>e.dimensions()));X()(e,g)||(g=e,p(g),c((e=>e+1)))},m=e=>null==e?16/9:e[0]/e[1];switch(a.length){case 1:{const e=a[0],t=m(u.current[0]);let i,c;return s>d*t?(c=d,i=d*t):(i=s,c=s/t),(0,n.tZ)(oe.Provider,{value:h},(0,n.tZ)("div",{ref:l,sx:{flex:"1 0 0",minHeight:o,display:"flex"}},(0,n.tZ)("div",{sx:{height:c,width:i,minWidth:`${r}px`,margin:"auto"}},e.body)))}case 2:{const e=u.current.map((e=>m(e))),{rowWidths:i,rowHeights:c}=(()=>{const r=s-t,n=e[0]+e[1];if(r>d*n)return{rowHeights:Array(2).fill(d),rowWidths:e.map((e=>d*e))};{const t=r/n;return{rowHeights:a.map((e=>t)),rowWidths:e.map((e=>t*e))}}})(),{colWidths:p,colHeights:g}=(()=>{const r=d-t,n=1/(1/e[0]+1/e[1]);if(s>r*n){const t=r*n;return{colHeights:a.map(((r,n)=>t/e[n])),colWidths:Array(2).fill(t)}}return{colHeights:a.map(((t,r)=>s/e[r])),colWidths:Array(2).fill(s)}})();let v,x,f;return i[0]*c[0]+i[1]*c[1]>p[0]*g[0]+p[1]*g[1]?(f="row",v=i,x=c):(f="column",v=p,x=g),(0,n.tZ)(oe.Provider,{value:h},(0,n.tZ)("div",{ref:l,sx:{flex:"1 0 0",display:"flex",flexDirection:f,justifyContent:"space-between",minHeight:o}},(0,n.tZ)("div",{sx:{height:x[0],width:v[0],minWidth:`${r}px`,margin:"auto"}},a[0].body),(0,n.tZ)("div",{sx:{height:x[1],width:v[1],minWidth:`${r}px`,margin:"auto"}},a[1].body)))}default:return(0,n.tZ)("p",null,"Internal error: too few or too many video streams")}}const le=e=>{let{isDanger:t=!1,children:r,...o}=e;return(0,n.tZ)("div",Object.assign({sx:{":not(:last-child)":{marginBottom:"1.5rem"},backgroundColor:t?"error":"gray.3",color:t?"notification_text":"currentColor",borderRadius:2,padding:3,position:"relative"}},o),r)};var se=r(8622),de=r.n(se);function ce(e){let{stream:t}=e;const r=(0,i.useRef)(null);return(0,i.useEffect)((()=>{const e=r.current;if(e){const r=e.getContext("2d");if(null==r)throw new Error("Could not get 2D context for canvas");r.lineWidth=2,r.strokeStyle="#f1c40f";const n=(new window.AudioContext).createMediaStreamSource(t),o=new(de())(n,{fftSize:1024});return o.animate(r),()=>o.stop()}return()=>{}}),[t]),(0,n.tZ)("canvas",{ref:r,width:"800px",height:"200px",sx:{width:"100%",maxHeight:"200px",minHeight:0,flex:"1 0 70px",bg:"rgba(0,0,0,0.8)",borderRadius:"7px"}})}const ue="ocStudioLastAudioDevice";function pe(e){const t=k(),{audioStream:r,audioChoice:o}=C(),i=()=>e.previousStep(),a=()=>e.nextStep(),l=()=>a(),s=async()=>{t({type:"CHOOSE_AUDIO",choice:"microphone"});const e=window.localStorage.getItem(ue);await M(t,e?{ideal:e}:void 0),await(0,u.NN)(t)},d=()=>{r&&j(r,t),t({type:"CHOOSE_AUDIO",choice:"none"})},c=(()=>{switch(o){case p:return(0,n.tZ)(ge,{selectNoAudio:l,selectMicrophone:s,backToVideoSetup:i});case"microphone":return(0,n.tZ)(he,{reselectSource:d,enterStudio:a});default:return"internal error :-("}})();return(0,n.tZ)(re,null,c)}const ge=e=>{let{selectNoAudio:t,selectMicrophone:r,backToVideoSetup:a}=e;const{t:l}=(0,G.$G)(),s={RECORD_AUDIO:r,NO_AUDIO:t};return(0,n.tZ)($.GlobalHotKeys,{keyMap:Q,handlers:s},(0,n.tZ)(i.Fragment,null,(0,n.tZ)(D.Ge.h1,null,l("sources-audio-question")),(0,n.tZ)(o.kC,{sx:{flexDirection:["column","row"],maxWidth:850,width:"100%",mx:"auto",mb:3,flex:"1 0 auto",maxHeight:["none","350px"],"& > :first-of-type":{mb:[3,0],mr:[0,3]}}},(0,n.tZ)(me,{icon:T.UOM,label:l("sources-audio-microphone"),onClick:r}),(0,n.tZ)(me,{icon:T.EkX,label:l("sources-audio-without-audio"),onClick:t})),(0,n.tZ)(ne,{prev:{onClick:a}})))},he=e=>{var t,r,a;let{reselectSource:l,enterStudio:s}=e;const{t:d}=(0,G.$G)(),c=k(),p=C(),{audioStream:g,audioAllowed:h,audioUnexpectedEnd:m}=p,v=null===g||void 0===g||null===(t=g.getAudioTracks())||void 0===t||null===(r=t[0])||void 0===r||null===(a=r.getSettings())||void 0===a?void 0:a.deviceId,x=(0,u.Mz)(p.mediaDevices,"audioinput");(0,i.useEffect)((()=>{v&&window.localStorage.setItem(ue,v)}));const f=e=>{let{min:t,max:r}=e;return(0,n.tZ)("div",{sx:{flex:1,maxHeight:r,minHeight:t}})};let Z;return Z=g?(0,n.tZ)(i.Fragment,null,(0,n.tZ)(ce,{stream:g}),(0,n.tZ)("div",{sx:{display:"flex",width:"80%",my:3,fontSize:"18px",minWidth:"285px","align-items":"center"}},(0,n.tZ)("label",{htmlFor:"sources-audio-device",sx:{mr:3,display:"flex",flexDirection:"column",alignItems:"center"}},d("sources-audio-device"),":"),(0,n.tZ)("select",{id:"sources-audio-device",sx:{variant:"styles.select",flex:"1 0 0",minWidth:0},value:v,onChange:e=>(async e=>{g&&j(g,c),await M(c,{exact:e})})(e.target.value)},x.map(((e,t)=>(0,n.tZ)("option",{key:t,value:e.deviceId},e.label||"unlabeled microphone")))))):!1===h?(0,n.tZ)(i.Fragment,null,(0,n.tZ)(A.G,{icon:T.eHv,size:"3x"}),(0,n.tZ)(f,{min:"16px",max:"48px"}),(0,n.tZ)(le,{isDanger:!0},(0,n.tZ)(o.X6,{as:"h3",mb:2},d("source-audio-not-allowed-title")),(0,n.tZ)(o.xv,{variant:"text"},d("source-audio-not-allowed-text")))):!0===m?(0,n.tZ)(i.Fragment,null,(0,n.tZ)(A.G,{icon:T.eHv,size:"3x"}),(0,n.tZ)(f,{min:"16px",max:"48px"}),(0,n.tZ)(le,{isDanger:!0},(0,n.tZ)(o.xv,{variant:"text"},d("error-lost-audio-stream")))):(0,n.tZ)(o.$j,{size:"75"}),(0,n.tZ)(i.Fragment,null,(0,n.tZ)(D.Ge.h1,null,d("sources-audio-microphone-selected")),(0,n.tZ)("div",{sx:{maxWidth:850,width:"100%",mx:"auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flex:"1 0 auto",maxHeight:"400px"}},Z),(0,n.tZ)(ne,{prev:{label:"sources-audio-reselect-audio",onClick:l},next:{onClick:s}}))},me=e=>{let{children:t,icon:r,label:o,onClick:i}=e;return(0,n.tZ)("button",{onClick:i,sx:{fontFamily:"inherit",color:"gray.0",backgroundColor:"gray.4",border:"2px solid black",borderRadius:"8px",flex:"0 1 50%",p:2,"&:hover":{boxShadow:e=>`0 0 10px ${e.colorz.gray[2]}`,filter:"brightness(1.2)"}}},(0,n.tZ)("div",{sx:{display:"block",textAlign:"center",mb:3}},(0,n.tZ)(A.G,{icon:r,size:"3x"})),(0,n.tZ)("div",{sx:{fontSize:4}},o),t)};var ve=r(1134),xe=r(7785),fe=r(5504);const Ze=e=>{let{errors:t,register:r,label:o,name:i,required:a,validate:l,type:s="text",...d}=e;const{t:c}=(0,G.$G)(),u=t[i];return(0,n.tZ)("div",{sx:{"&:not(:last-child)":{mb:3}}},(0,n.tZ)("label",{sx:{color:"text",display:"block",fontSize:2,fontWeight:"bold"}},o,(0,n.tZ)("div",{sx:{display:"block",boxSizing:"border-box",clear:"both",fontSize:2,position:"relative",textAlign:"left"}},(0,n.tZ)("input",Object.assign({"aria-invalid":u?"true":"false","aria-describedby":`${i}Error`,autoComplete:"off",sx:{variant:"styles.input"},type:s},d,r(i,{validate:l,onChange:d.onChange,...a&&{required:c("forms-validation-error-required")}}))),u&&(0,n.tZ)("p",{id:`${i}Error`,sx:{color:"error",fontSize:1,fontWeight:"body",mt:1}},u.message))))},be=(0,i.forwardRef)(((e,t)=>{let{onDownload:r,recording:a,title:l,presenter:s}=e;const{t:d,i18n:c}=(0,G.$G)(),{deviceType:p,mimeType:g,url:h,downloaded:m,media:v}=a,x=d("desktop"===p?"sources-display":"sources-user"),f=(0,u.oe)({mime:g,flavor:x,title:l,presenter:s}),Z=(0,i.useRef)(null);if((0,i.useImperativeHandle)(t,(()=>({download:()=>{var e;return null===(e=Z.current)||void 0===e?void 0:e.click()}}))),!h)return null;const b=v.size,y=e=>{const t=e<10?1:0;return e.toLocaleString(c.language,{minimumFractionDigits:t,maximumFractionDigits:t})},w=b<1e3?`${b} B`:b<999500?`${y(b/1e3)} KB`:b<9995e5?`${y(b/1e6)} MB`:`${y(b/1e9)} GB`;return(0,n.tZ)("div",{sx:{display:"flex",flexDirection:"column",flex:"0 0 auto",mx:2,pb:"12px",alignItems:"center"}},(0,n.tZ)("div",{sx:{position:"relative",height:"150px",border:e=>`2px solid ${e.colorz.gray[1]}`}},(0,n.tZ)("video",{tabIndex:-1,muted:!0,src:h,onLoadedData:e=>e.currentTarget.currentTime=0,preload:"auto",sx:{maxWidth:"100%",height:"100%"}}),m&&(0,n.tZ)("div",{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",color:"primary",backgroundColor:"rgba(0, 0, 0, 0.4)"}},(0,n.tZ)(A.G,{icon:T.f8k,size:"4x"}))),(0,n.tZ)(o.zx,{ref:Z,as:"a",role:"button",sx:{width:"100%",maxWidth:"215px",margin:"auto",mt:"10px"},target:"_blank",download:f,href:h,rel:"noopener noreferrer",onClick:r},(0,n.tZ)(A.G,{icon:T.q7m}),d("save-creation-download-button")," ","(",w,")"))})),ye="ocStudioLastPresenter";let we=[];function Ee(e){const t=(0,c.rV)(),{t:r}=(0,G.$G)(),a=(0,fe.mx)(),{recordings:l,upload:s,title:d,presenter:u,start:p,end:g}=C(),h=k();function m(e){const t=Date.now();we.push({timestamp:t,progress:e});const r=Math.min(we.findIndex((e=>t-e.timestamp<5e3)),Math.max(0,we.length-6));we.splice(0,r);let n=null;if(we.length>=4){const r=t-we[0].timestamp,o=(e-we[0].progress)/r*1e3,i=1-e;n=Math.max(0,Math.round(i/o))}s.secondsLeft===n&&s.currentProgress===e||h({type:"UPLOAD_PROGRESS_UPDATE",secondsLeft:n,currentProgress:e})}async function v(){h({type:"UPLOAD_REQUEST"}),we.push({timestamp:Date.now(),progress:0});const e=await a.upload({recordings:l.filter(Boolean),title:d,presenter:u,start:p,end:g,uploadSettings:t.upload,onProgress:m});switch(we=[],e){case"success":h({type:"UPLOAD_SUCCESS"});break;case"network_error":h({type:"UPLOAD_ERROR",msg:r("save-creation-upload-network-error")});break;case"not_authorized":h({type:"UPLOAD_ERROR",msg:r("save-creation-upload-not-authorized")});break;case"unexpected_response":h({type:"UPLOAD_ERROR",msg:r("save-creation-upload-invalid-response")});break;default:h({type:"UPLOAD_ERROR",msg:r("save-creation-upload-unknown-error")})}}(0,i.useEffect)((()=>{const e=setInterval((()=>{if(s.state===f)if(we.length){const e=we[we.length-1];Date.now()-e.timestamp>3e3&&m(e.progress)}else m(0)}),1e3);return()=>clearInterval(e)}));const b=l.every((e=>e.downloaded)),y=(s.state===Z||b)&&s.state!==f,w=s.state!==x||b,E=(()=>{if(s.state===x&&(a.getState()===fe.rV||a.getState()===fe.HY))return(0,n.tZ)(Ce,null);switch(s.state){case f:return(0,n.tZ)(Te,{currentProgress:s.currentProgress,secondsLeft:s.secondsLeft});case Z:return(0,n.tZ)(Oe,null);default:return(0,n.tZ)(De,{uploadState:s,handleUpload:v})}})();return(0,n.tZ)(o.W2,{sx:{display:"flex",flexDirection:"column",flex:"1 0 auto"}},(0,n.tZ)(D.Ge.h1,{sx:{textAlign:"center",fontSize:["26px","30px","32px"]}},r(y?"save-creation-title-done":"save-creation-title")),(0,n.tZ)("div",{sx:{display:"flex",flexDirection:["column","column","row"],"& > *":{flex:["0","0","1 0 50%"],p:[2,2,"0 32px"],"&:last-child":{borderLeft:e=>["none","none",`1px solid ${e.colorz.gray[3]}`]}}}},(0,n.tZ)("div",null,(0,n.tZ)(D.Ge.h2,{sx:{pb:1,borderBottom:e=>`1px solid ${e.colorz.gray[2]}`}},r("save-creation-subsection-title-upload")),(0,n.tZ)("div",{sx:{margin:"auto"}},E)),(0,n.tZ)("div",null,(0,n.tZ)(D.Ge.h2,{sx:{pb:1,borderBottom:e=>`1px solid ${e.colorz.gray[2]}`}},r("save-creation-subsection-title-download")),(0,n.tZ)(ke,{title:d,presenter:u}))),(0,n.tZ)("div",{sx:{flex:"1 0 32px"}}),(0,n.tZ)(ne,{prev:w?void 0:{onClick:e.previousStep,disabled:!1}},y&&(0,n.tZ)(Se,{goToFirstStep:e.firstStep})))}const Se=e=>{var t;let{goToFirstStep:r}=e;const{t:i}=(0,G.$G)(),a=k(),l=(0,c.rV)(),s=()=>{window.confirm(i("save-creation-new-recording-warning"))&&(a({type:"RESET"}),r())};let d;if(null!==(t=l.return)&&void 0!==t&&t.target)if(Re(l)){var u;const e=null!==(u=l.return)&&void 0!==u&&u.label?i("save-creation-return-to",{label:l.return.label}):i("save-creation-return-to-no-label");d=(0,n.tZ)(o.zx,{as:"a",title:e,sx:{whiteSpace:"nowrap",fontWeight:400,mb:2},href:l.return.target},(0,n.tZ)(A.G,{icon:T.nYk}),e)}else console.warn("the given 'return.target' is not allowed (check 'return.allowedDomains' in 'settings.toml')");const p={NEW_RECORDING:s};return(0,n.tZ)($.GlobalHotKeys,{keyMap:ee,handlers:p},(0,n.tZ)("div",{sx:{display:"flex",flexDirection:"column"}},d,(0,n.tZ)(o.zx,{sx:{whiteSpace:"nowrap"},title:i("save-creation-new-recording"),onClick:s},(0,n.tZ)(A.G,{icon:T.tmN}),i("save-creation-new-recording"))))},Re=e=>{var t;let r;try{r=new URL(e.return.target,window.location.href)}catch(n){return!1}return[window.location.hostname,...(null===(t=e.return)||void 0===t?void 0:t.allowedDomains)||[]].some((e=>r.hostname===e))&&("https:"===r.protocol||"http:"===r.protocol)},ke=e=>{let{presenter:t,title:r}=e;const{t:a}=(0,G.$G)(),l=k(),{recordings:s,start:d,end:c}=C(),u=(0,i.useRef)([]),p={DOWNLOAD:()=>u.current.forEach((e=>null===e||void 0===e?void 0:e.download()))};return(0,n.tZ)($.GlobalHotKeys,{keyMap:ee,handlers:p},(0,n.tZ)(i.Fragment,null,(null!==d||null!==c)&&(0,n.tZ)(le,{sx:{display:"flex",flexDirection:"column",alignItems:"center"}},(0,n.tZ)(A.G,{icon:T.eHv,sx:{fontSize:"26px",mb:3}}),(0,n.tZ)("p",{sx:{m:0}},a("save-creation-download-cut-warning"))),(0,n.tZ)("div",{sx:{display:"flex",flexDirection:"row",justifyContent:["center","center","start"],flexWrap:"wrap"}},0===s.length?(0,n.tZ)(o.$j,null):s.map(((e,o)=>(0,n.tZ)(be,{ref:e=>u.current[o]=e,key:o,recording:e,presenter:t,title:r,onDownload:()=>l({type:"MARK_DOWNLOADED",index:o})}))))))},Ce=()=>{const e=(0,l.TH)(),[t]=(0,I.If)();return(0,n.tZ)(le,{key:"opencast-connection",isDanger:!0},(0,n.tZ)(G.cC,{i18nKey:"warning-missing-connection-settings"},"Warning.",(0,n.tZ)(a.rU,{to:{pathname:"/settings",search:e.search},sx:{variant:"styles.a",color:"dark"===t?"rgba(255, 255, 34, 0.8)":"#ff2"}},"settings")))},De=e=>{let{uploadState:t,handleUpload:r}=e;const{titleField:a=c.UY,presenterField:l=c.UY}=(0,c.rV)().upload||{},{t:s}=(0,G.$G)(),d=(0,fe.mx)(),u=k(),{recordings:p,title:g,presenter:h}=C(),m=h||window.localStorage.getItem(ye)||"",{formState:{errors:v},handleSubmit:x,register:f}=(0,ve.cI)();function Z(e){const t=e.target;u({type:{title:"UPDATE_TITLE",presenter:"UPDATE_PRESENTER"}[t.name],value:t.value}),"presenter"===t.name&&window.localStorage.setItem(ye,t.value)}(0,i.useEffect)((()=>{m!==h&&u({type:"UPDATE_PRESENTER",value:m})}));const y=d.prettyServerUrl()?(0,n.tZ)(G.cC,{i18nKey:"save-creation-upload-to",components:{1:(0,n.tZ)("code",null)},values:{server:d.prettyServerUrl()},sx:{"& > code":{backgroundColor:"rgba(0, 0, 0, 0.1)",borderRadius:"5px",padding:"1px 3px"}}}):s("save-creation-button-upload"),w=(0,i.useRef)(null),E={UPLOAD:()=>{var e;return null===(e=w.current)||void 0===e?void 0:e.click()}};return(0,n.tZ)($.GlobalHotKeys,{keyMap:ee,handlers:E},(0,n.tZ)(i.Fragment,null,(0,n.tZ)(Ae,null),(0,n.tZ)("form",null,a!==c.V9&&(0,n.tZ)(Ze,{name:"title",label:s("save-creation-label-title"),required:a===c.UY,onChange:Z,autoComplete:"off",defaultValue:g,errors:v,register:f}),l!==c.V9&&(0,n.tZ)(Ze,{name:"presenter",label:s("save-creation-label-presenter"),required:l===c.UY,onChange:Z,autoComplete:"off",defaultValue:m,errors:v,register:f}),(0,n.tZ)(o.zx,{disabled:0===p.length,onClick:x(r),ref:w},(0,n.tZ)(A.G,{icon:T.cf$}),y)),(0,n.tZ)(o.xu,{sx:{mt:2}},t.state===b&&(0,n.tZ)(le,{isDanger:!0},t.error))))},Ae=()=>{const e=(0,l.TH)(),t=(0,fe.mx)(),{t:r}=(0,G.$G)(),s=(0,xe.Z)(),[d,c]=(0,i.useState)(!1);if((0,i.useEffect)((()=>{if(!t.isReadyToUpload()&&!d&&s){const e=setTimeout((async()=>{c(!0),await t.refreshConnection(),c(!1)}),5e3);return()=>clearTimeout(e)}})),t.isReadyToUpload())return null;let u,p;switch(t.getState()){case fe.RY:u=r("save-creation-warn-unreachable"),p=r("save-creation-warn-once-reestablished");break;case fe.F8:if(t.isLoginProvided()){const e=document.referrer;u=(0,n.tZ)(G.cC,{i18nKey:"save-creation-warn-session-expired"},"Foo",e&&!e.includes(window.origin||"")?(0,n.tZ)(D.Ge.a,{href:e,target:"_blank",sx:{color:"#ff2"}},"bar"):(0,n.tZ)(i.Fragment,null,"bar"),"baz"),r("save-creation-warn-session-expired"),p=r("save-creation-warn-once-refreshed")}else u=(0,n.tZ)(G.cC,{i18nKey:"save-creation-warn-login-failed"},"Failed.",(0,n.tZ)(a.rU,{to:{pathname:"/settings",search:e.search},sx:{variant:"styles.a",color:"#ff2"}},"settings")),p=r("save-creation-warn-once-logged-in");break;case fe.J$:case fe.iL:u=r("save-creation-warn-server-problem")+" "+r("save-creation-warn-download-hint");break;default:u="Internal error :-("}return(0,n.tZ)(le,{isDanger:!0},(0,n.tZ)("div",{sx:{textAlign:"center",fontSize:"40px",lineHeight:1.3}},d?(0,n.tZ)(o.$j,{size:"40"}):(0,n.tZ)(A.G,{icon:T.eHv})),(0,n.tZ)("p",{sx:{mb:0}},u),p&&(0,n.tZ)("p",{sx:{mb:0}},p,p&&" ",r("save-creation-warn-download-hint")))},Te=e=>{let{currentProgress:t,secondsLeft:r}=e;const{t:a,i18n:l}=(0,G.$G)(),s=Math.min(100,100*t).toLocaleString(l.language,{minimumFractionDigits:1,maximumFractionDigits:1});let d;return d=null===r?null:r<4?a("upload-time-a-few-seconds"):r<45?`${r} ${a("upload-time-seconds")}`:r<90?a("upload-time-a-minute"):r<2700?`${Math.round(r/60)} ${a("upload-time-minutes")}`:r<5400?a("upload-time-an-hour"):r<86400?`${Math.round(r/3600)} ${a("upload-time-hours")}`:null,(0,n.tZ)(i.Fragment,null,(0,n.tZ)("div",{sx:{display:"flex",mb:2}},(0,n.tZ)(o.xv,{variant:"text"},s,"%"),(0,n.tZ)("div",{sx:{flex:1}}),(0,n.tZ)(o.xv,{variant:"text"},d&&(0,n.tZ)(G.cC,{i18nKey:"upload-time-left"},{time:d}," left"))),(0,n.tZ)(o.Ex,{max:1,value:t,variant:"styles.progress"},s),(0,n.tZ)(o.xv,{variant:"text",sx:{textAlign:"center",mt:2}},a("upload-notification")))},Oe=()=>{const{t:e}=(0,G.$G)();return(0,n.tZ)(i.Fragment,null,(0,n.tZ)("div",{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"130px",color:"primary"}},(0,n.tZ)(A.G,{icon:T.f8k,size:"4x"})),(0,n.tZ)(o.xv,{variant:"text",sx:{textAlign:"center"}},e("message-upload-complete")),(0,n.tZ)(o.xv,{sx:{textAlign:"center",mt:2}},e("message-upload-complete-explanation")))};var _e=r(1067);r(4992),r(9616);const Ie=e=>{let{content:t,...r}=e;return(0,n.tZ)(_e.ZP,Object.assign({content:(0,n.tZ)("span",null,t),interactive:!0,sx:{fontSize:"16px",backgroundColor:e=>e.colorz.tooltip,color:e=>e.colorz.tooltip_text,lineHeight:"normal",fontFamily:"Open Sans"}},r),(0,n.tZ)("span",null,r.children))},Ge=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r="deviceId"in e&&{deviceId:{[t?"exact":"ideal"]:e.deviceId}},n="aspectRatio"in e&&{aspectRatio:{ideal:e.aspectRatio?Pe(e.aspectRatio):void 0}},o="quality"in e&&{height:{ideal:e.quality?Le(e.quality):void 0}};return{...r,...n,...o}},Ue=["4:3","16:9"],Pe=e=>{var t;return null!==(t={"4:3":4/3,"16:9":16/9}[e])&&void 0!==t?t:void 0},Le=e=>{if(/^[0-9]+p$/.test(e))return parseInt(e)},ze="ocStudioLastVideoDevice",He="ocStudioCameraAspectRatio",$e="ocStudioCameraQuality",Ne="ocStudioDisplayQuality",Me=()=>{var e;return{deviceId:null!==(e=window.localStorage.getItem(ze))&&void 0!==e?e:void 0,aspectRatio:window.localStorage.getItem(He)||"auto",quality:window.localStorage.getItem($e)||"auto"}},We=()=>({quality:window.localStorage.getItem(Ne)||"auto"}),Fe=e=>{let{isDesktop:t,stream:r}=e;const o=k(),a=(0,c.rV)(),[l,s]=(0,i.useState)(0),d=(0,i.useRef)(null);Y()({ref:d,onResize:()=>{var e,t;return s(null!==(e=null===(t=d.current)||void 0===t?void 0:t.offsetHeight)&&void 0!==e?e:4)}});const{t:u}=(0,G.$G)(),p=t?We():Me(),g=e=>{const n={...p,...e},i=Ge(n,!0),l=(e,t)=>{null!=t&&window.localStorage.setItem(e,t)};t?(l(Ne,n.quality),K(r,o),W(o,a,i)):(l(ze,n.deviceId),l(He,n.aspectRatio),l($e,n.quality),B(r,o),F(o,a,i))};(0,i.useEffect)((()=>{const e=Xe(r);!t&&e&&window.localStorage.setItem(ze,e)}));const[h,m]=(0,i.useState)(!1),[v]=(0,I.If)();return(0,n.tZ)(i.Fragment,null,(0,n.tZ)("div",{sx:{position:"absolute",top:h?"8px":"-30px",left:0,right:0,textAlign:"center",transition:"top 0.2s"}},(0,n.tZ)("span",{sx:{color:"dark"===v?"gray.3":"gray.1",backgroundColor:"white",borderRadius:"10px",p:1,fontSize:"18px"}},je(r))),(0,n.tZ)("div",{sx:{position:"absolute",left:0,right:0,bottom:0,height:"100%",display:"flex",flexDirection:"column",justifyContent:"flex-end"}},(0,n.tZ)("div",{sx:{textAlign:"right"}},(0,n.tZ)(Ie,{offset:[0,25],content:u(h?"video-settings-close":"video-settings-open")},(0,n.tZ)("button",{onClick:()=>m((e=>!e)),sx:{border:"none",display:"inline-block",backgroundColor:"rgba(0, 0, 0, 0.5)",color:"white",p:"6px",m:2,fontSize:"30px",lineHeight:"1em",borderRadius:"10px",cursor:"pointer","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)"},"&:hover > svg, &:focus > svg":{transform:h?"none":"rotate(45deg)"},"&:focus-visible":{outline:e=>`5px solid ${e.colorz.primary}`,outlineOffset:"-2px",backgroundColor:"rgba(0, 0, 0, 0.7)",color:"white"}}},(0,n.tZ)(A.G,{icon:h?T.NBC:T.b7W,fixedWidth:!0,sx:{transition:h?"none":"transform 0.2s",width:"1em !important"}})))),(0,n.tZ)("div",{sx:{height:h?l||"auto":0,flex:"0 1 auto",transition:"height 0.2s",overflow:"hidden",backgroundColor:"background",fontSize:"18px",boxShadow:h?"0 0 15px rgba(0, 0, 0, 0.3)":"none"}},(0,n.tZ)("div",{tabIndex:-1,sx:{border:e=>`1px solid ${e.colorz.gray[0]}`,height:"100%",overflow:"auto"}},(0,n.tZ)("div",{ref:d,sx:{p:1,pb:"2px"}},(0,n.tZ)("div",{sx:{display:"grid",width:"100%",gridTemplateColumns:"auto 1fr",gridGap:"6px 12px",p:1}},!t&&(0,n.tZ)(Ye,{updatePrefs:g,prefs:p,isExpanded:h}),(0,n.tZ)(Ve,{isDesktop:t,updatePrefs:g,prefs:p,stream:r,settings:a,isExpanded:h})),(0,n.tZ)("div",{sx:{backgroundColor:"gray.4",m:2,py:1,px:2,fontSize:"16px",lineHeight:"20px",border:e=>`1px solid ${e.colorz.gray[2]}`}},(0,n.tZ)(G.cC,{i18nKey:"sources-video-preferences-note"},(0,n.tZ)("strong",null,"Note:")," Explanation.")))))))},je=e=>{var t,r;const n=null===e||void 0===e||null===(t=e.getVideoTracks())||void 0===t||null===(r=t[0])||void 0===r?void 0:r.getSettings(),o=n&&n.width&&n.height?`${n.width}\xd7${n.height}`:"",i=n&&n.frameRate?`${n.frameRate} fps`:"";return n?[o,i].join(", "):"..."},Ke=e=>{let{children:t}=e;return(0,n.tZ)("div",{sx:{gridColumn:"0 1",display:"flex",flexDirection:"column",justifyContent:"center",hyphens:"auto"}},t)},Be=e=>{let{children:t}=e;return(0,n.tZ)("div",{tabIndex:-1,sx:{gridColumn:"1 2",overflowX:"auto",lineHeight:"30px","*:focus-visible":{outline:e=>`5px solid ${e.colorz.primary}`,outlineOffset:"-3px"}}},t)},Ve=e=>{var t,r;let{isDesktop:o,updatePrefs:a,prefs:l,settings:s,isExpanded:d}=e;const{t:c}=(0,G.$G)(),u=e=>a({quality:e}),p=(e=>{let t=[360,480,720,1080,1440,2160].filter((t=>!e||t<=e));return!e||0!==t.length&&t[t.length-1]===e||t.push(e),t.map((e=>`${e}p`))})(o?null===(t=s.display)||void 0===t?void 0:t.maxHeight:null===(r=s.camera)||void 0===r?void 0:r.maxHeight),g=o?"desktop":"user";return(0,n.tZ)(i.Fragment,null,(0,n.tZ)(Ke,null,c("sources-video-quality"),"*:"),(0,n.tZ)(Be,null,(0,n.tZ)(qe,{isExpanded:d,id:`quality-auto-${g}`,value:"auto",name:`quality-${g}`,label:c("sources-video-quality-auto"),onChange:u,checked:p.every((e=>l.quality!==e))}),p.map((e=>(0,n.tZ)(i.Fragment,{key:`${e}-${g}`},(0,n.tZ)("wbr",null),(0,n.tZ)(qe,{isExpanded:d,id:`quality-${e}-${g}`,value:e,name:`quality-${g}`,onChange:u,checked:l.quality===e}))))))},Ye=e=>{let{updatePrefs:t,prefs:r,isExpanded:o}=e;const{t:a}=(0,G.$G)(),l=C(),s=Xe(l.userStream),d=(0,u.Mz)(l.mediaDevices,"videoinput"),c=e=>t({aspectRatio:e});return(0,n.tZ)(i.Fragment,null,(0,n.tZ)(Ke,null,(0,n.tZ)("label",{htmlFor:"sources-video-device"},a("sources-video-device"),":")),(0,n.tZ)(Be,null,(0,n.tZ)("select",{id:"sources-video-device",tabIndex:o?0:-1,sx:{variant:"styles.select"},value:s,onChange:e=>{return r=e.target.value,t({deviceId:r});var r}},d.map(((e,t)=>(0,n.tZ)("option",{key:t,value:e.deviceId},e.label))))),(0,n.tZ)(Ke,null,a("sources-video-aspect-ratio"),"*:"),(0,n.tZ)(Be,null,(0,n.tZ)(qe,{isExpanded:o,id:"ar-auto",value:"auto",name:"aspectRatio",label:a("sources-video-aspect-ratio-auto"),onChange:c,checked:Ue.every((e=>r.aspectRatio!==e))}),Ue.map((e=>(0,n.tZ)(i.Fragment,{key:`ar-${e}`},(0,n.tZ)("wbr",null),(0,n.tZ)(qe,{isExpanded:o,id:`ar-${e}`,value:e,name:"aspectRatio",onChange:c,checked:r.aspectRatio===e}))))))},qe=e=>{let{id:t,value:r,checked:o,name:a,onChange:l,label:s,isExpanded:d}=e;return(0,n.tZ)(i.Fragment,null,(0,n.tZ)("input",{type:"radio",onChange:e=>l(e.target.value),id:t,value:r,checked:o,name:a,sx:{display:"none","&+label":{border:e=>`2px solid ${e.colorz.gray[0]}`,p:"1px 4px",borderRadius:"6px",mx:1},"&:checked+label":{bg:"gray.0",color:"background",fontWeight:"bold"}}}),(0,n.tZ)("label",{tabIndex:d?0:-1,onKeyDown:e=>("Enter"===e.key||" "===e.key)&&l(r),htmlFor:t},s||r))},Xe=e=>{var t,r,n;return null===e||void 0===e||null===(t=e.getVideoTracks())||void 0===t||null===(r=t[0])||void 0===r||null===(n=r.getSettings())||void 0===n?void 0:n.deviceId},Qe=e=>{let t,{warnings:r,inputs:o}=e;switch(o.length){case 1:t=[{body:(0,n.tZ)(Je,{input:o[0]}),dimensions:()=>(0,u.Ld)(o[0].stream)}];break;case 2:t=[{body:(0,n.tZ)(Je,{input:o[0]}),dimensions:()=>(0,u.Ld)(o[0].stream)},{body:(0,n.tZ)(Je,{input:o[1]}),dimensions:()=>(0,u.Ld)(o[1].stream)}];break;default:return(0,n.tZ)("p",null,"Something went very wrong")}return(0,n.tZ)(i.Fragment,null,r,(0,n.tZ)(ae,{minWidth:300,gap:20},t))},Je=e=>{let{input:t}=e;return(0,n.tZ)(o.Zb,{sx:{height:"100%",overflow:"hidden",backgroundColor:"element_bg"}},(0,n.tZ)(et,{input:t}),(0,n.tZ)(Fe,{isDesktop:t.isDesktop,stream:t.stream}))},et=e=>{let{input:t}=e;const{allowed:r,stream:a,unexpectedEnd:l}=t,s=ie(),d=(0,i.useRef)(null);if((0,i.useEffect)((()=>{const e=d.current;return e&&(e.srcObject||(e.srcObject=a),e.addEventListener("resize",s)),()=>{e&&e.removeEventListener("resize",s)}}),[a,s]),!a){let e;return e=!1===r||l?(0,n.tZ)(A.G,{icon:T.eHv,size:"3x"}):(0,n.tZ)(o.$j,{size:"75"}),(0,n.tZ)("div",{tabIndex:-1,sx:{width:"100%",height:"100%",minHeight:"120px",display:"flex",justifyContent:"center",alignItems:"center"}},e)}return(0,n.tZ)("video",{tabIndex:-1,ref:d,autoPlay:!0,muted:!0,sx:{minHeight:0,display:"block",width:"100%",height:"100%"}})};var tt=r(7388);function rt(e){let{nextStep:t,userHasWebcam:r}=e;const{t:i}=(0,G.$G)(),a=k(),l=C(),{displayStream:s,userStream:d,videoChoice:c}=l,u=e=>a({type:"CHOOSE_VIDEO",choice:e}),p=c===v||c===g?!s||!d:!(!!s||!!d),x=!1===l.userAllowed&&(0,n.tZ)(le,{key:"user-stream-warning",isDanger:!0},(0,n.tZ)(o.X6,{as:"h3",mb:2},i("source-user-not-allowed-title")),(0,n.tZ)(o.xv,null,i("source-user-not-allowed-text"))),f=!1===l.displayAllowed&&(0,n.tZ)(le,{key:"display-stream-warning",isDanger:!0},(0,n.tZ)(o.X6,{as:"h3",mb:2},i("source-display-not-allowed-title")),(0,n.tZ)(o.xv,null,i("source-display-not-allowed-text"))),Z=(l.userUnexpectedEnd||l.displayUnexpectedEnd)&&(0,n.tZ)(le,{key:"unexpexted-stream-end-warning",isDanger:!0},(0,n.tZ)(o.xv,null,i("error-lost-video-stream")));console.log({userStream:d,activeSource:c});const b={isDesktop:!1,stream:d,allowed:l.userAllowed,unexpectedEnd:l.userUnexpectedEnd},y={isDesktop:!0,stream:s,allowed:l.displayAllowed,unexpectedEnd:l.displayUnexpectedEnd};let w,E,S;switch(c){case v:const e=Ge(Me()),t=Ge(We());E=i("sources-video-question"),w=!0,S=(0,n.tZ)(nt,{setActiveSource:u,userConstraints:e,displayConstraints:t,userHasWebcam:r});break;case m:E=i("sources-video-user-selected"),w=!d&&!1!==l.userAllowed,S=(0,n.tZ)(Qe,{warnings:[x,Z],inputs:[b]});break;case h:E=i("sources-video-display-selected"),w=!s&&!1!==l.displayAllowed,S=(0,n.tZ)(Qe,{warnings:[f,Z],inputs:[y]});break;case g:E=i("sources-video-display-and-user-selected"),w=!d&&!1!==l.userAllowed||!s&&!1!==l.displayAllowed,S=(0,n.tZ)(Qe,{warnings:[f,x,Z],inputs:[y,b]});break;default:return(0,tt.t1)("bug: active source has an unexpected value")}return(0,n.tZ)(re,null,(0,n.tZ)(D.Ge.h1,null,E),S,c!==v&&(0,n.tZ)("div",{sx:{mb:3}}),c!==v&&(0,n.tZ)(ne,!w&&{next:{onClick:()=>t(),disabled:p},prev:{onClick:()=>{u(v),B(d,a),K(s,a)},disabled:!1,label:"sources-video-reselect-source"}}))}const nt=e=>{let{setActiveSource:t,userConstraints:r,displayConstraints:a,userHasWebcam:l}=e;const{t:s}=(0,G.$G)(),d=(0,c.rV)(),p=k(),v=C(),{displaySupported:x,userSupported:f}=v,Z=async()=>{t(m),await F(p,d,r),await(0,u.NN)(p)},b=async()=>{t(h),await W(p,d,a)},y=async()=>{t(g),await F(p,d,r),await Promise.all([(0,u.NN)(p),W(p,d,a)])},w={RECORD_DISPLAY:b,RECORD_CAMERA:Z,RECORD_DISPLAY_CAMERA:y};return x||f?(0,n.tZ)(i.Fragment,null,(0,n.tZ)($.GlobalHotKeys,{keyMap:Q,handlers:w},(0,n.tZ)(it,null),(0,n.tZ)(o.kC,{sx:{flexDirection:["column","row"],maxWidth:[270,850],width:"100%",mx:["auto","none"],mb:3,flex:"4 1 auto",maxHeight:["none","270px"],justifyContent:"center","& > :not(:last-of-type)":{mb:[3,0],mr:[0,3]}}},(x||!(0,u.WK)())&&(0,n.tZ)(ot,{label:s("sources-scenario-display"),icon:T.$rF,onClick:b,disabledText:!x&&s("sources-video-display-not-supported")}),(x||!(0,u.WK)())&&f&&(0,n.tZ)(ot,{label:s("sources-scenario-display-and-user"),icon:T.hG5,onClick:y,disabledText:x?!l&&s("sources-video-no-cam-detected"):s("sources-video-display-not-supported")}),f&&(0,n.tZ)(ot,{label:s("sources-scenario-user"),icon:T.ILF,onClick:Z,disabledText:!l&&s("sources-video-no-cam-detected")})),(0,n.tZ)(it,null))):(0,n.tZ)(le,{isDanger:!0},s("sources-video-none-available"))},ot=e=>{let{icon:t,label:r,onClick:o,disabledText:i=!1}=e;const a=!1!==i;return(0,n.tZ)("button",{onClick:o,disabled:a,sx:{fontFamily:"inherit",color:a?"gray.2":"gray.0",border:e=>`2px solid ${a?e.colorz.gray[2]:"black"}`,backgroundColor:"gray.4",borderRadius:"8px",flex:["1 1 auto","0 1 100%"],minWidth:"180px",maxWidth:"300px",minHeight:"120px",maxHeight:"250px",p:2,"&:hover":a?{}:{boxShadow:e=>`0 0 10px ${e.colorz.gray[2]}`,filter:"brightness(1.2)"}}},(0,n.tZ)("div",{sx:{display:"block",textAlign:"center",mb:3}},(0,n.tZ)(A.G,{icon:t,size:"3x"})),(0,n.tZ)("div",{sx:{fontSize:4}},r),(0,n.tZ)("div",{sx:{fontSize:2,mt:1}},i))},it=()=>(0,n.tZ)("div",{sx:{flex:"1 0 0"}});function at(e){let{recordingState:t}=e;const{displayStream:r,userStream:o,displayUnexpectedEnd:i,userUnexpectedEnd:a}=C(),l=t===_t;let s=[];return(r||i)&&s.push({body:(0,n.tZ)(lt,{stream:r,paused:l}),dimensions:()=>(0,u.Ld)(r)}),(o||a)&&s.push({body:(0,n.tZ)(lt,{stream:o,paused:l}),dimensions:()=>(0,u.Ld)(o)}),(0,n.tZ)(ae,{gap:20},s)}function lt(e){let{stream:t,paused:r}=e;const o=ie(),a=(0,i.useRef)(null);return(0,i.useEffect)((()=>{const e=a.current;if(e&&t)return e.srcObject||(e.srcObject=t),e.addEventListener("resize",o),r?e.pause():e.play(),()=>e.removeEventListener("resize",o)})),t?(0,n.tZ)("div",{sx:{position:"relative",backgroundColor:"gray.3",boxShadow:"0 2px 2px rgba(0, 0, 0, 0.35)",overflow:"hidden",height:"100%",cursor:t?"initial":"pointer"}},r&&(0,n.tZ)("div",{sx:{position:"absolute",width:"100%",height:"100%",backgroundColor:"rgba(255, 255, 255, 0.5)"}},(0,n.tZ)(A.G,{icon:T.XQY,sx:{color:"#000",fontSize:"140px",maxWidth:"40%",maxHeight:"40%",position:"absolute",top:0,left:0,bottom:0,right:0,margin:"auto",animation:"3s ease-in-out infinite none pulse"}})),(0,n.tZ)("video",{ref:a,autoPlay:!0,muted:!0,tabIndex:-1,sx:{outline:"none",width:"100%",height:"100%",background:"transparent"}})):(0,n.tZ)("div",{sx:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}},(0,n.tZ)(A.G,{icon:T.eHv,size:"3x"}))}var st=r(6274),dt=r(9359),ct=(0,dt.Z)("recorder"),ut=(0,dt.Z)("data"),pt=(0,dt.Z)("dimensions"),gt=(0,dt.Z)("reset"),ht=(0,dt.Z)("onDataAvailable"),mt=(0,dt.Z)("onStop");class vt{constructor(e,t,r){let n;Object.defineProperty(this,ct,{writable:!0,value:void 0}),Object.defineProperty(this,ut,{writable:!0,value:[]}),Object.defineProperty(this,pt,{writable:!0,value:void 0}),this.onStop=void 0,Object.defineProperty(this,gt,{writable:!0,value:()=>{(0,st.Z)(this,ut)[ut]=[]}}),Object.defineProperty(this,ht,{writable:!0,value:e=>{e.data.size>0?(0,st.Z)(this,ut)[ut].push(e.data):console.log("Recording data has size 0!",e)}}),Object.defineProperty(this,mt,{writable:!0,value:e=>{var t,r;const n=(null===(t=(0,st.Z)(this,ut)[ut][0])||void 0===t?void 0:t.type)||(0,st.Z)(this,ct)[ct].mimeType,o=new Blob((0,st.Z)(this,ut)[ut],{type:n}),i=URL.createObjectURL(o);(0,st.Z)(this,gt)[gt](),null===(r=this.onStop)||void 0===r||r.call(this,{url:i,media:o,mimeType:n,dimensions:(0,st.Z)(this,pt)[pt]})}}),"isTypeSupported"in MediaRecorder?(n=((null===t||void 0===t?void 0:t.mimes)||[]).find((e=>MediaRecorder.isTypeSupported(e))),n?console.debug("using first supported MIME type from settings: ",n):null!==t&&void 0!==t&&t.mimes&&console.debug("None of the MIME types specified in settings are supported by this `MediaRecorder`")):null!==t&&void 0!==t&&t.mimes&&console.debug("MIME types were specified, but `MediaRecorder.isTypeSupported` is not supported by your browser"),(0,st.Z)(this,gt)[gt](),(0,st.Z)(this,pt)[pt]=(0,u.Ld)(e),this.onStop=r;const o=null===t||void 0===t?void 0:t.videoBitrate;(0,st.Z)(this,ct)[ct]=new MediaRecorder(e,{mimeType:n,videoBitsPerSecond:o}),(0,st.Z)(this,ct)[ct].ondataavailable=(0,st.Z)(this,ht)[ht],(0,st.Z)(this,ct)[ct].onstop=(0,st.Z)(this,mt)[mt]}start(){(0,st.Z)(this,ct)[ct].start()}pause(){(0,st.Z)(this,ct)[ct].pause()}resume(){(0,st.Z)(this,ct)[ct].resume()}stop(){(0,st.Z)(this,ct)[ct].stop()}}const xt=e=>{let{large:t=!1,...r}=e;return(0,n.tZ)("button",Object.assign({sx:{display:"grid",backgroundColor:"transparent",border:"none",position:"relative",overflow:"hidden",my:0,mx:t?"15px":0,padding:0,fontSize:t?"5rem":"3.5rem",lineHeight:t?"5rem":"3.5rem",svg:{margin:0,padding:0,outline:"none"}}},r))},ft=e=>(0,n.tZ)(xt,{onClick:e.onClick,title:e.title,sx:{"&:focus-visible":{outline:e=>`7px solid ${e.colorz.focus[3]} !important`,outlineOffset:"-1px",borderRadius:"50%"}}},(0,n.tZ)("span",{className:"fa-layers"},(0,n.tZ)(A.G,{icon:T.ul5,sx:{color:"button_bg"}}))),Zt=e=>(0,n.tZ)(xt,{onClick:e.onClick,title:e.title,large:e.large,disabled:e.disabled||e.countdown,sx:{color:"#bd181c !important","svg + svg":{color:"#e22319"},":disabled":{color:"#aaa"},":disabled svg + svg":{color:"#bbb"},"&:focus-visible":{outline:e=>`7px solid ${e.colorz.focus[0]} !important`,outlineOffset:"-1px",borderRadius:"50%"}}},(0,n.tZ)("span",{className:"fa-layers record-buttons"},(0,n.tZ)(A.G,{icon:e.countdown?T.IJ7:T.diR,spin:e.countdown}),(0,n.tZ)(A.G,{icon:T.diR,transform:"shrink-6"}))),bt=e=>(0,n.tZ)(xt,{onClick:e.onClick,title:e.title,sx:{"&:focus-visible":{outline:e=>`7px solid ${e.colorz.focus[3]} !important`,outlineOffset:"-1px",borderRadius:"50%"}}},(0,n.tZ)("span",{className:"fa-layers"},(0,n.tZ)(A.G,{icon:T.aQp,sx:{color:"button_bg"}}))),yt=e=>(0,n.tZ)(xt,{onClick:e.onClick,title:e.title,large:!!e.large,sx:{color:"#bd181c","&:focus-visible":{outline:e=>`7px solid ${e.colorz.focus[0]} !important`,outlineOffset:"-1px",borderRadius:"50%"}}},(0,n.tZ)(A.G,{icon:T.oD0,sx:{color:"#bd181c !important"}}));var wt=(0,dt.Z)("last"),Et=(0,dt.Z)("timerID"),St=(0,dt.Z)("isMounted");class Rt extends i.Component{constructor(e){super(e),Object.defineProperty(this,wt,{writable:!0,value:void 0}),Object.defineProperty(this,Et,{writable:!0,value:null}),Object.defineProperty(this,St,{writable:!0,value:!1}),this.state={milliseconds:0},(0,st.Z)(this,wt)[wt]=new Date,(0,st.Z)(this,Et)[Et]=setInterval((()=>this.tick()),100)}componentDidMount(){(0,st.Z)(this,St)[St]=!0}componentWillUnmount(){this.stopTimer(),(0,st.Z)(this,St)[St]=!1}resumeTimer(){(0,st.Z)(this,Et)[Et]||((0,st.Z)(this,Et)[Et]=setInterval((()=>this.tick()),100),(0,st.Z)(this,wt)[wt]=new Date)}stopTimer(){null!=(0,st.Z)(this,Et)[Et]&&(clearInterval((0,st.Z)(this,Et)[Et]),(0,st.Z)(this,Et)[Et]=null)}componentDidUpdate(e){this.props.isPaused!==e.isPaused&&(this.props.isPaused?this.stopTimer():this.resumeTimer())}tick(){if((0,st.Z)(this,St)[St]){const e=new Date,t=e.valueOf()-(0,st.Z)(this,wt)[wt].valueOf();(0,st.Z)(this,wt)[wt]=e,this.setState((e=>({milliseconds:e.milliseconds+t})))}}render(){const e=this.state.milliseconds;let t=[e/36e5>>0,(e/6e4>>0)%60,(e/1e3>>0)%60];0===t[0]&&(t=t.slice(1));const r=t.map((e=>(e<10?"0":"")+e)).join(":");return(0,n.tZ)("span",{sx:{fontSize:3}},r)}}const kt=Rt,Ct=(e,t)=>r=>{let{media:n,url:o,mimeType:i,dimensions:a}=r;e({type:"ADD_RECORDING",recording:{deviceType:t,media:n,url:o,mimeType:i,dimensions:a}})};function Dt(e,t){return null!==e&&void 0!==e&&e.getAudioTracks().length?new MediaStream([...t.getVideoTracks(),...e.getAudioTracks()]):t}let At=[];function Tt(e){let{handleRecorded:t,recordingState:r,setRecordingState:o}=e;const{t:a}=(0,G.$G)(),d=k(),u=(0,c.rV)(),{audioStream:p,displayStream:g,userStream:h,userUnexpectedEnd:m,displayUnexpectedEnd:v,audioUnexpectedEnd:x}=C(),f=(0,i.useRef)(),Z=(0,i.useRef)(),b=(g||h)&&!m&&!v&&!x,y=(0,l.k6)(),w=function(){var e,r;let n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null===(e=f.current)||void 0===e||e.stop(),null===(r=Z.current)||void 0===r||r.stop(),t(),d({type:n?"STOP_RECORDING_PREMATURELY":"STOP_RECORDING"}),At.forEach((e=>e())),At=[]};(0,i.useEffect)((()=>{!(m||v||x)||r!==It&&r!==_t||w(!0),y.listen((()=>{"STATE_INACTIVE"!==r&&d({type:"STOP_RECORDING"}),At.forEach((e=>e())),At=[]}))}));const E=()=>{o(_t),(()=>{var e,t;null===(e=f.current)||void 0===e||e.pause(),null===(t=Z.current)||void 0===t||t.pause()})()},S=()=>{o(It),(()=>{var e,t;null===(e=f.current)||void 0===e||e.resume(),null===(t=Z.current)||void 0===t||t.resume()})()},R=()=>{b&&(o(It),(()=>{if(d({type:"CLEAR_RECORDINGS"}),g){const e=Ct(d,"desktop"),t=Dt(p,g);f.current=new vt(t,u.recording,e),f.current.start()}if(h){const e=Ct(d,"video"),t=Dt(p,h);Z.current=new vt(t,u.recording,e),Z.current.start()}d({type:"START_RECORDING"}),At.push(y.block(a("confirm-cancel-recording")))})())},D=()=>{o(Ot),w()},A={START_RECORDING:R,STOP_RECORDING:D,PAUSE_RECORDING:()=>{r===It?E():r===_t&&S()}};return(0,n.tZ)($.GlobalHotKeys,{keyMap:Q,handlers:A},(0,n.tZ)("div",{sx:{m:0,width:r!==Ot?"280px":"auto"}},r!==Ot&&(0,n.tZ)(s.S,{onBeforeunload:e=>e.preventDefault()}),(0,n.tZ)("div",{className:"buttons",sx:{display:"flex",alignItems:"center"}},r!==Ot&&(0,n.tZ)("div",{sx:{flex:1,textAlign:"right"}},r===It&&(0,n.tZ)(Ie,{content:a("pause-button-title"),offset:[0,50]},(0,n.tZ)(ft,{recordingState:r,onClick:E})),r===_t&&(0,n.tZ)(Ie,{content:a("resume-button-title"),offset:[0,50]},(0,n.tZ)(bt,{recordingState:r,onClick:S}))),(0,n.tZ)("div",{className:"center"},r===Ot?(0,n.tZ)(Ie,{content:a("record-button-title"),offset:[0,50]},(0,n.tZ)(Zt,{large:!0,recordingState:r,onClick:R,disabled:!b})):(0,n.tZ)(Ie,{content:a("stop-button-title"),offset:[0,50]},(0,n.tZ)(yt,{large:!0,recordingState:r,onClick:D}))),r!==Ot&&(0,n.tZ)("div",{sx:{flex:1}},(0,n.tZ)(kt,{isPaused:r===_t})))))}const Ot="inactive",_t="paused",It="recording";function Gt(e){const{t:t}=(0,G.$G)(),r=C(),a=k(),l=(0,fe.mx)(),[s,d]=(0,i.useState)(Ot);return(0,n.tZ)(o.kC,{sx:{flexDirection:"column",height:"100%",position:"relative",flexGrow:1}},(r.displayUnexpectedEnd||r.userUnexpectedEnd)&&(0,n.tZ)(le,{isDanger:!0},(0,n.tZ)(o.xv,null,t("error-lost-video-stream"))),r.audioUnexpectedEnd&&(0,n.tZ)(le,{isDanger:!0},(0,n.tZ)(o.xv,null,t("error-lost-audio-stream"))),(0,n.tZ)(at,{recordingState:s}),(0,n.tZ)("div",{sx:{m:3}},(0,n.tZ)(ne,{prev:s===Ot?{onClick:e.previousStep}:void 0},(0,n.tZ)(Tt,{handleRecorded:()=>{l.refreshConnection(),function(e,t){let{audioStream:r,displayStream:n,userStream:o}=e;j(r,t),K(n,t),B(o,t)}(r,a),e.nextStep()},recordingState:s,setRecordingState:d}))))}var Ut;function Pt(){return Pt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pt.apply(this,arguments)}function Lt(e,t){let{title:r,titleId:n,...o}=e;return i.createElement("svg",Pt({"aria-hidden":"true",focusable:"false",role:"img",viewBox:"0 0 100 65",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":n},o),r?i.createElement("title",{id:n},r):null,Ut||(Ut=i.createElement("path",{d:"m24.6 0c-0.447 0-0.894 0.171-1.24 0.511l-3.07 3.05c-0.685 0.681-0.685 1.78 0 2.46l58.8 58.5c0.685 0.681 1.79 0.681 2.47 0l3.07-3.05c0.685-0.681 0.685-1.78 0-2.46l-6.68-6.64h22v-7.32h-15.6c-1.44 0-2.6-1.15-2.6-2.59v-14.3c0-1.43 1.16-2.59 2.6-2.59h15.6v-7.32h-56.4l-17.8-17.7c-0.343-0.341-0.79-0.511-1.24-0.511zm-24.6 18.2v7.32h3.7c1.44 0 2.6 1.15 2.6 2.59v14.3c0 1.43-1.16 2.59-2.6 2.59h-3.7v7.32h55.8l-15.4-15.3v5.36c0 1.43-1.16 2.59-2.6 2.59h-21.8c-1.44 0-2.6-1.15-2.6-2.59v-14.3c0-1.43 1.16-2.59 2.6-2.59h12.8l-7.36-7.32zm51 7.32h21c1.44 0 2.6 1.15 2.6 2.59v14.3c0 1.43-1.16 2.59-2.6 2.59h-1.4z",fill:"currentColor"})))}const zt=i.forwardRef(Lt);r.p;var Ht;function $t(){return $t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$t.apply(this,arguments)}function Nt(e,t){let{title:r,titleId:n,...o}=e;return i.createElement("svg",$t({"aria-hidden":"true",focusable:"false",role:"img",viewBox:"0 0 100 90",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":n},o),r?i.createElement("title",{id:n},r):null,Ht||(Ht=i.createElement("g",{fill:"currentColor"},i.createElement("path",{d:"m49.7 0.00188c-2.91 0.0589-5.75 1.49-7.44 4.08-1.06 1.62-1.51 3.48-1.42 5.29-0.0794 0.122-0.986 1.51-1.13 1.72-0.13-0.2-0.997-1.54-1.08-1.66 0.0951-1.81-0.348-3.67-1.4-5.29-1.68-2.59-4.51-4.04-7.42-4.11-1.75-0.0426-3.52 0.41-5.09 1.41-4.18 2.66-5.4 8.27-2.72 12.4 2.56 3.96 7.83 5.24 11.9 3.02l0.992 1.53c-2.84 4.35-4.9 7.5-6.74 10.3-3.09 4.73-1.94 8.93 2.01 11.5l9.47-14.5 9.45 14.6c3.96-2.55 5.13-6.75 2.06-11.5-1.84-2.84-3.9-6.03-6.74-10.4l1.04-1.59c4.1 2.23 9.37 0.974 12-2.97 2.03-3.1 1.85-7.03-0.114-9.93-0.656-0.968-1.51-1.82-2.55-2.49-1.56-1.01-3.33-1.47-5.08-1.43zm0.0903 5.96c0.578-0.0076 1.17 0.154 1.7 0.499 0.357 0.23 0.649 0.514 0.872 0.835 0.668 0.962 0.712 2.24 0.0174 3.31-0.926 1.42-2.74 1.8-4.17 0.882-1.43-0.919-1.82-2.73-0.889-4.14 0.579-0.886 1.51-1.37 2.47-1.38zm-20.1 0.0236c0.963 0.0168 1.89 0.504 2.46 1.39 0.92 1.42 0.525 3.22-0.906 4.14s-3.25 0.521-4.17-0.9c-0.92-1.42-0.525-3.22 0.906-4.14 0.537-0.343 1.13-0.502 1.71-0.492zm10 24.1a1.83 1.81 0 0 0-1.83 1.81v3.62a1.83 1.81 0 0 0 1.83 1.81 1.83 1.81 0 0 0 1.83-1.81v-3.62a1.83 1.81 0 0 0-1.83-1.81zm0 10.9a1.83 1.81 0 0 0-1.83 1.81v3.62a1.83 1.81 0 0 0 1.83 1.81 1.83 1.81 0 0 0 1.83-1.81v-3.62a1.83 1.81 0 0 0-1.83-1.81zm-1.5 8.8a2.43 2.42 0 0 0-2.43 2.42v35.4a2.43 2.42 0 0 0 2.43 2.42h8.94v-4.83h-6.51v-30.6h6.1v-4.83zm6.51 8.86v22.5h55.2v-4.83h-3.22c-0.954 0-1.72-0.761-1.72-1.71v-9.47c0-0.946 0.767-1.71 1.72-1.71h3.22v-4.83zm6.59 4.83h14.4c0.954 0 1.72 0.762 1.72 1.71v9.47c0 0.946-0.767 1.71-1.72 1.71h-14.4c-0.954 0-1.72-0.761-1.72-1.71v-9.47c0-0.946 0.767-1.71 1.72-1.71zm22.7 0h14.4c0.954 0 1.72 0.762 1.72 1.71v9.47c0 0.946-0.767 1.71-1.72 1.71h-14.4c-0.954 0-1.72-0.761-1.72-1.71v-9.47c0-0.946 0.769-1.71 1.72-1.71z"}),i.createElement("path",{d:"m0 58.6v4.83h2.44c0.954 0 1.72 0.762 1.72 1.71v9.47c0 0.946-0.768 1.71-1.72 1.71h-2.44v4.83h31.8v-22.5zm10.8 4.83h14.4c0.954 0 1.72 0.762 1.72 1.71v9.47c0 0.946-0.768 1.71-1.72 1.71h-14.4c-0.954 0-1.72-0.762-1.72-1.71v-9.47c0-0.946 0.768-1.71 1.72-1.71z",opacity:.2}))))}const Mt=i.forwardRef(Nt);r.p;function Wt(e){const{t:t}=(0,G.$G)(),r=k(),{recordings:a,prematureRecordingEnd:l,videoChoice:s}=C(),d=a.some((e=>0===e.media.size)),c=(0,i.useRef)(null),[u,p]=(0,i.useState)(0),[g,h]=(0,i.useState)(!1),m=(()=>{switch(s){case"none":return 0;case"both":return 2;default:return 1}})();return(0,n.tZ)(re,null,(0,n.tZ)(D.Ge.h1,null,t("review-heading")),l&&(0,n.tZ)(le,{isDanger:!0},(0,n.tZ)(o.xv,null,t("error-lost-stream-end-recording"))),d&&(0,n.tZ)(le,{isDanger:!0},t("review-error-empty-recording")),(!g||a.length!==m)&&(0,n.tZ)("div",{sx:{flex:1,display:"flex",alignItems:"center",justifyContent:"center"}},(0,n.tZ)(o.$j,null)),a.length===m&&(0,n.tZ)("div",{sx:g?{display:"flex",flex:"1 1 auto",flexDirection:"column"}:{display:"none"}},(0,n.tZ)(Vt,{ref:c,onTimeUpdate:e=>{p(e.currentTarget.currentTime)},onReady:()=>h(!0)}),(0,n.tZ)("div",{sx:{mb:3}}),(0,n.tZ)(Ft,{previewController:c,currentTime:u})),(0,n.tZ)("div",{sx:{mb:3}}),(0,n.tZ)(ne,{prev:{onClick:()=>{window.confirm(t("confirm-discard-recordings"))&&(r({type:"RESET"}),e.firstStep())},danger:!0,label:"review-button-discard-and-record"},next:{onClick:()=>{e.nextStep()}}}))}const Ft=e=>{let{previewController:t,currentTime:r}=e;return(0,n.tZ)("div",{sx:{backgroundColor:"gray.4",color:"text",borderRadius:"8px"}},(0,n.tZ)(Kt,{previewController:t,currentTime:r}),(0,n.tZ)(jt,{previewController:t,currentTime:r}))},jt=e=>{var t;let{previewController:r,currentTime:o}=e;const i=(null===(t=r.current)||void 0===t?void 0:t.duration)||1/0,{start:a,end:l}=C(),[s]=(0,I.If)(),d=e=>{const t=e.target.getBoundingClientRect();let n=(e.clientX-t.x)/t.width;n<0?n=0:n>1&&(n=1),r.current&&(r.current.currentTime=n*i)},c={position:"absolute",backgroundColor:"dark"===s?"gray.2":"gray.3",height:"100%",boxSizing:"content-box"};return(0,n.tZ)("div",{sx:{p:2}},(0,n.tZ)("div",{sx:{py:1,position:"relative"}},(0,n.tZ)("div",{onClick:e=>d(e),onMouseMove:e=>{1===e.buttons&&d(e)},sx:{position:"absolute",width:"100%",height:"100%",cursor:"pointer",top:0,zIndex:10}}),(0,n.tZ)("div",{sx:{position:"relative",backgroundColor:"#6bc295",height:"12px",width:"100%",borderRadius:"6px",overflow:"hidden","@media not (any-pointer: fine)":{height:"20px",borderRadius:"10px"}}},null!=a&&a>0&&(0,n.tZ)("div",{sx:{left:0,borderRight:"2px solid black",width:a/i*100+"%",...c}}),null!=l&&l<i&&(0,n.tZ)("div",{sx:{right:0,borderLeft:"2px solid black",width:(i-l)/i*100+"%",...c}}),(0,n.tZ)("div",{sx:{position:"absolute",left:0,width:o/i*100+"%",backgroundColor:"black",height:"100%",opacity:.3}}))))},Kt=e=>{var t,r,a,l,s;let{currentTime:d,previewController:u}=e;const{start:p,end:g}=C(),h=k(),m=(0,c.rV)(),{t:v}=(0,G.$G)(),x=null===(t=u.current)||void 0===t?void 0:t.duration,f=(0,i.useRef)(null),Z=(0,i.useRef)(null),b={PLAY_PAUSE:()=>{const e=u.current;null!=e&&(e.isPlaying?e.pause():e.isReadyToPlay&&e.play())},DELETE_CROP_MARK_LEFT:()=>{var e;return null===(e=f.current)||void 0===e?void 0:e.click()},DELETE_CROP_MARK_RIGHT:()=>{var e;return null===(e=Z.current)||void 0===e?void 0:e.click()}};return(0,n.tZ)("div",{sx:{textAlign:"center"}},(0,n.tZ)($.GlobalHotKeys,{keyMap:J,handlers:b},(0,n.tZ)(o.kC,{sx:{backgroundColor:"gray.4",p:2,justifyContent:"center",alignItems:"flex-end","& > *":{mx:2}}},(null===(r=m.review)||void 0===r?void 0:r.disableCutting)||(0,n.tZ)(Bt,{marker:"start",ref:f,value:p,control:g,invariant:(e,t)=>e<t,recordingDispatch:h,previewController:u,currentTime:d}),(0,n.tZ)(Ie,{content:null!==(a=u.current)&&void 0!==a&&a.isPlaying?v("review-pause"):v("review-play")},(0,n.tZ)("button",{sx:{backgroundColor:"transparent",border:"none",mx:3,color:"gray.0"},onClick:()=>{const e=u.current;e&&(e.isPlaying?e.pause():e.isReadyToPlay&&e.play())}},(0,n.tZ)(A.G,{icon:null!==(l=u.current)&&void 0!==l&&l.isPlaying?T.XQY:T.zc,sx:{fontSize:"50px",opacity:.8,"&:hover":{opacity:1}}}))),(null===(s=m.review)||void 0===s?void 0:s.disableCutting)||(0,n.tZ)(Bt,{marker:"end",ref:Z,value:g,control:p,invariant:(e,t)=>t<e,recordingDispatch:h,previewController:u,currentTime:d})),v("review-player-progress",{currentTime:d,duration:x})))},Bt=i.forwardRef(((e,t)=>{let{marker:r,value:a,control:l,invariant:s,currentTime:d,previewController:c,recordingDispatch:u}=e;const{t:p}=(0,G.$G)(),g=()=>{if(!c.current)return;let e=c.current.currentTime;null==l||s(e,l)||(e=l),u({type:"start"===r?"UPDATE_START":"UPDATE_END",time:e})},h={["start"===r?"CUT_LEFT":"CUT_RIGHT"]:g},m=(0,n.tZ)($.GlobalHotKeys,{keyMap:J,handlers:h},(0,n.tZ)("div",{sx:{flex:1,textAlign:"start"===r?"right":"left",color:"gray.0"}},null!==a&&(0,n.tZ)(i.Fragment,null,(0,n.tZ)(G.cC,{t:p,i18nKey:`review-${r}`},{[r]:a}," ",(0,n.tZ)(o.rU,{href:"",onClick:e=>{e.preventDefault(),c.current&&(c.current.currentTime=a)}})),(0,n.tZ)(Ie,{content:p("review-remove-cut-point")},(0,n.tZ)(o.hU,{ref:t,onClick:()=>u({type:"start"===r?"UPDATE_START":"UPDATE_END",time:null})},(0,n.tZ)(A.G,{icon:T.$aW})))))),v=d<=.001||c.current&&d>=c.current.duration||null!=l&&!s(d,l),x=(0,n.tZ)($.GlobalHotKeys,{keyMap:J,handlers:h},(0,n.tZ)(Ie,{content:p(`review-set-${r}`)},(0,n.tZ)("button",{disabled:v,onClick:g,sx:{backgroundColor:"transparent",color:"text",border:"none",pt:"4px",px:"8px",borderRadius:"4px","&:disabled":{opacity:.3},"&:not(:disabled):hover":{backgroundColor:"gray.3"}}},(0,n.tZ)(Mt,{sx:{height:"32px",transform:"end"===r?"scaleX(-1)":""}}))));return"start"===r?(0,n.tZ)(i.Fragment,null,m,x):(0,n.tZ)(i.Fragment,null,x,m)})),Vt=(0,i.forwardRef)(((e,t)=>{var r,o;let{onTimeUpdate:a,onReady:l}=e;const{recordings:s,start:d,end:c}=C(),{t:u}=(0,G.$G)(),p=[(0,i.useRef)(null),(0,i.useRef)(null)],g=p.slice(0,s.length),h=2===s.length?"desktop"===s[0].deviceType?0:1:null,m=(0,i.useRef)();(0,i.useImperativeHandle)(t,(()=>({get currentTime(){var e,t;return(0,tt.Yj)(null===(e=p[null!==(t=m.current)&&void 0!==t?t:0].current)||void 0===e?void 0:e.currentTime)},set currentTime(e){g.forEach((t=>{t.current&&e&&(t.current.currentTime=e)}))},get duration(){var e,t;return(0,tt.Yj)(null===(e=p[null!==(t=m.current)&&void 0!==t?t:0].current)||void 0===e?void 0:e.duration)},get isPlaying(){var e;const t=p[null!==(e=m.current)&&void 0!==e?e:0].current;return null!=t&&t.currentTime>0&&!t.paused&&!t.ended},get isReadyToPlay(){return g.every((e=>{var t,r;return(null!==(t=null===(r=e.current)||void 0===r?void 0:r.readyState)&&void 0!==t?t:0)>=2}))},play(){g.forEach((e=>{var t;return null===(t=e.current)||void 0===t?void 0:t.play()}))},pause(){g.forEach((e=>{var t;return null===(t=e.current)||void 0===t?void 0:t.pause()}))}})));const v=[(0,i.useRef)(),(0,i.useRef)()],[x,f]=(0,i.useState)(),Z=e=>null!==d&&e<d||null!==c&&e>c,b=(null===(r=p[null!==(o=m.current)&&void 0!==o?o:0].current)||void 0===r?void 0:r.currentTime)||0,y=Z(b),[,w]=(0,i.useState)(y);(0,i.useEffect)((()=>{x&&l()}),[l,x]),(0,i.useEffect)((()=>{if(x&&null!=h){(0,tt.Yj)(p[h].current).volume=0;const e=(0,tt.Yj)(p[0].current),t=(0,tt.Yj)(p[1].current);let r,n=0;const o=()=>{if(n%60===0){if(Math.abs(e.currentTime-t.currentTime)>.15&&null!=m.current){const e=p[m.current].current,t=p[0===m.current?1:0].current;(0,tt.Yj)(t).currentTime=(0,tt.Yj)(e).currentTime}}n++,r=window.requestAnimationFrame(o)};return r=window.requestAnimationFrame(o),()=>window.cancelAnimationFrame(r)}}));const E=e=>{p.forEach((t=>{null!==t.current&&("l"===(null===e||void 0===e?void 0:e.key)||"ArrowRight"===(null===e||void 0===e?void 0:e.key)?t.current.currentTime=Math.min(t.current.duration,t.current.currentTime+5):"j"!==(null===e||void 0===e?void 0:e.key)&&"ArrowLeft"!==(null===e||void 0===e?void 0:e.key)||(t.current.currentTime=Math.max(0,t.current.currentTime-5)))}))},S=e=>{p.forEach((t=>{null!==t.current&&("."===(null===e||void 0===e?void 0:e.key)?t.current.currentTime=Math.min(t.current.duration,t.current.currentTime+1/30):","===(null===e||void 0===e?void 0:e.key)&&(t.current.currentTime=Math.max(0,t.current.currentTime-1/30)))}))},R={FORWARD_5_SEC:E,BACKWARDS_5_SEC:E,FORWARD_1_FRAME:S,BACKWARDS_1_FRAME:S},k=s.map(((e,t)=>({body:(0,n.tZ)($.GlobalHotKeys,{keyMap:J,handlers:R},(0,n.tZ)("div",{sx:{position:"relative",width:"100%",height:"100%"}},y&&(0,n.tZ)("div",{sx:{position:"absolute",left:0,right:0,top:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.65)",color:"white",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",pointerEvents:"none"}},(0,n.tZ)(zt,{sx:{height:"4em"}}),(0,n.tZ)("p",{sx:{my:3}},u("review-part-will-be-removed"))),(0,n.tZ)("video",{ref:p[t],key:t,src:e.url,onLoadedData:e=>{e.currentTarget.currentTime=Number.MAX_VALUE,v[t].current="started"},onTimeUpdate:x?e=>{const t=e.currentTarget.currentTime;w(Z(t)),a(e)}:e=>{if(!x)switch(v[t].current){case"started":e.currentTarget.currentTime=.001,v[t].current="done";break;case"done":v.filter((e=>"done"===e.current)).length===s.length&&f(!0)}},preload:"auto",tabIndex:-1,sx:{width:"100%",height:"100%",backgroundColor:"#ccc",outline:"none"}}))),dimensions:()=>e.dimensions})));return(0,n.tZ)(ae,{gap:20},k)}));function Yt(e){let{activeStep:t,updateActiveStep:r,userHasWebcam:o}=e;return(0,u.UC)()?(0,n.tZ)(H,{activeStep:t,setActiveStep:r,steps:[e=>(0,n.tZ)(rt,Object.assign({},e,{userHasWebcam:o})),e=>(0,n.tZ)(pe,e),e=>(0,n.tZ)(Gt,e),e=>(0,n.tZ)(Wt,e),e=>(0,n.tZ)(Ee,e)]}):null}const qt=[{short:"en",long:"English",rtl:!1},{short:"de",long:"Deutsch",rtl:!1},{short:"nl",long:"Dutch",rtl:!1},{short:"el",long:"\u0395\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ac",rtl:!1},{short:"es",long:"Espa\xf1ol",rtl:!1},{short:"fa",long:"Farsi",rtl:!0},{short:"fr",long:"Fran\xe7ais",rtl:!1},{short:"sl",long:"Sloven\u0161\u010dina",rtl:!1},{short:"tr",long:"Turkish",rtl:!1},{short:"zh",long:"\u7b80\u4f53\u4e2d\u6587",rtl:!1}],Xt=e=>{let{title:t,children:r}=e;return(0,n.tZ)(o.xu,{sx:{"&:not(:last-child)":{mb:5}}},(0,n.tZ)(D.Ge.h2,{sx:{borderBottom:e=>`1px solid ${e.colorz.gray[2]}`,pb:1,my:3,mx:0}},t),r)},Qt=()=>{const{i18n:e,t:t}=(0,G.$G)();var r=t("settings-language-label");return"Language"!==r&&(r+=" / Language"),(0,n.tZ)(Xt,{title:t("settings-general-header")},(0,n.tZ)("label",{htmlFor:"studio-lang",sx:{variant:"styles.label"}},r),(0,n.tZ)("select",{id:"studio-lang",sx:{variant:"styles.select"},defaultValue:e.language,onChange:t=>e.changeLanguage(t.target.value)},qt.map((e=>(0,n.tZ)("option",{value:e.short,key:e.short},e.long)))))},Jt={testing:T.IJ7,error:T.RLE,saved:T.f8k};const er=function(e){let{settingsManager:t}=e;const r=(0,l.TH)(),{t:s}=(0,G.$G)(),d=(0,fe.mx)(),[c,u]=(0,i.useState)(null),{formState:{errors:p},handleSubmit:g,register:h}=(0,ve.cI)({defaultValues:t.formValues().opencast}),[m,v]=(0,i.useState)("initial"),{recordings:x}=C(),f=x.length>0,Z=t.isConfigurable("opencast.serverUrl"),b=t.isUsernameConfigurable(),y=t.isPasswordConfigurable();if(!Z&&!b&&!y)return null;const w=Jt[m];return(0,n.tZ)(Xt,{title:s("upload-settings-modal-header")},(0,n.tZ)(o.xu,null,c&&(0,n.tZ)(le,{isDanger:!0},c),(0,n.tZ)("form",{onSubmit:g((async function(e){v("testing");const r=await fe._r.init({...t.settings().opencast,...e});switch(r.getState()){case fe.zM:d.setGlobalInstance(r),t.saveSettings({opencast:e}),v("saved"),u(null);break;case fe.RY:v("error"),u(s("upload-settings-error-server-unreachable"));break;case fe.J$:v("error"),u(s("upload-settings-error-response-not-ok"));break;case fe.iL:v("error"),u(s("upload-settings-error-invalid-response"));break;case fe.F8:v("error"),d.isLoginProvided()?u(s("upload-settings-invalid-provided-login")):u(s("upload-settings-invalid-login-data"));break;case fe.HY:case fe.rV:default:v("error"),u("internal error :("),(0,tt.jI)("invalid state reached...")}}))},Z&&(0,n.tZ)(Ze,{errors:p,label:s("upload-settings-label-server-url"),name:"serverUrl",register:h,validate:e=>{try{const t=new URL(e);return"https:"===t.protocol||"http:"===t.protocol||s("upload-settings-invalid-url-http-start")}catch(t){let r=s("upload-settings-invalid-url");return e.startsWith("https://")||e.startsWith("http://")||(r+=" "+s("upload-settings-invalid-url-http-start")),r}},required:!0}),b&&(0,n.tZ)(Ze,{errors:p,label:s("upload-settings-label-username"),name:"loginName",register:h,required:!0}),y&&(0,n.tZ)(Ze,{errors:p,label:s("upload-settings-label-password"),name:"loginPassword",register:h,required:!0,type:"password"}),(0,n.tZ)("footer",{sx:{mt:4}},(0,n.tZ)(o.zx,{sx:{verticalAlign:"middle"}},s("upload-settings-button-store")),w&&(0,n.tZ)(A.G,{icon:w,sx:{ml:"10px",fontSize:"30px",verticalAlign:"middle"},spin:"testing"===m}),f&&"saved"===m&&(0,n.tZ)(a.rU,{to:{pathname:"/",search:r.search},sx:{ml:3,variant:"styles.a"}},s("settings-back-to-recording"))))))},tr=()=>{var e;const{t:t}=(0,G.$G)(),[,r]=(0,I.If)(),o=()=>{window.matchMedia("(prefers-color-scheme: dark)").matches?r("dark"):r("light")};(0,i.useEffect)((()=>{"systemTheme"===localStorage.getItem("theme")&&o()}));const a=[{value:"systemTheme",label:t("settings-theme-system")},{value:"lightTheme",label:t("settings-theme-light")},{value:"darkTheme",label:t("settings-theme-dark")}];return(0,n.tZ)(Xt,{title:t("settings-theme-appearance")},(0,n.tZ)("select",{sx:{variant:"styles.select"},defaultValue:null!==(e=localStorage.getItem("theme"))&&void 0!==e?e:void 0,onChange:e=>{return t=e.target.value,localStorage.removeItem("prefers-color-scheme"),void("systemTheme"===t?(o(),localStorage.setItem("theme","systemTheme")):"darkTheme"===t?(r("dark"),localStorage.setItem("theme","darkTheme")):(r("light"),localStorage.setItem("theme","lightTheme")));var t}},a.map(((e,t)=>(0,n.tZ)("option",{key:t,value:e.value},e.label)))))},rr=e=>{let{settingsManager:t}=e;const{t:r}=(0,G.$G)();return(0,n.tZ)(o.xu,{sx:{width:"100%",maxWidth:960,mx:"auto",p:3}},(0,n.tZ)("header",null,(0,n.tZ)(D.Ge.h1,{sx:{mb:"1.5em"}},r("settings-header"))),(0,n.tZ)(tr,null),(0,n.tZ)(Qt,null),(0,n.tZ)(er,{settingsManager:t}))},nr=()=>{const{t:e}=(0,G.$G)();let t=[];return"https:"!==window.location.protocol&&"localhost"!==window.location.hostname&&"127.0.0.1"!==window.location.hostname&&t.push((0,n.tZ)(le,{key:"unsecure-connection",isDanger:!0},e("warning-https"))),(0,u.UC)()||t.push((0,n.tZ)(le,{key:"media-recorder",isDanger:!0},e("warning-recorder-not-supported"),(0,u.H2)()&&" "+e("warning-recorder-safari-hint"))),t.length>0?(0,n.tZ)("div",{sx:{p:3}},t):null},or={Control:"control-key",Space:"space-key",ArrowRight:"right-key",ArrowLeft:"left-key",Shift:"shift-key"},ir={RECORD_DISPLAY:"record-display",RECORD_DISPLAY_CAMERA:"record-both",RECORD_CAMERA:"record-camera",RECORD_AUDIO:"record-audio",NO_AUDIO:"record-no-audio",START_RECORDING:"start-recording",STOP_RECORDING:"stop-recording",PAUSE_RECORDING:"pause-recording",PLAY_PAUSE:"play-pause",FORWARD_5_SEC:"skip-five",BACKWARDS_5_SEC:"back-five",FORWARD_1_FRAME:"frame-forward",BACKWARDS_1_FRAME:"frame-back",CUT_LEFT:"cut-left",CUT_RIGHT:"cut-right",DELETE_CROP_MARK_LEFT:"delete-left",DELETE_CROP_MARK_RIGHT:"delete-right",TAB:"tab-elements",NEXT_BUTTON:"next-button",BACK_BUTTON:"back-button",UPLOAD:"upload-video",DOWNLOAD:"download-video",NEW_RECORDING:"new-recording"},ar=e=>{let{name:t,keymap:r}=e;const{t:o}=(0,G.$G)();return(0,n.tZ)("div",{sx:{margin:"10px",display:"flex",flexDirection:"column","@media screen and (max-width: 350px)":{width:"300px"}}},(0,n.tZ)("h3",{sx:{borderBottom:e=>`1px solid ${e.colorz.gray[1]}`,textAlign:"center"}},o(t)),Object.entries(r).map(((e,t)=>{let[r,o]=e;return(0,n.tZ)(lr,{key:t,name:ir[r],sequences:o})})))},lr=e=>{let{name:t,sequences:r}=e;const{t:o}=(0,G.$G)();return(0,n.tZ)("div",{sx:{display:"flex",flexDirection:"row",padding:"6px 0",alignItems:"center"}},(0,n.tZ)("div",{sx:{width:"40%",wordWrap:"break-word"}},o(t)),r.map(((e,t)=>(0,n.tZ)("div",{key:t,sx:{padding:"2px 0",display:"flex"}},e.split("+").map(((e,t)=>(0,n.tZ)("div",{key:t,sx:{borderRadius:"5px",border:e=>`2px solid ${e.colorz.singleKey_border}`,background:e=>e.colorz.singleKey_bg,padding:"8px",margin:"0 3px",textAlign:"center",minWidth:"40px"}},e in or?o(or[e]):e))),(0,n.tZ)("div",{sx:{alignSelf:"center",lineHeight:"32px",margin:"0 5px"}},r.length-1!==t&&o("sequence-seperator"))))))},sr=()=>{const{t:e}=(0,G.$G)();return(0,n.tZ)("div",{sx:{display:"flex",flexDirection:"column",alignItems:"center",alignSelf:"center",width:"100%"}},"adsfad",(0,n.tZ)("h2",{sx:{display:"block",position:"relative",textAlign:"center"}},e("nav-shortcuts")),(0,n.tZ)("div",{sx:{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center"}},(0,n.tZ)(ar,{name:"record-shortcuts",keymap:Q}),(0,n.tZ)(ar,{name:"edit-shortcuts",keymap:J}),(0,n.tZ)(ar,{name:"other-shortcuts",keymap:ee})))},dr=e=>{let{settingsManager:t,userHasWebcam:r}=e;const[o,a]=(0,i.useState)(0),s=(0,l.TH)();return(0,n.tZ)(i.Fragment,null,(0,n.tZ)(cr,null),(0,n.tZ)(l.rs,null,(0,n.tZ)(l.AW,{path:"/settings",exact:!0},(0,n.tZ)(rr,{settingsManager:t})),(0,n.tZ)(l.AW,{path:"/shortcuts",exact:!0},(0,n.tZ)(sr,null)),(0,n.tZ)(l.AW,{path:"/about",exact:!0},(0,n.tZ)(_,null)),(0,n.tZ)(l.AW,{path:"/",exact:!0},(0,n.tZ)(Yt,{activeStep:o,updateActiveStep:a,userHasWebcam:r})),(0,n.tZ)(l.AW,{path:"/*"},(0,n.tZ)(l.l_,{to:{pathname:"/",search:s.search}}))))},cr=()=>{const{recordings:e,upload:t}=C(),r=e.every((e=>e.downloaded)),o=t.state===Z,i=t.state===f;return(0,n.tZ)(s.S,{onBeforeunload:t=>{((null===e||void 0===e?void 0:e.length)>0&&!o&&!r||i)&&t.preventDefault()}})},ur=e=>{var t;let{settingsManager:r,userHasWebcam:i}=e;const l=(0,c.rV)();return(0,n.tZ)(a.VK,{basename:"/"},(0,n.tZ)(d.xB,{styles:(null===(t=l.theme)||void 0===t?void 0:t.customCSS)||""}),(0,n.tZ)(R,null,(0,n.tZ)(o.kC,{sx:{flexDirection:"column",height:"100%"}},(0,n.tZ)(U,null),(0,n.tZ)("main",{sx:{flex:1,display:"flex",flexDirection:"column",minHeight:"285px"}},(0,n.tZ)(nr,null),(0,n.tZ)(dr,{settingsManager:r,userHasWebcam:i})))))}}}]);
//# sourceMappingURL=823.0750bfbd.chunk.js.map